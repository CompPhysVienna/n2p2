<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>n2p2 - A neural network potential package: nnp::Training Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">n2p2 - A neural network potential package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classnnp_1_1Training.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classnnp_1_1Training-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nnp::Training Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> methods.  
 <a href="classnnp_1_1Training.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Training_8h_source.html">Training.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for nnp::Training:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training__inherit__graph.png" border="0" usemap="#nnp_1_1Training_inherit__map" alt="Inheritance graph"/></div>
<map name="nnp_1_1Training_inherit__map" id="nnp_1_1Training_inherit__map">
<area shape="rect" title="Training methods." alt="" coords="5,80,111,107"/>
<area shape="rect" href="classnnp_1_1Dataset.html" title="Collect and process large data sets." alt="" coords="5,5,111,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for nnp::Training:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training__coll__graph.png" border="0" usemap="#nnp_1_1Training_coll__map" alt="Collaboration graph"/></div>
<map name="nnp_1_1Training_coll__map" id="nnp_1_1Training_coll__map">
<area shape="rect" title="Training methods." alt="" coords="921,716,1027,743"/>
<area shape="rect" href="classnnp_1_1Dataset.html" title="Collect and process large data sets." alt="" coords="554,387,659,413"/>
<area shape="rect" title="STL class." alt="" coords="225,480,311,507"/>
<area shape="rect" title=" " alt="" coords="525,617,688,658"/>
<area shape="rect" title=" " alt="" coords="513,336,700,363"/>
<area shape="rect" title=" " alt="" coords="238,285,298,312"/>
<area shape="rect" title=" " alt="" coords="513,285,700,312"/>
<area shape="rect" title=" " alt="" coords="550,437,663,464"/>
<area shape="rect" title=" " alt="" coords="5,708,72,735"/>
<area shape="rect" title=" " alt="" coords="185,735,351,761"/>
<area shape="rect" title=" " alt="" coords="499,565,715,592"/>
<area shape="rect" title=" " alt="" coords="519,1015,694,1057"/>
<area shape="rect" href="structnnp_1_1Training_1_1PropertyMap.html" title="Map of all training properties." alt="" coords="509,796,705,823"/>
<area shape="rect" title=" " alt="" coords="581,863,632,889"/>
<area shape="rect" title=" " alt="" coords="537,913,676,940"/>
<area shape="rect" title=" " alt="" coords="555,964,658,991"/>
<area shape="rect" title="STL class." alt="" coords="552,1081,661,1108"/>
<area shape="rect" title=" " alt="" coords="545,1132,669,1159"/>
<area shape="rect" title=" " alt="" coords="553,1183,660,1209"/>
<area shape="rect" title=" " alt="" coords="555,1233,659,1260"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Training_1_1Property.html">Property</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific training quantity (e.g. energies, forces, charges).  <a href="structnnp_1_1Training_1_1Property.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Training_1_1PropertyMap.html">PropertyMap</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of all training properties.  <a href="structnnp_1_1Training_1_1PropertyMap.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Training_1_1UpdateCandidate.html">UpdateCandidate</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains location of one update candidate (energy or force).  <a href="structnnp_1_1Training_1_1UpdateCandidate.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a639e7546c166a0b5530ad707e08f626e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">UpdaterType</a> { <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>, 
<a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>, 
<a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6">UT_LM</a>
 }</td></tr>
<tr class="memdesc:a639e7546c166a0b5530ad707e08f626e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of update routine.  <a href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">More...</a><br /></td></tr>
<tr class="separator:a639e7546c166a0b5530ad707e08f626e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6671e3eb01b86af1162273218df0e5ed"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">ParallelMode</a> { <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>, 
<a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>
 }</td></tr>
<tr class="memdesc:a6671e3eb01b86af1162273218df0e5ed"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> parallelization mode.  <a href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">More...</a><br /></td></tr>
<tr class="separator:a6671e3eb01b86af1162273218df0e5ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f426cc1948a782e161d0bd0072fbaa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">JacobianMode</a> { <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>, 
<a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>, 
<a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>
 }</td></tr>
<tr class="memdesc:a45f426cc1948a782e161d0bd0072fbaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jacobian matrix preparation mode.  <a href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">More...</a><br /></td></tr>
<tr class="separator:a45f426cc1948a782e161d0bd0072fbaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad641fa6c3bd89c5c3efd964c9a47429a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a> { <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, 
<a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>
 }</td></tr>
<tr class="memdesc:ad641fa6c3bd89c5c3efd964c9a47429a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update strategies available for <a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a>.  <a href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">More...</a><br /></td></tr>
<tr class="separator:ad641fa6c3bd89c5c3efd964c9a47429a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79df98867453f340a4cea8a9e432be98"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">SelectionMode</a> { <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>, 
<a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>, 
<a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>
 }</td></tr>
<tr class="memdesc:a79df98867453f340a4cea8a9e432be98"><td class="mdescLeft">&#160;</td><td class="mdescRight">How update candidates are selected during <a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a>.  <a href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">More...</a><br /></td></tr>
<tr class="separator:a79df98867453f340a4cea8a9e432be98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classnnp_1_1Mode"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classnnp_1_1Mode')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classnnp_1_1Mode.html">nnp::Mode</a></td></tr>
<tr class="memitem:a46a0c99828036f91e87b97344b36fa8c inherit pub_types_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8c">NNPType</a> { <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>, 
<a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>
 }</td></tr>
<tr class="separator:a46a0c99828036f91e87b97344b36fa8c inherit pub_types_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af98b1bc7ed710e2fa008a72ad29dbdae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#af98b1bc7ed710e2fa008a72ad29dbdae">Training</a> ()</td></tr>
<tr class="memdesc:af98b1bc7ed710e2fa008a72ad29dbdae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classnnp_1_1Training.html#af98b1bc7ed710e2fa008a72ad29dbdae">More...</a><br /></td></tr>
<tr class="separator:af98b1bc7ed710e2fa008a72ad29dbdae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db6a1a9302641ca0d74308e583667af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a6db6a1a9302641ca0d74308e583667af">~Training</a> ()</td></tr>
<tr class="memdesc:a6db6a1a9302641ca0d74308e583667af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor, updater vector needs to be cleaned.  <a href="classnnp_1_1Training.html#a6db6a1a9302641ca0d74308e583667af">More...</a><br /></td></tr>
<tr class="separator:a6db6a1a9302641ca0d74308e583667af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451092eefd3f1021b2edd7729b74505c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">selectSets</a> ()</td></tr>
<tr class="memdesc:a451092eefd3f1021b2edd7729b74505c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly select training and test set structures.  <a href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">More...</a><br /></td></tr>
<tr class="separator:a451092eefd3f1021b2edd7729b74505c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4cbb8263eeb79634e06fc62dc4b359d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#af4cbb8263eeb79634e06fc62dc4b359d">writeSetsToFiles</a> ()</td></tr>
<tr class="memdesc:af4cbb8263eeb79634e06fc62dc4b359d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write training and test set to separate files (train.data and test.data, same format as input.data).  <a href="classnnp_1_1Training.html#af4cbb8263eeb79634e06fc62dc4b359d">More...</a><br /></td></tr>
<tr class="separator:af4cbb8263eeb79634e06fc62dc4b359d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3025fc3780b67e91e063fd490640043"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ab3025fc3780b67e91e063fd490640043">initializeWeights</a> ()</td></tr>
<tr class="memdesc:ab3025fc3780b67e91e063fd490640043"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize weights for all elements.  <a href="classnnp_1_1Training.html#ab3025fc3780b67e91e063fd490640043">More...</a><br /></td></tr>
<tr class="separator:ab3025fc3780b67e91e063fd490640043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab802ff670986203dab60c22f04b07f59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory</a> (<a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a> <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>=<a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</td></tr>
<tr class="memdesc:ab802ff670986203dab60c22f04b07f59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize weights vector according to update strategy.  <a href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">More...</a><br /></td></tr>
<tr class="separator:ab802ff670986203dab60c22f04b07f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbdd4d56bb0290e139382bdfba070c2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#afbdd4d56bb0290e139382bdfba070c2a">setStage</a> (std::size_t <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>)</td></tr>
<tr class="memdesc:afbdd4d56bb0290e139382bdfba070c2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set training stage (if multiple stages are needed for NNP type).  <a href="classnnp_1_1Training.html#afbdd4d56bb0290e139382bdfba070c2a">More...</a><br /></td></tr>
<tr class="separator:afbdd4d56bb0290e139382bdfba070c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a664dec664ebd703206f7c515bf3e96f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a664dec664ebd703206f7c515bf3e96f0">dataSetNormalization</a> ()</td></tr>
<tr class="memdesc:a664dec664ebd703206f7c515bf3e96f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization based on initial weights prediction.  <a href="classnnp_1_1Training.html#a664dec664ebd703206f7c515bf3e96f0">More...</a><br /></td></tr>
<tr class="separator:a664dec664ebd703206f7c515bf3e96f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b2b016d87bcea95f460b8a2ae93b451"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining</a> ()</td></tr>
<tr class="memdesc:a2b2b016d87bcea95f460b8a2ae93b451"><td class="mdescLeft">&#160;</td><td class="mdescRight">General training settings and setup of weight update routine.  <a href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">More...</a><br /></td></tr>
<tr class="separator:a2b2b016d87bcea95f460b8a2ae93b451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0de14f9b249aa70a7648c7c3c1cc783"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ac0de14f9b249aa70a7648c7c3c1cc783">calculateNeighborLists</a> ()</td></tr>
<tr class="memdesc:ac0de14f9b249aa70a7648c7c3c1cc783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate neighbor lists for all structures.  <a href="classnnp_1_1Training.html#ac0de14f9b249aa70a7648c7c3c1cc783">More...</a><br /></td></tr>
<tr class="separator:ac0de14f9b249aa70a7648c7c3c1cc783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc45ef017066bdbfaef2846a39eb733c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError</a> (std::map&lt; std::string, std::pair&lt; std::string, std::string &gt;&gt; const fileNames)</td></tr>
<tr class="memdesc:adc45ef017066bdbfaef2846a39eb733c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate error metrics for all structures.  <a href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">More...</a><br /></td></tr>
<tr class="separator:adc45ef017066bdbfaef2846a39eb733c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d67463993440b215a9b165854c8cf9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch</a> ()</td></tr>
<tr class="memdesc:ae5d67463993440b215a9b165854c8cf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate error metrics per epoch for all structures with file names used in training loop.  <a href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">More...</a><br /></td></tr>
<tr class="separator:ae5d67463993440b215a9b165854c8cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba30ce58e186c7f2e518355aa707863"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">printHeader</a> ()</td></tr>
<tr class="memdesc:a5ba30ce58e186c7f2e518355aa707863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print training loop header on screen.  <a href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">More...</a><br /></td></tr>
<tr class="separator:a5ba30ce58e186c7f2e518355aa707863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b54c7bf103e141f9870ee2bbb30c4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch</a> ()</td></tr>
<tr class="memdesc:a86b54c7bf103e141f9870ee2bbb30c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print preferred error metric and timing information on screen.  <a href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">More...</a><br /></td></tr>
<tr class="separator:a86b54c7bf103e141f9870ee2bbb30c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af600a10225c7035afa59ce709bc105a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights</a> (std::string const &amp;nnName, std::string const &amp;fileNameFormat) const</td></tr>
<tr class="memdesc:af600a10225c7035afa59ce709bc105a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write weights to files (one file for each element).  <a href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">More...</a><br /></td></tr>
<tr class="separator:af600a10225c7035afa59ce709bc105a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a369e6446df8b2b39db30b799c912afde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch</a> () const</td></tr>
<tr class="memdesc:a369e6446df8b2b39db30b799c912afde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write weights to files during training loop.  <a href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">More...</a><br /></td></tr>
<tr class="separator:a369e6446df8b2b39db30b799c912afde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ccff5ae694d46c03cae84aa7ae696d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve</a> (bool append, std::string const fileName=&quot;learning-curve.out&quot;) const</td></tr>
<tr class="memdesc:ae4ccff5ae694d46c03cae84aa7ae696d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write current RMSEs and epoch information to file.  <a href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">More...</a><br /></td></tr>
<tr class="separator:ae4ccff5ae694d46c03cae84aa7ae696d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e1f74df67860c5776bf811e5b6a518"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518">writeNeuronStatistics</a> (std::string const &amp;nnName, std::string const &amp;fileName) const</td></tr>
<tr class="memdesc:ac2e1f74df67860c5776bf811e5b6a518"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write neuron statistics collected since last invocation.  <a href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518">More...</a><br /></td></tr>
<tr class="separator:ac2e1f74df67860c5776bf811e5b6a518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79793fcf50af45c9b128ea972b14b6a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch</a> () const</td></tr>
<tr class="memdesc:a79793fcf50af45c9b128ea972b14b6a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write neuron statistics during training loop.  <a href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">More...</a><br /></td></tr>
<tr class="separator:a79793fcf50af45c9b128ea972b14b6a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfd1869f65ece08e34f5ccea23c676f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1">resetNeuronStatistics</a> ()</td></tr>
<tr class="memdesc:adfd1869f65ece08e34f5ccea23c676f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset neuron statistics for all elements.  <a href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1">More...</a><br /></td></tr>
<tr class="separator:adfd1869f65ece08e34f5ccea23c676f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50f7e1c48f3f558653f831aae83a38c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus</a> (bool append, std::string const fileNameFormat=&quot;updater.%03zu.out&quot;) const</td></tr>
<tr class="memdesc:ad50f7e1c48f3f558653f831aae83a38c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write updater information to file.  <a href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">More...</a><br /></td></tr>
<tr class="separator:ad50f7e1c48f3f558653f831aae83a38c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7427bd5388a7c72eec65e8a2407cb7f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">sortUpdateCandidates</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:a7427bd5388a7c72eec65e8a2407cb7f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort update candidates with descending RMSE.  <a href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">More...</a><br /></td></tr>
<tr class="separator:a7427bd5388a7c72eec65e8a2407cb7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf38b0b03a3d30695ac9a9cfe70fa5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">shuffleUpdateCandidates</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:aacf38b0b03a3d30695ac9a9cfe70fa5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shuffle update candidates.  <a href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">More...</a><br /></td></tr>
<tr class="separator:aacf38b0b03a3d30695ac9a9cfe70fa5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0cecb1a3e0197fdb693186d39c8796"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode</a> ()</td></tr>
<tr class="memdesc:a3d0cecb1a3e0197fdb693186d39c8796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if selection mode should be changed.  <a href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">More...</a><br /></td></tr>
<tr class="separator:a3d0cecb1a3e0197fdb693186d39c8796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e2af12e3007a2f9955630cd27a0167"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop</a> ()</td></tr>
<tr class="memdesc:a84e2af12e3007a2f9955630cd27a0167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute main training loop.  <a href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">More...</a><br /></td></tr>
<tr class="separator:a84e2af12e3007a2f9955630cd27a0167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee02964b08a2acc442add33d96dbb1a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule</a> ()</td></tr>
<tr class="memdesc:aee02964b08a2acc442add33d96dbb1a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select energies/forces schedule for one epoch.  <a href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">More...</a><br /></td></tr>
<tr class="separator:aee02964b08a2acc442add33d96dbb1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6432b845ccd07996ab2f8f4f707a0d8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:a6432b845ccd07996ab2f8f4f707a0d8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one update.  <a href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">More...</a><br /></td></tr>
<tr class="separator:a6432b845ccd07996ab2f8f4f707a0d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d9c91a092bdb9e8eac8441ccb09ef8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ab2d9c91a092bdb9e8eac8441ccb09ef8">getSingleWeight</a> (std::size_t element, std::size_t index)</td></tr>
<tr class="memdesc:ab2d9c91a092bdb9e8eac8441ccb09ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a single weight value.  <a href="classnnp_1_1Training.html#ab2d9c91a092bdb9e8eac8441ccb09ef8">More...</a><br /></td></tr>
<tr class="separator:ab2d9c91a092bdb9e8eac8441ccb09ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa4815462bd1b49907a9bce52eb2da43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#aaa4815462bd1b49907a9bce52eb2da43">setSingleWeight</a> (std::size_t element, std::size_t index, double value)</td></tr>
<tr class="memdesc:aaa4815462bd1b49907a9bce52eb2da43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a single weight value.  <a href="classnnp_1_1Training.html#aaa4815462bd1b49907a9bce52eb2da43">More...</a><br /></td></tr>
<tr class="separator:aaa4815462bd1b49907a9bce52eb2da43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22bf5b246022c4f52f45bcc98d7c4be"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ae22bf5b246022c4f52f45bcc98d7c4be">calculateWeightDerivatives</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> *structure)</td></tr>
<tr class="memdesc:ae22bf5b246022c4f52f45bcc98d7c4be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate derivatives of energy with respect to weights.  <a href="classnnp_1_1Training.html#ae22bf5b246022c4f52f45bcc98d7c4be">More...</a><br /></td></tr>
<tr class="separator:ae22bf5b246022c4f52f45bcc98d7c4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf466a175faf1511b305ed728042edb9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#abf466a175faf1511b305ed728042edb9">calculateWeightDerivatives</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> *structure, std::size_t atom, std::size_t component)</td></tr>
<tr class="memdesc:abf466a175faf1511b305ed728042edb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate derivatives of force with respect to weights.  <a href="classnnp_1_1Training.html#abf466a175faf1511b305ed728042edb9">More...</a><br /></td></tr>
<tr class="separator:abf466a175faf1511b305ed728042edb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f0177f326dacee6f7c5a1f7628e21c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a00f0177f326dacee6f7c5a1f7628e21c">setTrainingLogFileName</a> (std::string fileName)</td></tr>
<tr class="memdesc:a00f0177f326dacee6f7c5a1f7628e21c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set training log file name.  <a href="classnnp_1_1Training.html#a00f0177f326dacee6f7c5a1f7628e21c">More...</a><br /></td></tr>
<tr class="separator:a00f0177f326dacee6f7c5a1f7628e21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classnnp_1_1Dataset"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classnnp_1_1Dataset')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classnnp_1_1Dataset.html">nnp::Dataset</a></td></tr>
<tr class="memitem:a2ef0a4a688a218d55ef061c6df659a4a inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a2ef0a4a688a218d55ef061c6df659a4a">Dataset</a> ()</td></tr>
<tr class="memdesc:a2ef0a4a688a218d55ef061c6df659a4a inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, initialize members.  <a href="classnnp_1_1Dataset.html#a2ef0a4a688a218d55ef061c6df659a4a">More...</a><br /></td></tr>
<tr class="separator:a2ef0a4a688a218d55ef061c6df659a4a inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f38b79ccbf9ada90d68d3a50250b193 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a7f38b79ccbf9ada90d68d3a50250b193">~Dataset</a> ()</td></tr>
<tr class="memdesc:a7f38b79ccbf9ada90d68d3a50250b193 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classnnp_1_1Dataset.html#a7f38b79ccbf9ada90d68d3a50250b193">More...</a><br /></td></tr>
<tr class="separator:a7f38b79ccbf9ada90d68d3a50250b193 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a93358a8303c618562487729450455 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a93a93358a8303c618562487729450455">setupMPI</a> ()</td></tr>
<tr class="memdesc:a93a93358a8303c618562487729450455 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize MPI with MPI_COMM_WORLD.  <a href="classnnp_1_1Dataset.html#a93a93358a8303c618562487729450455">More...</a><br /></td></tr>
<tr class="separator:a93a93358a8303c618562487729450455 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd2470ddbc354289e185a3bd119684a9 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#afd2470ddbc354289e185a3bd119684a9">setupMPI</a> (MPI_Comm *communicator)</td></tr>
<tr class="memdesc:afd2470ddbc354289e185a3bd119684a9 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize MPI with given communicator.  <a href="classnnp_1_1Dataset.html#afd2470ddbc354289e185a3bd119684a9">More...</a><br /></td></tr>
<tr class="separator:afd2470ddbc354289e185a3bd119684a9 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd84c06c5a83789ebe6a3ef8075af632 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#abd84c06c5a83789ebe6a3ef8075af632">setupRandomNumberGenerator</a> ()</td></tr>
<tr class="memdesc:abd84c06c5a83789ebe6a3ef8075af632 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize random number generator.  <a href="classnnp_1_1Dataset.html#abd84c06c5a83789ebe6a3ef8075af632">More...</a><br /></td></tr>
<tr class="separator:abd84c06c5a83789ebe6a3ef8075af632 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1852f4390b8b97e62f697ee4b16676 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#aed1852f4390b8b97e62f697ee4b16676">getNumStructures</a> (std::ifstream &amp;dataFile)</td></tr>
<tr class="memdesc:aed1852f4390b8b97e62f697ee4b16676 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of structures in data file.  <a href="classnnp_1_1Dataset.html#aed1852f4390b8b97e62f697ee4b16676">More...</a><br /></td></tr>
<tr class="separator:aed1852f4390b8b97e62f697ee4b16676 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b6ba9363df082cf9f7aaaad56ad7c0 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">calculateBufferSize</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure) const</td></tr>
<tr class="memdesc:a80b6ba9363df082cf9f7aaaad56ad7c0 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate buffer size required to communicate structure via MPI.  <a href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">More...</a><br /></td></tr>
<tr class="separator:a80b6ba9363df082cf9f7aaaad56ad7c0 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac032639db8f6f1230f759afd3775c200 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">sendStructure</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure, int dest) const</td></tr>
<tr class="memdesc:ac032639db8f6f1230f759afd3775c200 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send one structure to destination process.  <a href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">More...</a><br /></td></tr>
<tr class="separator:ac032639db8f6f1230f759afd3775c200 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57630554119a518ecb32d5e1f327256f inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">recvStructure</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> *structure, int src)</td></tr>
<tr class="memdesc:a57630554119a518ecb32d5e1f327256f inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive one structure from source process.  <a href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">More...</a><br /></td></tr>
<tr class="separator:a57630554119a518ecb32d5e1f327256f inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ecb649e652e2c6acb83102340f48afd inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">distributeStructures</a> (bool randomize, bool excludeRank0=false, std::string const &amp;fileName=&quot;input.data&quot;)</td></tr>
<tr class="memdesc:a1ecb649e652e2c6acb83102340f48afd inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data file and distribute structures among processors.  <a href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">More...</a><br /></td></tr>
<tr class="separator:a1ecb649e652e2c6acb83102340f48afd inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa932aedf7af8cf3daea1cae02c3602c4 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">prepareNumericForces</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;original, double delta)</td></tr>
<tr class="memdesc:aa932aedf7af8cf3daea1cae02c3602c4 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare numeric force check for a single structure.  <a href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">More...</a><br /></td></tr>
<tr class="separator:aa932aedf7af8cf3daea1cae02c3602c4 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe9632070e632592b6f3d78e4529d3a inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#affe9632070e632592b6f3d78e4529d3a">toNormalizedUnits</a> ()</td></tr>
<tr class="memdesc:affe9632070e632592b6f3d78e4529d3a inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch all structures to normalized units.  <a href="classnnp_1_1Dataset.html#affe9632070e632592b6f3d78e4529d3a">More...</a><br /></td></tr>
<tr class="separator:affe9632070e632592b6f3d78e4529d3a inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa99d82945d6250000d26f53173d855c3 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#aa99d82945d6250000d26f53173d855c3">toPhysicalUnits</a> ()</td></tr>
<tr class="memdesc:aa99d82945d6250000d26f53173d855c3 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch all structures to physical units.  <a href="classnnp_1_1Dataset.html#aa99d82945d6250000d26f53173d855c3">More...</a><br /></td></tr>
<tr class="separator:aa99d82945d6250000d26f53173d855c3 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a204e7dc1bdf91a515b18a0ef06704c inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a1a204e7dc1bdf91a515b18a0ef06704c">collectSymmetryFunctionStatistics</a> ()</td></tr>
<tr class="memdesc:a1a204e7dc1bdf91a515b18a0ef06704c inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect symmetry function statistics from all processors.  <a href="classnnp_1_1Dataset.html#a1a204e7dc1bdf91a515b18a0ef06704c">More...</a><br /></td></tr>
<tr class="separator:a1a204e7dc1bdf91a515b18a0ef06704c inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1623c2ddd9e673d12586e067ae536cc8 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a1623c2ddd9e673d12586e067ae536cc8">writeSymmetryFunctionScaling</a> (std::string const &amp;fileName=&quot;scaling.data&quot;)</td></tr>
<tr class="memdesc:a1623c2ddd9e673d12586e067ae536cc8 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write symmetry function scaling values to file.  <a href="classnnp_1_1Dataset.html#a1623c2ddd9e673d12586e067ae536cc8">More...</a><br /></td></tr>
<tr class="separator:a1623c2ddd9e673d12586e067ae536cc8 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb4a2760ca7eb9c03e2ea37474a431c0 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#abb4a2760ca7eb9c03e2ea37474a431c0">writeSymmetryFunctionHistograms</a> (std::size_t numBins, std::string fileNameFormat=&quot;sf.%03zu.%04zu.histo&quot;)</td></tr>
<tr class="memdesc:abb4a2760ca7eb9c03e2ea37474a431c0 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate and write symmetry function histograms.  <a href="classnnp_1_1Dataset.html#abb4a2760ca7eb9c03e2ea37474a431c0">More...</a><br /></td></tr>
<tr class="separator:abb4a2760ca7eb9c03e2ea37474a431c0 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa12823183030d6cff2e059e860d15671 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#aa12823183030d6cff2e059e860d15671">writeSymmetryFunctionFile</a> (std::string fileName=&quot;function.data&quot;)</td></tr>
<tr class="memdesc:aa12823183030d6cff2e059e860d15671 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write symmetry function legacy file ("function.data").  <a href="classnnp_1_1Dataset.html#aa12823183030d6cff2e059e860d15671">More...</a><br /></td></tr>
<tr class="separator:aa12823183030d6cff2e059e860d15671 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbdec01079adc087d702d5e7fddf2494 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#afbdec01079adc087d702d5e7fddf2494">writeNeighborHistogram</a> (std::string const &amp;fileName=&quot;neighbors.histo&quot;)</td></tr>
<tr class="memdesc:afbdec01079adc087d702d5e7fddf2494 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate and write neighbor histogram.  <a href="classnnp_1_1Dataset.html#afbdec01079adc087d702d5e7fddf2494">More...</a><br /></td></tr>
<tr class="separator:afbdec01079adc087d702d5e7fddf2494 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72dd2973c5732479df5d76389fd5466f inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a72dd2973c5732479df5d76389fd5466f">sortNeighborLists</a> ()</td></tr>
<tr class="memdesc:a72dd2973c5732479df5d76389fd5466f inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort all neighbor lists according to element and distance.  <a href="classnnp_1_1Dataset.html#a72dd2973c5732479df5d76389fd5466f">More...</a><br /></td></tr>
<tr class="separator:a72dd2973c5732479df5d76389fd5466f inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fdf6f361d7e65d31fe1002d6a9aacfd inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a7fdf6f361d7e65d31fe1002d6a9aacfd">writeNeighborLists</a> (std::string const &amp;fileName=&quot;neighbor-list.data&quot;)</td></tr>
<tr class="memdesc:a7fdf6f361d7e65d31fe1002d6a9aacfd inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write neighbor list file.  <a href="classnnp_1_1Dataset.html#a7fdf6f361d7e65d31fe1002d6a9aacfd">More...</a><br /></td></tr>
<tr class="separator:a7fdf6f361d7e65d31fe1002d6a9aacfd inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f59129925f9a0fa7fe2db87dd60e1df inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a7f59129925f9a0fa7fe2db87dd60e1df">writeAtomicEnvironmentFile</a> (std::vector&lt; std::vector&lt; std::size_t &gt; &gt; neighCutoff, bool derivatives, std::string const &amp;fileNamePrefix=&quot;atomic-env&quot;)</td></tr>
<tr class="memdesc:a7f59129925f9a0fa7fe2db87dd60e1df inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write atomic environment file.  <a href="classnnp_1_1Dataset.html#a7f59129925f9a0fa7fe2db87dd60e1df">More...</a><br /></td></tr>
<tr class="separator:a7f59129925f9a0fa7fe2db87dd60e1df inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af767ead6aee5477b94c95fc5db7be2b2 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">collectError</a> (std::string const &amp;property, std::map&lt; std::string, double &gt; &amp;error, std::size_t &amp;count) const</td></tr>
<tr class="memdesc:af767ead6aee5477b94c95fc5db7be2b2 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect error metrics of a property over all MPI procs.  <a href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">More...</a><br /></td></tr>
<tr class="separator:af767ead6aee5477b94c95fc5db7be2b2 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb7687f6863a18f901b4b13bdd88d225 inherit pub_methods_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a> (std::string filePrefix) const</td></tr>
<tr class="memdesc:acb7687f6863a18f901b4b13bdd88d225 inherit pub_methods_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine individual MPI proc files to one.  <a href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">More...</a><br /></td></tr>
<tr class="separator:acb7687f6863a18f901b4b13bdd88d225 inherit pub_methods_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classnnp_1_1Mode"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classnnp_1_1Mode')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classnnp_1_1Mode.html">nnp::Mode</a></td></tr>
<tr class="memitem:a098246baedeee64fa0ed3b53547cf55f inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a098246baedeee64fa0ed3b53547cf55f">Mode</a> ()</td></tr>
<tr class="separator:a098246baedeee64fa0ed3b53547cf55f inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a68b9d8750ddc0b440b1828ecf9f17 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a19a68b9d8750ddc0b440b1828ecf9f17">initialize</a> ()</td></tr>
<tr class="memdesc:a19a68b9d8750ddc0b440b1828ecf9f17 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write welcome message with version information.  <a href="classnnp_1_1Mode.html#a19a68b9d8750ddc0b440b1828ecf9f17">More...</a><br /></td></tr>
<tr class="separator:a19a68b9d8750ddc0b440b1828ecf9f17 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ca16789e7794309cf9931e58eb882b inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ae8ca16789e7794309cf9931e58eb882b">loadSettingsFile</a> (std::string const &amp;fileName=&quot;input.nn&quot;)</td></tr>
<tr class="memdesc:ae8ca16789e7794309cf9931e58eb882b inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open settings file and load all keywords into memory.  <a href="classnnp_1_1Mode.html#ae8ca16789e7794309cf9931e58eb882b">More...</a><br /></td></tr>
<tr class="separator:ae8ca16789e7794309cf9931e58eb882b inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb133ac96714931b66435ce7a9315c2 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#abbb133ac96714931b66435ce7a9315c2">setupGeneric</a> (bool skipNormalize=false)</td></tr>
<tr class="memdesc:abbb133ac96714931b66435ce7a9315c2 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine multiple setup routines and provide a basic NNP setup.  <a href="classnnp_1_1Mode.html#abbb133ac96714931b66435ce7a9315c2">More...</a><br /></td></tr>
<tr class="separator:abbb133ac96714931b66435ce7a9315c2 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d84a9ab4ad3b589c5f5bb89f2b2fa5b inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b">setupNormalization</a> (bool standalone=true)</td></tr>
<tr class="memdesc:a0d84a9ab4ad3b589c5f5bb89f2b2fa5b inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up normalization.  <a href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b">More...</a><br /></td></tr>
<tr class="separator:a0d84a9ab4ad3b589c5f5bb89f2b2fa5b inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259303c95ae2f64f2b192de1b2df51f5 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap</a> ()</td></tr>
<tr class="memdesc:a259303c95ae2f64f2b192de1b2df51f5 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the element map.  <a href="classnnp_1_1Mode.html#a259303c95ae2f64f2b192de1b2df51f5">More...</a><br /></td></tr>
<tr class="separator:a259303c95ae2f64f2b192de1b2df51f5 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4e43a8f905900eb4ea153d529053ec inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#afc4e43a8f905900eb4ea153d529053ec">setupElements</a> ()</td></tr>
<tr class="memdesc:afc4e43a8f905900eb4ea153d529053ec inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up all <a class="el" href="classnnp_1_1Element.html" title="Contains element-specific data.">Element</a> instances.  <a href="classnnp_1_1Mode.html#afc4e43a8f905900eb4ea153d529053ec">More...</a><br /></td></tr>
<tr class="separator:afc4e43a8f905900eb4ea153d529053ec inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae72c03926dc7ea9b8f43770fb5861ccf inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff</a> ()</td></tr>
<tr class="memdesc:ae72c03926dc7ea9b8f43770fb5861ccf inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up cutoff function for all symmetry functions.  <a href="classnnp_1_1Mode.html#ae72c03926dc7ea9b8f43770fb5861ccf">More...</a><br /></td></tr>
<tr class="separator:ae72c03926dc7ea9b8f43770fb5861ccf inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0080b25ea49cdd6ce085162751a379b inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions</a> ()</td></tr>
<tr class="memdesc:ad0080b25ea49cdd6ce085162751a379b inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up all symmetry functions.  <a href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b">More...</a><br /></td></tr>
<tr class="separator:ad0080b25ea49cdd6ce085162751a379b inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a672cac54995b226d8e69bb8be2669d inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a9a672cac54995b226d8e69bb8be2669d">setupSymmetryFunctionScalingNone</a> ()</td></tr>
<tr class="memdesc:a9a672cac54995b226d8e69bb8be2669d inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up "empy" symmetry function scaling.  <a href="classnnp_1_1Mode.html#a9a672cac54995b226d8e69bb8be2669d">More...</a><br /></td></tr>
<tr class="separator:a9a672cac54995b226d8e69bb8be2669d inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26222b7b9dc3fd141f6e775690b5d2b inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling</a> (std::string const &amp;fileName=&quot;scaling.data&quot;)</td></tr>
<tr class="memdesc:aa26222b7b9dc3fd141f6e775690b5d2b inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function scaling from file.  <a href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b">More...</a><br /></td></tr>
<tr class="separator:aa26222b7b9dc3fd141f6e775690b5d2b inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0184f87845a572cf4c3db0958a97d9 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups</a> ()</td></tr>
<tr class="memdesc:a6f0184f87845a572cf4c3db0958a97d9 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function groups.  <a href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9">More...</a><br /></td></tr>
<tr class="separator:a6f0184f87845a572cf4c3db0958a97d9 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357dcaa8cac497e973ab9048f0aa00c2 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2">setupSymmetryFunctionCache</a> (bool verbose=false)</td></tr>
<tr class="memdesc:a357dcaa8cac497e973ab9048f0aa00c2 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function cache.  <a href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2">More...</a><br /></td></tr>
<tr class="separator:a357dcaa8cac497e973ab9048f0aa00c2 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d1548ef2d6a9bbfdc519b76b904700 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory</a> (bool verbose=false)</td></tr>
<tr class="memdesc:af1d1548ef2d6a9bbfdc519b76b904700 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract required memory dimensions for symmetry function derivatives.  <a href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700">More...</a><br /></td></tr>
<tr class="separator:af1d1548ef2d6a9bbfdc519b76b904700 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b348e9b5e2ef89cb30c760bdb55153 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics</a> (bool collectStatistics, bool collectExtrapolationWarnings, bool writeExtrapolationWarnings, bool stopOnExtrapolationWarnings)</td></tr>
<tr class="memdesc:ae4b348e9b5e2ef89cb30c760bdb55153 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function statistics collection.  <a href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153">More...</a><br /></td></tr>
<tr class="separator:ae4b348e9b5e2ef89cb30c760bdb55153 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3488a7fb2b0ccf17a9b2af514590f57c inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork</a> ()</td></tr>
<tr class="memdesc:a3488a7fb2b0ccf17a9b2af514590f57c inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up neural networks for all elements.  <a href="classnnp_1_1Mode.html#a3488a7fb2b0ccf17a9b2af514590f57c">More...</a><br /></td></tr>
<tr class="separator:a3488a7fb2b0ccf17a9b2af514590f57c inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d40ea3edb704b1bc685d67c5e9b7eac inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a7d40ea3edb704b1bc685d67c5e9b7eac">setupNeuralNetworkWeights</a> (std::string const &amp;fileNameFormatShort=&quot;weights.%03zu.data&quot;, std::string const &amp;fileNameFormatCharge=&quot;weightse.%03zu.data&quot;)</td></tr>
<tr class="memdesc:a7d40ea3edb704b1bc685d67c5e9b7eac inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up neural network weights from files.  <a href="classnnp_1_1Mode.html#a7d40ea3edb704b1bc685d67c5e9b7eac">More...</a><br /></td></tr>
<tr class="separator:a7d40ea3edb704b1bc685d67c5e9b7eac inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add11e3c30eb86aba38d8239d1e5d8736 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure, bool const derivatives)</td></tr>
<tr class="memdesc:add11e3c30eb86aba38d8239d1e5d8736 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate all symmetry functions for all atoms in given structure.  <a href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">More...</a><br /></td></tr>
<tr class="separator:add11e3c30eb86aba38d8239d1e5d8736 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aec6fb4708b93b93a9cfa0e8045f955 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure, bool const derivatives)</td></tr>
<tr class="memdesc:a8aec6fb4708b93b93a9cfa0e8045f955 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate all symmetry function groups for all atoms in given structure.  <a href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">More...</a><br /></td></tr>
<tr class="separator:a8aec6fb4708b93b93a9cfa0e8045f955 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a778e3d7087b98c31effaa4129d23c6d7 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">calculateAtomicNeuralNetworks</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure, bool const derivatives)</td></tr>
<tr class="memdesc:a778e3d7087b98c31effaa4129d23c6d7 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a single atomic neural network for a given atom and nn type.  <a href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">More...</a><br /></td></tr>
<tr class="separator:a778e3d7087b98c31effaa4129d23c6d7 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fb8800851f3d440fcf393cbc073308 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:a88fb8800851f3d440fcf393cbc073308 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate potential energy for a given structure.  <a href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">More...</a><br /></td></tr>
<tr class="separator:a88fb8800851f3d440fcf393cbc073308 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71da5d31be39935bdc3c7202ba23a2e inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">calculateCharge</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:ac71da5d31be39935bdc3c7202ba23a2e inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate total charge for a given structure.  <a href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">More...</a><br /></td></tr>
<tr class="separator:ac71da5d31be39935bdc3c7202ba23a2e inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fddd6f29bb63ef67b9619544d81ab1 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:ae2fddd6f29bb63ef67b9619544d81ab1 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate forces for all atoms in given structure.  <a href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">More...</a><br /></td></tr>
<tr class="separator:ae2fddd6f29bb63ef67b9619544d81ab1 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ba3ecbce972ff28d7a17bdade38674 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">addEnergyOffset</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure, bool ref=true)</td></tr>
<tr class="memdesc:a17ba3ecbce972ff28d7a17bdade38674 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add atomic energy offsets to reference energy.  <a href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">More...</a><br /></td></tr>
<tr class="separator:a17ba3ecbce972ff28d7a17bdade38674 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ddf0701dbcd60868955ca556892bc5 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">removeEnergyOffset</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure, bool ref=true)</td></tr>
<tr class="memdesc:aa8ddf0701dbcd60868955ca556892bc5 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove atomic energy offsets from reference energy.  <a href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">More...</a><br /></td></tr>
<tr class="separator:aa8ddf0701dbcd60868955ca556892bc5 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05a24414c9b595a8ccb95b05b5030de inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#af05a24414c9b595a8ccb95b05b5030de">getEnergyOffset</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure) const</td></tr>
<tr class="memdesc:af05a24414c9b595a8ccb95b05b5030de inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get atomic energy offset for given structure.  <a href="classnnp_1_1Mode.html#af05a24414c9b595a8ccb95b05b5030de">More...</a><br /></td></tr>
<tr class="separator:af05a24414c9b595a8ccb95b05b5030de inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86800b032be86f1321d3f6683c75b01 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">getEnergyWithOffset</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:ab86800b032be86f1321d3f6683c75b01 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add atomic energy offsets and return energy.  <a href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">More...</a><br /></td></tr>
<tr class="separator:ab86800b032be86f1321d3f6683c75b01 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7607132302e2b0f3e1a9dec67cd24062 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a7607132302e2b0f3e1a9dec67cd24062">normalized</a> (std::string const &amp;property, double value) const</td></tr>
<tr class="memdesc:a7607132302e2b0f3e1a9dec67cd24062 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization to given property.  <a href="classnnp_1_1Mode.html#a7607132302e2b0f3e1a9dec67cd24062">More...</a><br /></td></tr>
<tr class="separator:a7607132302e2b0f3e1a9dec67cd24062 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5d51e9328414aea8106d85bde5a1729 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">normalizedEnergy</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:af5d51e9328414aea8106d85bde5a1729 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization to given energy of structure.  <a href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">More...</a><br /></td></tr>
<tr class="separator:af5d51e9328414aea8106d85bde5a1729 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a74c4b42491ec361d8d9192cd43c82b inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">physical</a> (std::string const &amp;property, double value) const</td></tr>
<tr class="memdesc:a6a74c4b42491ec361d8d9192cd43c82b inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo normalization for a given property.  <a href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">More...</a><br /></td></tr>
<tr class="separator:a6a74c4b42491ec361d8d9192cd43c82b inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d558483ab82d340ee587febcfddd8f inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">physicalEnergy</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:a02d558483ab82d340ee587febcfddd8f inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo normalization for a given energy of structure.  <a href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">More...</a><br /></td></tr>
<tr class="separator:a02d558483ab82d340ee587febcfddd8f inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8353f189a07813687e6cda9dff5ef55a inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a">convertToNormalizedUnits</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:a8353f189a07813687e6cda9dff5ef55a inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert one structure to normalized units.  <a href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a">More...</a><br /></td></tr>
<tr class="separator:a8353f189a07813687e6cda9dff5ef55a inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe07bd6a67b5df0b6dd5f5ce00fb1f6 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">convertToPhysicalUnits</a> (<a class="el" href="structnnp_1_1Structure.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:abbe07bd6a67b5df0b6dd5f5ce00fb1f6 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert one structure to physical units.  <a href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">More...</a><br /></td></tr>
<tr class="separator:abbe07bd6a67b5df0b6dd5f5ce00fb1f6 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73bc18bc5e85e53303fea2132c4e78c inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aa73bc18bc5e85e53303fea2132c4e78c">getNumExtrapolationWarnings</a> () const</td></tr>
<tr class="memdesc:aa73bc18bc5e85e53303fea2132c4e78c inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count total number of extrapolation warnings encountered for all elements and symmetry functions.  <a href="classnnp_1_1Mode.html#aa73bc18bc5e85e53303fea2132c4e78c">More...</a><br /></td></tr>
<tr class="separator:aa73bc18bc5e85e53303fea2132c4e78c inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71571b8b4742c474c645fa50ffa667e inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ab71571b8b4742c474c645fa50ffa667e">resetExtrapolationWarnings</a> ()</td></tr>
<tr class="memdesc:ab71571b8b4742c474c645fa50ffa667e inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase all extrapolation warnings and reset counters.  <a href="classnnp_1_1Mode.html#ab71571b8b4742c474c645fa50ffa667e">More...</a><br /></td></tr>
<tr class="separator:ab71571b8b4742c474c645fa50ffa667e inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07765f9f29bb8cd798c6d82721a8711d inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8c">NNPType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a07765f9f29bb8cd798c6d82721a8711d">getNnpType</a> () const</td></tr>
<tr class="memdesc:a07765f9f29bb8cd798c6d82721a8711d inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">Mode::nnpType</a>.  <a href="classnnp_1_1Mode.html#a07765f9f29bb8cd798c6d82721a8711d">More...</a><br /></td></tr>
<tr class="separator:a07765f9f29bb8cd798c6d82721a8711d inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e30b5a1e840dc2a98516a0f276a3c4 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ab6e30b5a1e840dc2a98516a0f276a3c4">getMeanEnergy</a> () const</td></tr>
<tr class="memdesc:ab6e30b5a1e840dc2a98516a0f276a3c4 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">Mode::meanEnergy</a>.  <a href="classnnp_1_1Mode.html#ab6e30b5a1e840dc2a98516a0f276a3c4">More...</a><br /></td></tr>
<tr class="separator:ab6e30b5a1e840dc2a98516a0f276a3c4 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da7486dc693fafe772c12a440a623d8 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a8da7486dc693fafe772c12a440a623d8">getConvEnergy</a> () const</td></tr>
<tr class="memdesc:a8da7486dc693fafe772c12a440a623d8 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">Mode::convEnergy</a>.  <a href="classnnp_1_1Mode.html#a8da7486dc693fafe772c12a440a623d8">More...</a><br /></td></tr>
<tr class="separator:a8da7486dc693fafe772c12a440a623d8 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373073bd1acb1c9ac293369bb892bdc4 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a373073bd1acb1c9ac293369bb892bdc4">getConvLength</a> () const</td></tr>
<tr class="memdesc:a373073bd1acb1c9ac293369bb892bdc4 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">Mode::convLength</a>.  <a href="classnnp_1_1Mode.html#a373073bd1acb1c9ac293369bb892bdc4">More...</a><br /></td></tr>
<tr class="separator:a373073bd1acb1c9ac293369bb892bdc4 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73f1fcdcbb76828f6aca2d322bfeb2a9 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a73f1fcdcbb76828f6aca2d322bfeb2a9">getMaxCutoffRadius</a> () const</td></tr>
<tr class="memdesc:a73f1fcdcbb76828f6aca2d322bfeb2a9 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">Mode::maxCutoffRadius</a>.  <a href="classnnp_1_1Mode.html#a73f1fcdcbb76828f6aca2d322bfeb2a9">More...</a><br /></td></tr>
<tr class="separator:a73f1fcdcbb76828f6aca2d322bfeb2a9 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbf87eaa9cc33fa740e03608acdf156 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a2dbf87eaa9cc33fa740e03608acdf156">getNumElements</a> () const</td></tr>
<tr class="memdesc:a2dbf87eaa9cc33fa740e03608acdf156 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">Mode::numElements</a>.  <a href="classnnp_1_1Mode.html#a2dbf87eaa9cc33fa740e03608acdf156">More...</a><br /></td></tr>
<tr class="separator:a2dbf87eaa9cc33fa740e03608acdf156 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fc3399c130a3778a20a625fa2ee34c inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aa4fc3399c130a3778a20a625fa2ee34c">getNumSymmetryFunctions</a> () const</td></tr>
<tr class="memdesc:aa4fc3399c130a3778a20a625fa2ee34c inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of symmetry functions per element.  <a href="classnnp_1_1Mode.html#aa4fc3399c130a3778a20a625fa2ee34c">More...</a><br /></td></tr>
<tr class="separator:aa4fc3399c130a3778a20a625fa2ee34c inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c500a49ebbd16752c9dbe988f56f451 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a7c500a49ebbd16752c9dbe988f56f451">useNormalization</a> () const</td></tr>
<tr class="memdesc:a7c500a49ebbd16752c9dbe988f56f451 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if normalization is enabled.  <a href="classnnp_1_1Mode.html#a7c500a49ebbd16752c9dbe988f56f451">More...</a><br /></td></tr>
<tr class="separator:a7c500a49ebbd16752c9dbe988f56f451 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9606884fa146912a6b4ab6d26df9275 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aa9606884fa146912a6b4ab6d26df9275">settingsKeywordExists</a> (std::string const &amp;keyword) const</td></tr>
<tr class="memdesc:aa9606884fa146912a6b4ab6d26df9275 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if keyword was found in settings file.  <a href="classnnp_1_1Mode.html#aa9606884fa146912a6b4ab6d26df9275">More...</a><br /></td></tr>
<tr class="separator:aa9606884fa146912a6b4ab6d26df9275 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7eeb5daa541cc8e3ab36a9bcf69ab8 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">settingsGetValue</a> (std::string const &amp;keyword) const</td></tr>
<tr class="memdesc:a9b7eeb5daa541cc8e3ab36a9bcf69ab8 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get value for given keyword in <a class="el" href="classnnp_1_1Settings.html" title="Reads and analyzes settings file and stores parameters.">Settings</a> instance.  <a href="classnnp_1_1Mode.html#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">More...</a><br /></td></tr>
<tr class="separator:a9b7eeb5daa541cc8e3ab36a9bcf69ab8 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b8ceb8be242844ec8b72987e0bf0c3e inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a5b8ceb8be242844ec8b72987e0bf0c3e">pruneSymmetryFunctionsRange</a> (double threshold)</td></tr>
<tr class="memdesc:a5b8ceb8be242844ec8b72987e0bf0c3e inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prune symmetry functions according to their range and write settings file.  <a href="classnnp_1_1Mode.html#a5b8ceb8be242844ec8b72987e0bf0c3e">More...</a><br /></td></tr>
<tr class="separator:a5b8ceb8be242844ec8b72987e0bf0c3e inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae922768942eef6c6e9000700595bc00d inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#ae922768942eef6c6e9000700595bc00d">pruneSymmetryFunctionsSensitivity</a> (double threshold, std::vector&lt; std::vector&lt; double &gt; &gt; sensitivity)</td></tr>
<tr class="memdesc:ae922768942eef6c6e9000700595bc00d inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prune symmetry functions with sensitivity analysis data.  <a href="classnnp_1_1Mode.html#ae922768942eef6c6e9000700595bc00d">More...</a><br /></td></tr>
<tr class="separator:ae922768942eef6c6e9000700595bc00d inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac0b02c0a91917b17cd6e2fb96afb18 inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a6ac0b02c0a91917b17cd6e2fb96afb18">writePrunedSettingsFile</a> (std::vector&lt; std::size_t &gt; prune, std::string fileName=&quot;output.nn&quot;) const</td></tr>
<tr class="memdesc:a6ac0b02c0a91917b17cd6e2fb96afb18 inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy settings file but comment out lines provided.  <a href="classnnp_1_1Mode.html#a6ac0b02c0a91917b17cd6e2fb96afb18">More...</a><br /></td></tr>
<tr class="separator:a6ac0b02c0a91917b17cd6e2fb96afb18 inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2d61853475185baae3fa3a7d358557a inherit pub_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a">writeSettingsFile</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:af2d61853475185baae3fa3a7d358557a inherit pub_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write complete settings file.  <a href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a">More...</a><br /></td></tr>
<tr class="separator:af2d61853475185baae3fa3a7d358557a inherit pub_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a6c96bd09f7bae33a10ccca37cb655f0e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">advance</a> () const</td></tr>
<tr class="memdesc:a6c96bd09f7bae33a10ccca37cb655f0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if training loop should be continued.  <a href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">More...</a><br /></td></tr>
<tr class="separator:a6c96bd09f7bae33a10ccca37cb655f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7a7553f60ebf30dbdfb8efc64b32c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights</a> ()</td></tr>
<tr class="memdesc:a9e7a7553f60ebf30dbdfb8efc64b32c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get weights from neural network class.  <a href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">More...</a><br /></td></tr>
<tr class="separator:a9e7a7553f60ebf30dbdfb8efc64b32c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82549ec0800f63ffaf830b46f865cdbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights</a> ()</td></tr>
<tr class="memdesc:a82549ec0800f63ffaf830b46f865cdbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set weights in neural network class.  <a href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">More...</a><br /></td></tr>
<tr class="separator:a82549ec0800f63ffaf830b46f865cdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e6d295200728de7780f6796b86593f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry</a> (int proc, std::size_t il, double f, std::size_t isg, std::size_t is)</td></tr>
<tr class="memdesc:a94e6d295200728de7780f6796b86593f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write energy update data to training log file.  <a href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">More...</a><br /></td></tr>
<tr class="separator:a94e6d295200728de7780f6796b86593f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b44b3fdc51d3a16c6d0f8b13ec2f1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a74b44b3fdc51d3a16c6d0f8b13ec2f1f">addTrainingLogEntry</a> (int proc, std::size_t il, double f, std::size_t isg, std::size_t is, std::size_t ia, std::size_t ic)</td></tr>
<tr class="memdesc:a74b44b3fdc51d3a16c6d0f8b13ec2f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write force update data to training log file.  <a href="classnnp_1_1Training.html#a74b44b3fdc51d3a16c6d0f8b13ec2f1f">More...</a><br /></td></tr>
<tr class="separator:a74b44b3fdc51d3a16c6d0f8b13ec2f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac204d69eac864cb4286a0f26ddd8d048"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ac204d69eac864cb4286a0f26ddd8d048">addTrainingLogEntry</a> (int proc, std::size_t il, double f, std::size_t isg, std::size_t is, std::size_t ia)</td></tr>
<tr class="memdesc:ac204d69eac864cb4286a0f26ddd8d048"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write charge update data to training log file.  <a href="classnnp_1_1Training.html#ac204d69eac864cb4286a0f26ddd8d048">More...</a><br /></td></tr>
<tr class="separator:ac204d69eac864cb4286a0f26ddd8d048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80d3c7681f0727847d717ab7a333abbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia</a> (<a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;atom, std::size_t indexAtom, std::size_t indexComponent)</td></tr>
<tr class="memdesc:a80d3c7681f0727847d717ab7a333abbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect derivative of symmetry functions with repect to one atom's coordinate.  <a href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">More...</a><br /></td></tr>
<tr class="separator:a80d3c7681f0727847d717ab7a333abbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a111011beb9eb1fb43550139a615b2b39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">randomizeNeuralNetworkWeights</a> (std::string const &amp;type)</td></tr>
<tr class="memdesc:a111011beb9eb1fb43550139a615b2b39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly initialize specificy neural network weights.  <a href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">More...</a><br /></td></tr>
<tr class="separator:a111011beb9eb1fb43550139a615b2b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5362ed9fa8992ca8ec88ab5c6daab978"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:a5362ed9fa8992ca8ec88ab5c6daab978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set selection mode for specific training property.  <a href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">More...</a><br /></td></tr>
<tr class="separator:a5362ed9fa8992ca8ec88ab5c6daab978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a99d257e8c71aaf4dba65a1b9a1b5f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput</a> (std::string const &amp;type)</td></tr>
<tr class="memdesc:a8a99d257e8c71aaf4dba65a1b9a1b5f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set file output intervals for properties and other quantities.  <a href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">More...</a><br /></td></tr>
<tr class="separator:a8a99d257e8c71aaf4dba65a1b9a1b5f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6d1ab9f793927b8c1d5fa707922c78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:afd6d1ab9f793927b8c1d5fa707922c78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up how often properties are updated.  <a href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">More...</a><br /></td></tr>
<tr class="separator:afd6d1ab9f793927b8c1d5fa707922c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33e73c163ea6a69fc0d87acd735fd9e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays</a> (std::string const &amp;property)</td></tr>
<tr class="memdesc:a33e73c163ea6a69fc0d87acd735fd9e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate error and Jacobian arrays for given property.  <a href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">More...</a><br /></td></tr>
<tr class="separator:a33e73c163ea6a69fc0d87acd735fd9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9920793c17beef42f87017464599f464"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData</a> (bool append, std::string const fileName=&quot;timing.out&quot;)</td></tr>
<tr class="memdesc:a9920793c17beef42f87017464599f464"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write timing data for all clocks.  <a href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">More...</a><br /></td></tr>
<tr class="separator:a9920793c17beef42f87017464599f464"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a03f9d45ef8680c15e578906298a1b891"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">UpdaterType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a></td></tr>
<tr class="memdesc:a03f9d45ef8680c15e578906298a1b891"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classnnp_1_1Updater.html" title="Base class for different weight update methods.">Updater</a> type used.  <a href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">More...</a><br /></td></tr>
<tr class="separator:a03f9d45ef8680c15e578906298a1b891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bec3d1ad183e620687bf41ede6f5ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">ParallelMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a></td></tr>
<tr class="memdesc:ac2bec3d1ad183e620687bf41ede6f5ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallelization mode used.  <a href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">More...</a><br /></td></tr>
<tr class="separator:ac2bec3d1ad183e620687bf41ede6f5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa8fc039bdb2b4a083433fd56507f14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">JacobianMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a></td></tr>
<tr class="memdesc:a3fa8fc039bdb2b4a083433fd56507f14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jacobian mode used.  <a href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">More...</a><br /></td></tr>
<tr class="separator:a3fa8fc039bdb2b4a083433fd56507f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9949593aada759d082eae33a3da04c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a></td></tr>
<tr class="memdesc:ab9949593aada759d082eae33a3da04c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update strategy used.  <a href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">More...</a><br /></td></tr>
<tr class="separator:ab9949593aada759d082eae33a3da04c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c709ea24c0cb6ea3bfdaaae6efd2202"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a></td></tr>
<tr class="memdesc:a3c709ea24c0cb6ea3bfdaaae6efd2202"><td class="mdescLeft">&#160;</td><td class="mdescRight">If this rank performs weight updates.  <a href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">More...</a><br /></td></tr>
<tr class="separator:a3c709ea24c0cb6ea3bfdaaae6efd2202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee2583a1323180d235f16717111f39e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a></td></tr>
<tr class="memdesc:aeee2583a1323180d235f16717111f39e"><td class="mdescLeft">&#160;</td><td class="mdescRight">If this rank holds structure information.  <a href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">More...</a><br /></td></tr>
<tr class="separator:aeee2583a1323180d235f16717111f39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178647e7ce5eca9f6bb7cc4c371909f3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a></td></tr>
<tr class="memdesc:a178647e7ce5eca9f6bb7cc4c371909f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use forces for training.  <a href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">More...</a><br /></td></tr>
<tr class="separator:a178647e7ce5eca9f6bb7cc4c371909f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e2ffef22c4331c2892ddbd01436ec6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">repeatedEnergyUpdates</a></td></tr>
<tr class="memdesc:ab8e2ffef22c4331c2892ddbd01436ec6"><td class="mdescLeft">&#160;</td><td class="mdescRight">After force update perform energy update for corresponding structure.  <a href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">More...</a><br /></td></tr>
<tr class="separator:ab8e2ffef22c4331c2892ddbd01436ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4986e0d008729499003bdf5d2ff59e6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a></td></tr>
<tr class="memdesc:af4986e0d008729499003bdf5d2ff59e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free symmetry function memory after calculation.  <a href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">More...</a><br /></td></tr>
<tr class="separator:af4986e0d008729499003bdf5d2ff59e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671f1f45d0b277daec4da583d0f9ce7b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a></td></tr>
<tr class="memdesc:a671f1f45d0b277daec4da583d0f9ce7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether training log file is written.  <a href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">More...</a><br /></td></tr>
<tr class="separator:a671f1f45d0b277daec4da583d0f9ce7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d44c6d46a17bc5a5f85898c2a70d348"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a></td></tr>
<tr class="memdesc:a7d44c6d46a17bc5a5f85898c2a70d348"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> stage.  <a href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">More...</a><br /></td></tr>
<tr class="separator:a7d44c6d46a17bc5a5f85898c2a70d348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e80f07031867155a7fbc4f480a2bd0"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a></td></tr>
<tr class="memdesc:a68e80f07031867155a7fbc4f480a2bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of updaters (depends on update strategy).  <a href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">More...</a><br /></td></tr>
<tr class="separator:a68e80f07031867155a7fbc4f480a2bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a30db3b7747df34b72d89cdfb791eb0"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a></td></tr>
<tr class="memdesc:a8a30db3b7747df34b72d89cdfb791eb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of epochs requested.  <a href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">More...</a><br /></td></tr>
<tr class="separator:a8a30db3b7747df34b72d89cdfb791eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b98e274dffce06459a1c29a05e90a7"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a></td></tr>
<tr class="memdesc:a08b98e274dffce06459a1c29a05e90a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current epoch.  <a href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">More...</a><br /></td></tr>
<tr class="separator:a08b98e274dffce06459a1c29a05e90a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5d0fda76e8e10fd700405323bd9713"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a></td></tr>
<tr class="memdesc:a2a5d0fda76e8e10fd700405323bd9713"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write weights every this many epochs.  <a href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">More...</a><br /></td></tr>
<tr class="separator:a2a5d0fda76e8e10fd700405323bd9713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103de589f43d89513b741cea0bdbf541"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a></td></tr>
<tr class="memdesc:a103de589f43d89513b741cea0bdbf541"><td class="mdescLeft">&#160;</td><td class="mdescRight">Up to this epoch weights are written every epoch.  <a href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">More...</a><br /></td></tr>
<tr class="separator:a103de589f43d89513b741cea0bdbf541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be53bf5fcdbefa900c9c7f8a8a6bb40"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a></td></tr>
<tr class="memdesc:a9be53bf5fcdbefa900c9c7f8a8a6bb40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write neuron statistics every this many epochs.  <a href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">More...</a><br /></td></tr>
<tr class="separator:a9be53bf5fcdbefa900c9c7f8a8a6bb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a21e51fe6761fe3a3a44533d70603d"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a></td></tr>
<tr class="memdesc:a61a21e51fe6761fe3a3a44533d70603d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Up to this epoch neuron statistics are written every epoch.  <a href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">More...</a><br /></td></tr>
<tr class="separator:a61a21e51fe6761fe3a3a44533d70603d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4daf50292f3efe2614a473be9ab1192f"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a></td></tr>
<tr class="memdesc:a4daf50292f3efe2614a473be9ab1192f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update counter (for all training quantities together).  <a href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">More...</a><br /></td></tr>
<tr class="separator:a4daf50292f3efe2614a473be9ab1192f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ce267846960e602130171ebd485763"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a></td></tr>
<tr class="memdesc:a14ce267846960e602130171ebd485763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of weights.  <a href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">More...</a><br /></td></tr>
<tr class="separator:a14ce267846960e602130171ebd485763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a1bb27c4a92c6a504588e4ace64892"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a></td></tr>
<tr class="memdesc:a63a1bb27c4a92c6a504588e4ace64892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force update weight.  <a href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">More...</a><br /></td></tr>
<tr class="separator:a63a1bb27c4a92c6a504588e4ace64892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f209dcaac73586a0ebb0ea92680ee3e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a></td></tr>
<tr class="memdesc:a3f209dcaac73586a0ebb0ea92680ee3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">File name for training log.  <a href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">More...</a><br /></td></tr>
<tr class="separator:a3f209dcaac73586a0ebb0ea92680ee3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e7318a8dd101bc306d3ff449fca7373"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a></td></tr>
<tr class="memdesc:a2e7318a8dd101bc306d3ff449fca7373"><td class="mdescLeft">&#160;</td><td class="mdescRight">ID of neural network the training is working on.  <a href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">More...</a><br /></td></tr>
<tr class="separator:a2e7318a8dd101bc306d3ff449fca7373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385a420ca6f05019c349d0ca5d6bf10b"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a></td></tr>
<tr class="memdesc:a385a420ca6f05019c349d0ca5d6bf10b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> log file.  <a href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">More...</a><br /></td></tr>
<tr class="separator:a385a420ca6f05019c349d0ca5d6bf10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3842dd2ab00d29da9d3b2e0ada174dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a></td></tr>
<tr class="memdesc:ad3842dd2ab00d29da9d3b2e0ada174dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update schedule epoch (false = energy update, true = force update).  <a href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">More...</a><br /></td></tr>
<tr class="separator:ad3842dd2ab00d29da9d3b2e0ada174dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e62e59b28ba068d154856c16219e93b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a></td></tr>
<tr class="memdesc:a0e62e59b28ba068d154856c16219e93b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of weights per updater.  <a href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">More...</a><br /></td></tr>
<tr class="separator:a0e62e59b28ba068d154856c16219e93b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8745838265af0e0436fc024d0c80de74"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">weightsOffset</a></td></tr>
<tr class="memdesc:a8745838265af0e0436fc024d0c80de74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Offset of each element's weights in combined array.  <a href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">More...</a><br /></td></tr>
<tr class="separator:a8745838265af0e0436fc024d0c80de74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed44026c9d76b19022856e1e82cad8bb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a></td></tr>
<tr class="memdesc:aed44026c9d76b19022856e1e82cad8bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of actually used training properties.  <a href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">More...</a><br /></td></tr>
<tr class="separator:aed44026c9d76b19022856e1e82cad8bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040f4feb5130b36ba185f437e6999a62"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a></td></tr>
<tr class="memdesc:a040f4feb5130b36ba185f437e6999a62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of symmetry functions with respect to one specific atom coordinate.  <a href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">More...</a><br /></td></tr>
<tr class="separator:a040f4feb5130b36ba185f437e6999a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af28c4111f0f053fbccb6b072b47c6fea"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a></td></tr>
<tr class="memdesc:af28c4111f0f053fbccb6b072b47c6fea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network weights and biases for each element.  <a href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">More...</a><br /></td></tr>
<tr class="separator:af28c4111f0f053fbccb6b072b47c6fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f4d6996721dd95776b851d73ee77b7a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classnnp_1_1Updater.html">Updater</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a></td></tr>
<tr class="memdesc:a5f4d6996721dd95776b851d73ee77b7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight updater (combined or for each element).  <a href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">More...</a><br /></td></tr>
<tr class="separator:a5f4d6996721dd95776b851d73ee77b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53248fb2d903d54fd37a26eca5c51b5e"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <a class="el" href="classnnp_1_1Stopwatch.html">Stopwatch</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a></td></tr>
<tr class="memdesc:a53248fb2d903d54fd37a26eca5c51b5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stopwatches for timing overview.  <a href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">More...</a><br /></td></tr>
<tr class="separator:a53248fb2d903d54fd37a26eca5c51b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbda69cd1b2ff7705263726577e79dd"><td class="memItemLeft" align="right" valign="top">std::mt19937_64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">rngNew</a></td></tr>
<tr class="memdesc:a5cbda69cd1b2ff7705263726577e79dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-task random number generator.  <a href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">More...</a><br /></td></tr>
<tr class="separator:a5cbda69cd1b2ff7705263726577e79dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b71003bb978998c82e9cbefd454f242"><td class="memItemLeft" align="right" valign="top">std::mt19937_64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">rngGlobalNew</a></td></tr>
<tr class="memdesc:a2b71003bb978998c82e9cbefd454f242"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global random number generator.  <a href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">More...</a><br /></td></tr>
<tr class="separator:a2b71003bb978998c82e9cbefd454f242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ef4b4d51191c4c67be8dc39c7bfd3ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Training_1_1PropertyMap.html">PropertyMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a></td></tr>
<tr class="memdesc:a5ef4b4d51191c4c67be8dc39c7bfd3ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual training properties.  <a href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">More...</a><br /></td></tr>
<tr class="separator:a5ef4b4d51191c4c67be8dc39c7bfd3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classnnp_1_1Dataset"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classnnp_1_1Dataset')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classnnp_1_1Dataset.html">nnp::Dataset</a></td></tr>
<tr class="memitem:aa0ab32abb821e98058c7df794ca8103d inherit pub_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structnnp_1_1Structure.html">Structure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a></td></tr>
<tr class="memdesc:aa0ab32abb821e98058c7df794ca8103d inherit pub_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">All structures in this dataset.  <a href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">More...</a><br /></td></tr>
<tr class="separator:aa0ab32abb821e98058c7df794ca8103d inherit pub_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classnnp_1_1Mode"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classnnp_1_1Mode')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classnnp_1_1Mode.html">nnp::Mode</a></td></tr>
<tr class="memitem:a12a8249ac3aab222922c42781c344779 inherit pub_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">elementMap</a></td></tr>
<tr class="memdesc:a12a8249ac3aab222922c42781c344779 inherit pub_attribs_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global element map, populated by <a class="el" href="classnnp_1_1Mode.html#a259303c95ae2f64f2b192de1b2df51f5" title="Set up the element map.">setupElementMap()</a>.  <a href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">More...</a><br /></td></tr>
<tr class="separator:a12a8249ac3aab222922c42781c344779 inherit pub_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5d8b1186dde3ffbf2545fca1d08923 inherit pub_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Log.html">Log</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a></td></tr>
<tr class="memdesc:aae5d8b1186dde3ffbf2545fca1d08923 inherit pub_attribs_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global log file.  <a href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">More...</a><br /></td></tr>
<tr class="separator:aae5d8b1186dde3ffbf2545fca1d08923 inherit pub_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classnnp_1_1Mode"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classnnp_1_1Mode')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classnnp_1_1Mode.html">nnp::Mode</a></td></tr>
<tr class="memitem:a494c9900a501676733155cca1b856be3 inherit pro_methods_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">readNeuralNetworkWeights</a> (std::string const &amp;type, std::string const &amp;fileName)</td></tr>
<tr class="memdesc:a494c9900a501676733155cca1b856be3 inherit pro_methods_classnnp_1_1Mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in weights for a specific type of neural network.  <a href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">More...</a><br /></td></tr>
<tr class="separator:a494c9900a501676733155cca1b856be3 inherit pro_methods_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classnnp_1_1Dataset"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classnnp_1_1Dataset')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classnnp_1_1Dataset.html">nnp::Dataset</a></td></tr>
<tr class="memitem:adc4c6b8a47ec99fe2efc2e6851df83e5 inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a></td></tr>
<tr class="memdesc:adc4c6b8a47ec99fe2efc2e6851df83e5 inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">My process ID.  <a href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">More...</a><br /></td></tr>
<tr class="separator:adc4c6b8a47ec99fe2efc2e6851df83e5 inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f37380d0a1d86920e3da271df3b089 inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a></td></tr>
<tr class="memdesc:a96f37380d0a1d86920e3da271df3b089 inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of MPI processors.  <a href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">More...</a><br /></td></tr>
<tr class="separator:a96f37380d0a1d86920e3da271df3b089 inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d03b673a86dbf7484f2da9e41872c2f inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a></td></tr>
<tr class="memdesc:a0d03b673a86dbf7484f2da9e41872c2f inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of structures in dataset.  <a href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">More...</a><br /></td></tr>
<tr class="separator:a0d03b673a86dbf7484f2da9e41872c2f inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1aa836b7597b2e37b2677b36e2c626e inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#ac1aa836b7597b2e37b2677b36e2c626e">myName</a></td></tr>
<tr class="memdesc:ac1aa836b7597b2e37b2677b36e2c626e inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">My processor name.  <a href="classnnp_1_1Dataset.html#ac1aa836b7597b2e37b2677b36e2c626e">More...</a><br /></td></tr>
<tr class="separator:ac1aa836b7597b2e37b2677b36e2c626e inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8818ce2d15fcad4037b0db8057ad7f59 inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a></td></tr>
<tr class="memdesc:a8818ce2d15fcad4037b0db8057ad7f59 inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global MPI communicator.  <a href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">More...</a><br /></td></tr>
<tr class="separator:a8818ce2d15fcad4037b0db8057ad7f59 inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e39dc46c8015f4dbe34010b0d7a5648 inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">gsl_rng *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">rng</a></td></tr>
<tr class="memdesc:a1e39dc46c8015f4dbe34010b0d7a5648 inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">GSL random number generator (different seed for each MPI process).  <a href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">More...</a><br /></td></tr>
<tr class="separator:a1e39dc46c8015f4dbe34010b0d7a5648 inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae35949dc7242a6e2f5e81885e737e38f inherit pro_attribs_classnnp_1_1Dataset"><td class="memItemLeft" align="right" valign="top">gsl_rng *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">rngGlobal</a></td></tr>
<tr class="memdesc:ae35949dc7242a6e2f5e81885e737e38f inherit pro_attribs_classnnp_1_1Dataset"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global GSL random number generator (equal seed for each MPI process).  <a href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">More...</a><br /></td></tr>
<tr class="separator:ae35949dc7242a6e2f5e81885e737e38f inherit pro_attribs_classnnp_1_1Dataset"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classnnp_1_1Mode"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classnnp_1_1Mode')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classnnp_1_1Mode.html">nnp::Mode</a></td></tr>
<tr class="memitem:a15574dbe2ae544ee27a79519d6c92146 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8c">NNPType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a></td></tr>
<tr class="separator:a15574dbe2ae544ee27a79519d6c92146 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043ac1c36d5edc38a6c72f4366823c69 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a></td></tr>
<tr class="separator:a043ac1c36d5edc38a6c72f4366823c69 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03ee0e33408435b18a79a253e967856a inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a></td></tr>
<tr class="separator:a03ee0e33408435b18a79a253e967856a inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec89f821885ded452cd027b7d439b00 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a3ec89f821885ded452cd027b7d439b00">useChargeNN</a></td></tr>
<tr class="separator:a3ec89f821885ded452cd027b7d439b00 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d3694d566d2052c298325a18ee865c inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a></td></tr>
<tr class="separator:a76d3694d566d2052c298325a18ee865c inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb183f90ace9311391b9847580009ba inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a></td></tr>
<tr class="separator:abbb183f90ace9311391b9847580009ba inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16cf1320e7b8e3ff52802dff5b114fae inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a></td></tr>
<tr class="separator:a16cf1320e7b8e3ff52802dff5b114fae inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f8bc8db576ad1762dd306b4d225383 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a></td></tr>
<tr class="separator:a38f8bc8db576ad1762dd306b4d225383 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded25017ec58efa0cc8d55bb9fb7dd25 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a></td></tr>
<tr class="separator:aded25017ec58efa0cc8d55bb9fb7dd25 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c6554727f0af7501fe82dfe136b3865 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a></td></tr>
<tr class="separator:a5c6554727f0af7501fe82dfe136b3865 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09461989d84484833b10c96e6871f87e inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">convEnergy</a></td></tr>
<tr class="separator:a09461989d84484833b10c96e6871f87e inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d6eccfa0f21d64823f74cc75c89473f inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a></td></tr>
<tr class="separator:a1d6eccfa0f21d64823f74cc75c89473f inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf7de3d7a75f960af6a66c3e9ab6acb inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1Settings.html">Settings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a></td></tr>
<tr class="separator:acaf7de3d7a75f960af6a66c3e9ab6acb inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6629d7803f36c6fcd014364b1b1a723f inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1SymFnc.html#a016649d9cda6df3afec2b17d00852272">SymFnc::ScalingType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a6629d7803f36c6fcd014364b1b1a723f">scalingType</a></td></tr>
<tr class="separator:a6629d7803f36c6fcd014364b1b1a723f inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e76062a64f8acdcf384bc487f8a4fb inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1CutoffFunction.html#a0a5fd8220ae66e1442b6692885316fa8">CutoffFunction::CutoffType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a></td></tr>
<tr class="separator:af7e76062a64f8acdcf384bc487f8a4fb inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f777011d3e3fbe644616e7763f9dd11 inherit pro_attribs_classnnp_1_1Mode"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classnnp_1_1Element.html">Element</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a></td></tr>
<tr class="separator:a6f777011d3e3fbe644616e7763f9dd11 inherit pro_attribs_classnnp_1_1Mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> methods. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00035">35</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a639e7546c166a0b5530ad707e08f626e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a639e7546c166a0b5530ad707e08f626e">&#9670;&nbsp;</a></span>UpdaterType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">nnp::Training::UpdaterType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of update routine. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b"></a>UT_GD&#160;</td><td class="fielddoc"><p>Simple gradient descent methods. </p>
</td></tr>
<tr><td class="fieldname"><a id="a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417"></a>UT_KF&#160;</td><td class="fielddoc"><p>Kalman filter-based methods. </p>
</td></tr>
<tr><td class="fieldname"><a id="a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6"></a>UT_LM&#160;</td><td class="fielddoc"><p>Levenberg-Marquardt algorithm. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00039">39</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6">UT_LM</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6671e3eb01b86af1162273218df0e5ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6671e3eb01b86af1162273218df0e5ed">&#9670;&nbsp;</a></span>ParallelMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">nnp::Training::ParallelMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> parallelization mode. </p>
<p>This mode determines if and how individual MPI tasks contribute to parallel training. Note that in all cases the data set gets distributed among the MPI processes and RMSE computation is always parallelized. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb"></a>PM_TRAIN_RK0&#160;</td><td class="fielddoc"><p>No training parallelization, only data set distribution. </p>
<pre class="fragment">   Data set is distributed via MPI, but for each weight update only
   a single task is active, selects energy/force update candidates,
   computes errors and gradients, and updates weights.
</pre><p> Parallel gradient computation, update on rank 0. </p><pre class="fragment">   Data set is distributed via MPI, each tasks selects energy/force
   update candidates, and computes errors and gradients, which are
   collected on rank 0. Weight update is carried out on rank 0 and new
   weights are redistributed to all tasks.
</pre> </td></tr>
<tr><td class="fieldname"><a id="a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0"></a>PM_TRAIN_ALL&#160;</td><td class="fielddoc"><p>Parallel gradient computation, update on each task. </p>
<pre class="fragment">   Data set is distributed via MPI, each tasks selects energy/force
   update candidates, and computes errors and gradients, which are
   collected on all MPI tasks. Identical weight updates are carried out
   on each task. This mode is ideal if the update routine itself is
   parallelized.
</pre> </td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00055">55</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">//PM_DATASET,</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span>        <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a45f426cc1948a782e161d0bd0072fbaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45f426cc1948a782e161d0bd0072fbaa">&#9670;&nbsp;</a></span>JacobianMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">nnp::Training::JacobianMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Jacobian matrix preparation mode. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd"></a>JM_SUM&#160;</td><td class="fielddoc"><p>No Jacobian, sum up contributions from update candidates. </p>
</td></tr>
<tr><td class="fieldname"><a id="a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575"></a>JM_TASK&#160;</td><td class="fielddoc"><p>Prepare one Jacobian entry for each task, sum up within tasks. </p>
</td></tr>
<tr><td class="fieldname"><a id="a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2"></a>JM_FULL&#160;</td><td class="fielddoc"><p>Prepare full Jacobian matrix. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00084">84</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad641fa6c3bd89c5c3efd964c9a47429a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad641fa6c3bd89c5c3efd964c9a47429a">&#9670;&nbsp;</a></span>UpdateStrategy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">nnp::Training::UpdateStrategy</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update strategies available for <a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2"></a>US_COMBINED&#160;</td><td class="fielddoc"><p>One combined updater for all elements. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf"></a>US_ELEMENT&#160;</td><td class="fielddoc"><p>Separate updaters for individual elements. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00095">95</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79df98867453f340a4cea8a9e432be98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79df98867453f340a4cea8a9e432be98">&#9670;&nbsp;</a></span>SelectionMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">nnp::Training::SelectionMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How update candidates are selected during <a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429"></a>SM_RANDOM&#160;</td><td class="fielddoc"><p>Select candidates randomly. </p>
</td></tr>
<tr><td class="fieldname"><a id="a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367"></a>SM_SORT&#160;</td><td class="fielddoc"><p>Sort candidates according to their RMSE and pick worst first. </p>
</td></tr>
<tr><td class="fieldname"><a id="a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8"></a>SM_THRESHOLD&#160;</td><td class="fielddoc"><p>Select candidates randomly with RMSE above threshold. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00104">104</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af98b1bc7ed710e2fa008a72ad29dbdae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af98b1bc7ed710e2fa008a72ad29dbdae">&#9670;&nbsp;</a></span>Training()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Training::Training </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00037">37</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                   : <a class="code" href="classnnp_1_1Dataset.html#a2ef0a4a688a218d55ef061c6df659a4a">Dataset</a>(),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>                (<a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>          ),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>               (<a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>   ),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>               (<a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>         ),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>             (<a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>    ),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a>                (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a>              (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>                  (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">repeatedEnergyUpdates</a>      (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>                 (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a>           (<span class="keyword">false</span>          ),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>                      (0              ),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>                (0              ),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a>                  (0              ),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>                      (0              ),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a>          (0              ),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a>         (0              ),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a> (0              ),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a>(0              ),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>                 (0              ),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>                (0.0            ),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                       <a class="code" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a>        (<span class="stringliteral">&quot;train-log.out&quot;</span>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;setup&quot;</span>].start();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>.</p>

</div>
</div>
<a id="a6db6a1a9302641ca0d74308e583667af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db6a1a9302641ca0d74308e583667af">&#9670;&nbsp;</a></span>~Training()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Training::~Training </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor, updater vector needs to be cleaned. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00063">63</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Updater*&gt;::iterator it = <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.begin();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         it != <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.end(); ++it)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keyword">delete</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>*<span class="keyword">&gt;</span>(*it);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keyword">delete</span> <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>*<span class="keyword">&gt;</span>(*it);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.is_open()) <a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.close();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>, <a class="el" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>, <a class="el" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>, <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>, and <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a451092eefd3f1021b2edd7729b74505c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451092eefd3f1021b2edd7729b74505c">&#9670;&nbsp;</a></span>selectSets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::selectSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Randomly select training and test set structures. </p>
<p>Also fills training candidates lists. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00081">81</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** DEFINE TRAINING/TEST SETS ***********&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    vector&lt;string&gt; pCheck = {<span class="stringliteral">&quot;force&quot;</span>, <span class="stringliteral">&quot;charge&quot;</span>};</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">bool</span> check = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        check |= (find(pCheck.begin(), pCheck.end(), k) != pCheck.end());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    vector&lt;size_t&gt; numAtomsPerElement(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, 0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">double</span> testSetFraction = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;test_fraction&quot;</span>].c_str());</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Desired test set ratio      : %f\n&quot;</span>, testSetFraction);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.size() &gt; 0) <a class="code" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">string</span> k;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.size(); ++i)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(i);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (gsl_rng_uniform(<a class="code" href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">rng</a>) &lt; testSetFraction)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            s.<a class="code" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a> = <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">Structure::ST_TEST</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordtype">size_t</span> <span class="keyword">const</span>&amp; na = s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns++;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns += 3 * na;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns += na;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            s.<a class="code" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a> = <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">Structure::ST_TRAINING</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++j)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                numAtomsPerElement.at(j) += s.<a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(j);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k))</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns++;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.push_back(UpdateCandidate());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().s = i;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k))</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns += 3 * s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                     it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 3; ++j)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.push_back(UpdateCandidate());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().s = i;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().a = it-&gt;index;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().c = j;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k))</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns += s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                     it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.push_back(UpdateCandidate());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().s = i;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].updateCandidates.back().a = it-&gt;index;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a> &amp;&amp; (numAtomsPerElement.at(i) == 0))</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;WARNING: Process %d has no atoms of element &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                         <span class="stringliteral">&quot;%d (%2s).\n&quot;</span>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                         <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                         i,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                         <a class="code" href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[i].c_str());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns), 1, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, MPI_SUM, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns) , 1, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, MPI_SUM, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordtype">double</span> sum = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns + <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Training/test split of data set for property \&quot;&quot;</span> + k + <span class="stringliteral">&quot;\&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Total    patterns : %.0f\n&quot;</span>, sum);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Training patterns : %d\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTrainPatterns);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Test     patterns : %d\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Test set fraction : %f\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numTestPatterns / sum);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a>, <a class="el" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">nnp::Training::PropertyMap::exists()</a>, <a class="el" href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">hasStructures</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">nnp::Dataset::rng</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">nnp::Structure::sampleType</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_cgraph.png" border="0" usemap="#classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_cgraph" id="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_cgraph">
<area shape="rect" title="Randomly select training and test set structures." alt="" coords="5,42,185,69"/>
<area shape="rect" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4" title="Check if property is present." alt="" coords="233,5,429,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="289,71,373,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_icgraph.png" border="0" usemap="#classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_icgraph" id="classnnp_1_1Training_a451092eefd3f1021b2edd7729b74505c_icgraph">
<area shape="rect" title="Randomly select training and test set structures." alt="" coords="108,5,288,32"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="af4cbb8263eeb79634e06fc62dc4b359d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4cbb8263eeb79634e06fc62dc4b359d">&#9670;&nbsp;</a></span>writeSetsToFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeSetsToFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write training and test set to separate files (train.data and test.data, same format as input.data). </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00187">187</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** WRITE TRAINING/TEST SETS ************&quot;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">string</span> fileName = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;train.data.%04d&quot;</span>, <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    ofstream fileTrain;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    fileTrain.open(fileName.c_str());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (!fileTrain.is_open())</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        runtime_error(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;ERROR: Could not open file %s\n&quot;</span>,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            fileName.c_str()));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    fileName = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;test.data.%04d&quot;</span>, <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    ofstream fileTest;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    fileTest.open(fileName.c_str());</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (!fileTest.is_open())</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        runtime_error(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;ERROR: Could not open file %s\n&quot;</span>,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                            fileName.c_str()));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Structure&gt;::iterator it = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.begin();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         it != <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.end(); ++it)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Energy offsets are already subtracted at this point.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">// Here, we quickly add them again to provide consistent data sets.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">addEnergyOffset</a>(*it);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span> (it-&gt;sampleType == <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">Structure::ST_TRAINING</a>)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            it-&gt;writeToFile(&amp;fileTrain);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it-&gt;sampleType == <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">Structure::ST_TEST</a>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            it-&gt;writeToFile(&amp;fileTest);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// Subtract energy offsets again.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">removeEnergyOffset</a>(*it);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    fileTrain.flush();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    fileTrain.close();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    fileTest.flush();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    fileTest.close();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    MPI_Barrier(<a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Writing training/test set to files:\n&quot;</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot; - train.data\n&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot; - test.data\n&quot;</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        fileName = <span class="stringliteral">&quot;train.data&quot;</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a>(fileName);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        fileName = <span class="stringliteral">&quot;test.data&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a>(fileName);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">nnp::Dataset::combineFiles()</a>, <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_cgraph.png" border="0" usemap="#classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_cgraph" id="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_cgraph">
<area shape="rect" title="Write training and test set to separate files (train.data and test.data, same format as input...." alt="" coords="5,74,180,115"/>
<area shape="rect" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674" title="Add atomic energy offsets to reference energy." alt="" coords="241,5,447,32"/>
<area shape="rect" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225" title="Combine individual MPI proc files to one." alt="" coords="245,56,443,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="508,81,592,108"/>
<area shape="rect" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5" title="Remove atomic energy offsets from reference energy." alt="" coords="228,157,460,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_icgraph.png" border="0" usemap="#classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_icgraph" id="classnnp_1_1Training_af4cbb8263eeb79634e06fc62dc4b359d_icgraph">
<area shape="rect" title="Write training and test set to separate files (train.data and test.data, same format as input...." alt="" coords="108,5,283,47"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<a id="ab3025fc3780b67e91e063fd490640043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3025fc3780b67e91e063fd490640043">&#9670;&nbsp;</a></span>initializeWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::initializeWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize weights for all elements. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00249">249</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** WEIGHT INITIALIZATION ***************&quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;nguyen_widrow_weights_short&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;precondition_weights&quot;</span>))</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Nguyen Widrow and preconditioning weights&quot;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                            <span class="stringliteral">&quot; initialization are incompatible\n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// Charge NN.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Setting up charge neural networks:\n&quot;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1 &amp;&amp; <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_old_weights_charge&quot;</span>)) ||</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Reading old weights from files.\n&quot;</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">readNeuralNetworkWeights</a>(<span class="stringliteral">&quot;charge&quot;</span>, <span class="stringliteral">&quot;weightse.%03zu.data&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">randomizeNeuralNetworkWeights</a>(<span class="stringliteral">&quot;charge&quot;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Short-range NN.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Setting up short-range neural networks:\n&quot;</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_old_weights_short&quot;</span>))</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Reading old weights from files.\n&quot;</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">readNeuralNetworkWeights</a>(<span class="stringliteral">&quot;short&quot;</span>, <span class="stringliteral">&quot;weights.%03zu.data&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">randomizeNeuralNetworkWeights</a>(<span class="stringliteral">&quot;short&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Setting up short-range neural networks:\n&quot;</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_old_weights_short&quot;</span>))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Reading old weights from files.\n&quot;</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">readNeuralNetworkWeights</a>(<span class="stringliteral">&quot;short&quot;</span>, <span class="stringliteral">&quot;weights.%03zu.data&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">randomizeNeuralNetworkWeights</a>(<span class="stringliteral">&quot;short&quot;</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">randomizeNeuralNetworkWeights()</a>, <a class="el" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">nnp::Mode::readNeuralNetworkWeights()</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, and <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_cgraph.png" border="0" usemap="#classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_cgraph" id="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_cgraph">
<area shape="rect" title="Initialize weights for all elements." alt="" coords="5,27,175,69"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="496,5,705,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39" title="Randomly initialize specificy neural network weights." alt="" coords="244,27,427,69"/>
<area shape="rect" href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3" title="Read in weights for a specific type of neural network." alt="" coords="223,93,448,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_icgraph.png" border="0" usemap="#classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_icgraph" id="classnnp_1_1Training_ab3025fc3780b67e91e063fd490640043_icgraph">
<area shape="rect" title="Initialize weights for all elements." alt="" coords="108,5,277,47"/>
<area shape="rect" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<a id="ab802ff670986203dab60c22f04b07f59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab802ff670986203dab60c22f04b07f59">&#9670;&nbsp;</a></span>initializeWeightsMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::initializeWeightsMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a>&#160;</td>
          <td class="paramname"><em>updateStrategy</em> = <code><a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize weights vector according to update strategy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">updateStrategy</td><td>Determines the shape of the weights array. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00304">304</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    this-&gt;<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> = <a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>= 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Combined updater for all elements selected: &quot;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                     <span class="stringliteral">&quot;UpdateStrategy::US_COMBINED (%d)\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a> = 1;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Number of weight updaters    : %zu\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">weightsOffset</a>.push_back(<a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a> += <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                          .getNumConnections();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(0).resize(<a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>, 0.0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.push_back(<a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Total fit parameters         : %zu\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Separate updaters for elements selected: &quot;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                     <span class="stringliteral">&quot;UpdateStrategy::US_ELEMENT (%d)\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a> = <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Number of weight updaters    : %zu\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordtype">size_t</span> n = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                       .getNumConnections();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.push_back(n);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Fit parameters for element %2s: %zu\n&quot;</span>,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                         <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getSymbol().c_str(),</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                         n);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown update strategy.\n&quot;</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">numWeights</a>, <a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>, <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>, and <a class="el" href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">weightsOffset</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_cgraph.png" border="0" usemap="#classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_cgraph" id="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_cgraph">
<area shape="rect" title="Initialize weights vector according to update strategy." alt="" coords="5,5,175,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="223,13,307,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_icgraph.png" border="0" usemap="#classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_icgraph" id="classnnp_1_1Training_ab802ff670986203dab60c22f04b07f59_icgraph">
<area shape="rect" title="Initialize weights vector according to update strategy." alt="" coords="253,5,423,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,13,205,39"/>
</map>
</div>

</div>
</div>
<a id="afbdd4d56bb0290e139382bdfba070c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbdd4d56bb0290e139382bdfba070c2a">&#9670;&nbsp;</a></span>setStage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setStage </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set training stage (if multiple stages are needed for NNP type). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stage</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> stage to set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00351">351</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    this-&gt;<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> = <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// NNP of type SHORT_ONLY requires:</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// * &quot;energy&quot; (optionally: &quot;force&quot;)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.push_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_short_forces&quot;</span>)) <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.push_back(<span class="stringliteral">&quot;force&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// NNP of type SHORT_CHARGE_NN requires:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// * stage 1: &quot;charge&quot;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// * stage 2: &quot;energy&quot; (optionally: &quot;force&quot;)</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1) <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.push_back(<span class="stringliteral">&quot;charge&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.push_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_short_forces&quot;</span>))</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.push_back(<span class="stringliteral">&quot;force&quot;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// Initialize all training properties which will be used.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keyword">auto</span> initP = [<span class="keyword">this</span>](<span class="keywordtype">string</span> key) {<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.emplace(piecewise_construct,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                               forward_as_tuple(key),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                               forward_as_tuple(key));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                 };</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) initP(k);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, and <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_cgraph.png" border="0" usemap="#classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_cgraph" id="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_cgraph">
<area shape="rect" title="Set training stage (if multiple stages are needed for NNP type)." alt="" coords="5,5,176,32"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="224,5,433,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_icgraph.png" border="0" usemap="#classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_icgraph" id="classnnp_1_1Training_afbdd4d56bb0290e139382bdfba070c2a_icgraph">
<area shape="rect" title="Set training stage (if multiple stages are needed for NNP type)." alt="" coords="108,5,279,32"/>
<area shape="rect" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a664dec664ebd703206f7c515bf3e96f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a664dec664ebd703206f7c515bf3e96f0">&#9670;&nbsp;</a></span>dataSetNormalization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::dataSetNormalization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply normalization based on initial weights prediction. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00388">388</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** DATA SET NORMALIZATION **************&quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Computing statistics from reference data and initial &quot;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;           <span class="stringliteral">&quot;prediction...\n&quot;</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">bool</span> useForcesLocal = <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_short_forces&quot;</span>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Normalization of charges not yet &quot;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                            <span class="stringliteral">&quot;implemented\n.&quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights</a>(<span class="stringliteral">&quot;short&quot;</span>, <span class="stringliteral">&quot;weights.%03zu.norm&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">Training::NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights</a>(<span class="stringliteral">&quot;charge&quot;</span>, <span class="stringliteral">&quot;weightse.%03zu.norm&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    ofstream fileEvsV;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    fileEvsV.open(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;evsv.dat.%04d&quot;</span>, <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>).c_str());</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        vector&lt;string&gt; title;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        vector&lt;string&gt; colName;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        title.push_back(<span class="stringliteral">&quot;Energy vs. volume comparison.&quot;</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        colName.push_back(<span class="stringliteral">&quot;V_atom&quot;</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Volume per atom.&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        colName.push_back(<span class="stringliteral">&quot;Eref_atom&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Reference energy per atom.&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        colName.push_back(<span class="stringliteral">&quot;N&quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Number of atoms.&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        colName.push_back(<span class="stringliteral">&quot;V&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Volume of structure.&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        colName.push_back(<span class="stringliteral">&quot;Eref&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Reference energy of structure.&quot;</span>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        colName.push_back(<span class="stringliteral">&quot;Eref_offset&quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Reference energy of structure (including offset).&quot;</span>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(fileEvsV,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                          <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">size_t</span> numAtomsTotal         = 0;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>         = 0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">double</span> meanEnergyPerAtomRef  = 0.0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">double</span> meanEnergyPerAtomNnp  = 0.0;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">double</span> sigmaEnergyPerAtomRef = 0.0;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">double</span> sigmaEnergyPerAtomNnp = 0.0;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordtype">double</span> meanForceRef          = 0.0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">double</span> meanForceNnp          = 0.0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">double</span> sigmaForceRef         = 0.0;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">double</span> sigmaForceNnp         = 0.0;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// File output for evsv.dat.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        fileEvsV &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%16.8E %16.8E %10zu %16.8E %16.8E %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                          s.volume / s.numAtoms,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                          s.energyRef / s.numAtoms,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                          s.numAtoms,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                          s.volume,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                          s.energyRef,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                          <a class="code" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">getEnergyWithOffset</a>(s, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        s.calculateNeighborList(<a class="code" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#ifdef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>(s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>(s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">calculateAtomicNeuralNetworks</a>(s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a>(s);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (useForcesLocal) <a class="code" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a>(s);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        s.clearNeighborList();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>++;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        numAtomsTotal += s.numAtoms;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        meanEnergyPerAtomRef += s.energyRef / s.numAtoms;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        meanEnergyPerAtomNnp += s.energy    / s.numAtoms;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; a : s.atoms)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            meanForceRef += a.fRef[0] + a.fRef[1] + a.fRef[2];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            meanForceNnp += a.f   [0] + a.f   [1] + a.f   [2];</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    fileEvsV.flush();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    fileEvsV.close();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    MPI_Barrier(MPI_COMM_WORLD);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Writing energy/atom vs. volume/atom data to \&quot;evsv.dat\&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a>(<span class="stringliteral">&quot;evsv.dat&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;<a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>       , 1, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;numAtomsTotal       , 1, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;meanEnergyPerAtomRef, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;meanEnergyPerAtomNnp, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;meanForceRef        , 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;meanForceNnp        , 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    meanEnergyPerAtomRef /= <a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    meanEnergyPerAtomNnp /= <a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    meanForceRef /= 3 * numAtomsTotal;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    meanForceNnp /= 3 * numAtomsTotal;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; s : <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordtype">double</span> ediffRef = s.energyRef / s.numAtoms - meanEnergyPerAtomRef;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordtype">double</span> ediffNnp = s.energy    / s.numAtoms - meanEnergyPerAtomNnp;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        sigmaEnergyPerAtomRef += ediffRef * ediffRef;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        sigmaEnergyPerAtomNnp += ediffNnp * ediffNnp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; a : s.atoms)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordtype">double</span> fdiffRef = a.fRef[0] - meanForceRef;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordtype">double</span> fdiffNnp = a.f   [0] - meanForceNnp;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            sigmaForceRef += fdiffRef * fdiffRef;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            sigmaForceNnp += fdiffNnp * fdiffNnp;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            fdiffRef = a.fRef[1] - meanForceRef;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            fdiffNnp = a.f   [1] - meanForceNnp;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            sigmaForceRef += fdiffRef * fdiffRef;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            sigmaForceNnp += fdiffNnp * fdiffNnp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            fdiffRef = a.fRef[2] - meanForceRef;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            fdiffNnp = a.f   [2] - meanForceNnp;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            sigmaForceRef += fdiffRef * fdiffRef;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            sigmaForceNnp += fdiffNnp * fdiffNnp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;sigmaEnergyPerAtomRef, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;sigmaEnergyPerAtomNnp, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;sigmaForceRef        , 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;sigmaForceNnp        , 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    sigmaEnergyPerAtomRef = sqrt(sigmaEnergyPerAtomRef / (<a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a> - 1));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    sigmaEnergyPerAtomNnp = sqrt(sigmaEnergyPerAtomNnp / (<a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a> - 1));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    sigmaForceRef = sqrt(sigmaForceRef / (3 * numAtomsTotal - 1));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    sigmaForceNnp = sqrt(sigmaForceNnp / (3 * numAtomsTotal - 1));</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Total number of structures : %zu\n&quot;</span>, <a class="code" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">numStructures</a>);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Total number of atoms      : %zu\n&quot;</span>, numAtomsTotal);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Reference data statistics:\n&quot;</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean/sigma energy per atom : %16.8E +/- %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                 meanEnergyPerAtomRef,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                 sigmaEnergyPerAtomRef);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean/sigma force           : %16.8E +/- %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                 meanForceRef,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                 sigmaForceRef);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Initial NNP prediction statistics:\n&quot;</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean/sigma energy per atom : %16.8E +/- %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                 meanEnergyPerAtomNnp,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                 sigmaEnergyPerAtomNnp);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean/sigma force           : %16.8E +/- %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                 meanForceNnp,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                 sigmaForceNnp);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// Now set conversion quantities of Mode class.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;normalize_data_set&quot;</span>] == <span class="stringliteral">&quot;stats-only&quot;</span>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Data set statistics computation completed, now make up for \n&quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;initially skipped normalization setup...\n&quot;</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b">setupNormalization</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;normalize_data_set&quot;</span>] == <span class="stringliteral">&quot;ref&quot;</span>)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Normalization based on standard deviation of reference data &quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;               <span class="stringliteral">&quot;selected:\n&quot;</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;  mean(e_ref) = 0, sigma(e_ref) = sigma(F_ref) = 1\n&quot;</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a> = meanEnergyPerAtomRef;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> = 1.0 / sigmaEnergyPerAtomRef;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">if</span> (useForcesLocal) <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a> = sigmaForceRef / sigmaEnergyPerAtomRef;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a> = 1.0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;normalize_data_set&quot;</span>] == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span> (!useForcesLocal)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Selected normalization mode only &quot;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                <span class="stringliteral">&quot;possible when forces are available.\n&quot;</span>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Normalization based on standard deviation of reference forces &quot;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;               <span class="stringliteral">&quot;and their\n&quot;</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;initial prediction selected:\n&quot;</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;  mean(e_ref) = 0, sigma(F_NNP) = sigma(F_ref) = 1\n&quot;</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a> = meanEnergyPerAtomRef;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> = sigmaForceNnp / sigmaForceRef;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a> = sigmaForceNnp;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown data set normalization mode.\n&quot;</span>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;normalize_data_set&quot;</span>] != <span class="stringliteral">&quot;stats-only&quot;</span>)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Final conversion data:\n&quot;</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean ref. energy per atom = %24.16E\n&quot;</span>, <a class="code" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Conversion factor energy  = %24.16E\n&quot;</span>, <a class="code" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Conversion factor length  = %24.16E\n&quot;</span>, <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) &amp;&amp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;normalize_data_set&quot;</span>] != <span class="stringliteral">&quot;stats-only&quot;</span>))</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Writing backup of original settings file to &quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="stringliteral">&quot;\&quot;input.nn.bak\&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        ofstream fileSettings;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        fileSettings.open(<span class="stringliteral">&quot;input.nn.bak&quot;</span>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a">writeSettingsFile</a>(&amp;fileSettings);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        fileSettings.close();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Writing normalization data to settings file \&quot;input.nn\&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordtype">string</span> n1 = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;mean_energy %24.16E # nnp-train\n&quot;</span>,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                          meanEnergyPerAtomRef);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordtype">string</span> n2 = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;conv_energy %24.16E # nnp-train\n&quot;</span>,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                          <a class="code" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordtype">string</span> n3 = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;conv_length %24.16E # nnp-train\n&quot;</span>,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                          <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">// Check for existing normalization header and record line numbers</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="comment">// to replace.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keyword">auto</span> lines = <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#abe55e2b7294788622da5e888799732ff">getSettingsLines</a>();</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        map&lt;size_t, string&gt; replace;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; lines.size(); ++i)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            vector&lt;string&gt; sl = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(lines.at(i));</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">if</span> (sl.size() &gt; 0)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <span class="keywordflow">if</span> (sl.at(0) == <span class="stringliteral">&quot;mean_energy&quot;</span>) replace[i] = n1;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">if</span> (sl.at(0) == <span class="stringliteral">&quot;conv_energy&quot;</span>) replace[i] = n2;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">if</span> (sl.at(0) == <span class="stringliteral">&quot;conv_length&quot;</span>) replace[i] = n3;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">if</span> (!replace.empty())</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Preexisting normalization data was found and &quot;</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                   <span class="stringliteral">&quot;replaced in original \&quot;input.nn\&quot; file.\n&quot;</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        fileSettings.open(<span class="stringliteral">&quot;input.nn&quot;</span>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">if</span> (replace.empty())</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            fileSettings &lt;&lt; <span class="stringliteral">&quot;#########################################&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                            <span class="stringliteral">&quot;######################################\n&quot;</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            fileSettings &lt;&lt; <span class="stringliteral">&quot;# DATA SET NORMALIZATION\n&quot;</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            fileSettings &lt;&lt; <span class="stringliteral">&quot;#########################################&quot;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                            <span class="stringliteral">&quot;######################################\n&quot;</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            fileSettings &lt;&lt; n1;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            fileSettings &lt;&lt; n2;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            fileSettings &lt;&lt; n3;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            fileSettings &lt;&lt; <span class="stringliteral">&quot;#########################################&quot;</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                            <span class="stringliteral">&quot;######################################\n&quot;</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            fileSettings &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a6aaa131c802c7cdd0645a41ee12807b5">writeSettingsFile</a>(&amp;fileSettings, replace);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        fileSettings.close();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// Now make up for left-out normalization setup, need to repeat entire</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// symmetry function setup.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Silently repeating symmetry function setup...\n&quot;</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>.<a class="code" href="classnnp_1_1Log.html#a91771eb48c9896ab3abce172a8627bc1">silent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; e : <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>) e.clearSymmetryFunctions();</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions</a>();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor">#ifndef N2P2_NO_SF_CACHE</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2">setupSymmetryFunctionCache</a>();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">#ifndef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling</a>();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics</a>(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>.<a class="code" href="classnnp_1_1Log.html#a91771eb48c9896ab3abce172a8627bc1">silent</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">nnp::Mode::calculateAtomicNeuralNetworks()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">nnp::Dataset::combineFiles()</a>, <a class="el" href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a>, <a class="el" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="classnnp_1_1Settings.html#abe55e2b7294788622da5e888799732ff">nnp::Settings::getSettingsLines()</a>, <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a>, <a class="el" href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a>, <a class="el" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a>, <a class="el" href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">nnp::Dataset::numStructures</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b">nnp::Mode::setupNormalization()</a>, <a class="el" href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2">nnp::Mode::setupSymmetryFunctionCache()</a>, <a class="el" href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9">nnp::Mode::setupSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700">nnp::Mode::setupSymmetryFunctionMemory()</a>, <a class="el" href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b">nnp::Mode::setupSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b">nnp::Mode::setupSymmetryFunctionScaling()</a>, <a class="el" href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153">nnp::Mode::setupSymmetryFunctionStatistics()</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Log.html#a91771eb48c9896ab3abce172a8627bc1">nnp::Log::silent</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>, <a class="el" href="classnnp_1_1Settings.html#a6aaa131c802c7cdd0645a41ee12807b5">nnp::Settings::writeSettingsFile()</a>, <a class="el" href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a">nnp::Mode::writeSettingsFile()</a>, and <a class="el" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_cgraph.png" border="0" usemap="#classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_cgraph" id="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_cgraph">
<area shape="rect" title="Apply normalization based on initial weights prediction." alt="" coords="5,647,260,673"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="335,5,508,32"/>
<area shape="rect" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7" title="Calculate a single atomic neural network for a given atom and nn type." alt="" coords="320,57,523,98"/>
<area shape="rect" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308" title="Calculate potential energy for a given structure." alt="" coords="320,123,523,149"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1" title="Calculate forces for all atoms in given structure." alt="" coords="322,173,521,200"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure." alt="" coords="309,574,534,615"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="653,552,737,579"/>
<area shape="rect" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure." alt="" coords="309,639,534,681"/>
<area shape="rect" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225" title="Combine individual MPI proc files to one." alt="" coords="322,224,521,251"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="339,1055,504,1081"/>
<area shape="rect" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01" title="Add atomic energy offsets and return energy." alt="" coords="324,1106,519,1147"/>
<area shape="rect" href="classnnp_1_1Settings.html#abe55e2b7294788622da5e888799732ff" title="Get complete settings file." alt="" coords="327,1171,516,1213"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="590,771,799,797"/>
<area shape="rect" href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b" title="Set up normalization." alt="" coords="308,771,535,797"/>
<area shape="rect" href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2" title="Set up symmetry function cache." alt="" coords="320,822,523,863"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="653,895,736,921"/>
<area shape="rect" href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9" title="Set up symmetry function groups." alt="" coords="320,275,523,317"/>
<area shape="rect" href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700" title="Extract required memory dimensions for symmetry function derivatives." alt="" coords="320,341,523,382"/>
<area shape="rect" href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions." alt="" coords="320,887,523,929"/>
<area shape="rect" href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b" title="Set up symmetry function scaling from file." alt="" coords="320,705,523,746"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153" title="Set up symmetry function statistics collection." alt="" coords="320,406,523,447"/>
<area shape="rect" href="classnnp_1_1Settings.html#a6aaa131c802c7cdd0645a41ee12807b5" title="Write complete settings file." alt="" coords="583,1263,807,1289"/>
<area shape="rect" href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a" title="Write complete settings file." alt="" coords="318,1237,525,1264"/>
<area shape="rect" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7" title="Write weights to files (one file for each element)." alt="" coords="322,472,521,499"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_icgraph.png" border="0" usemap="#classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_icgraph" id="classnnp_1_1Training_a664dec664ebd703206f7c515bf3e96f0_icgraph">
<area shape="rect" title="Apply normalization based on initial weights prediction." alt="" coords="108,5,363,32"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a2b2b016d87bcea95f460b8a2ae93b451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b2b016d87bcea95f460b8a2ae93b451">&#9670;&nbsp;</a></span>setupTraining()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setupTraining </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>General training settings and setup of weight update routine. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l00693">693</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: TRAINING *********************&quot;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Running stage %zu of training:&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">if</span>      (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1) <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;charge NN fitting.\n&quot;</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2) <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;short-range NN fitting.\n&quot;</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;\nERROR: Unknown training stage.\n&quot;</span>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a> ||</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2))</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a> = <span class="stringliteral">&quot;short&quot;</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a> = <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;use_short_forces&quot;</span>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Forces will be used for training.\n&quot;</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;force_weight&quot;</span>))</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a> = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;force_weight&quot;</span>].c_str());</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Force weight not set, using default value.\n&quot;</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a> = 1.0;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Force update weight: %10.2E\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Only energies will used for training.\n&quot;</span>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a> = <span class="stringliteral">&quot;charge&quot;</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Training will act on \&quot;&quot;</span> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; neural networks.\n&quot;</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;main_error_metric&quot;</span>))</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordtype">string</span> k;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;main_error_metric&quot;</span>] == <span class="stringliteral">&quot;RMSEpa&quot;</span>)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSEpa&quot;</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;main_error_metric&quot;</span>] == <span class="stringliteral">&quot;RMSE&quot;</span>)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;main_error_metric&quot;</span>] == <span class="stringliteral">&quot;MAEpa&quot;</span>)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAEpa&quot;</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;main_error_metric&quot;</span>] == <span class="stringliteral">&quot;MAE&quot;</span>)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown error metric.\n&quot;</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordtype">string</span> k;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        k = <span class="stringliteral">&quot;energy&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSEpa&quot;</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        k = <span class="stringliteral">&quot;force&quot;</span>;  <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        k = <span class="stringliteral">&quot;charge&quot;</span>; <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(k)) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> = (<a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">UpdaterType</a>)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;updater_type&quot;</span>].c_str());</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight update via gradient descent selected: &quot;</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                     <span class="stringliteral">&quot;updaterType::UT_GD (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight update via Kalman filter selected: &quot;</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                     <span class="stringliteral">&quot;updaterType::UT_KF (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6">UT_LM</a>)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: LM algorithm not yet implemented.\n&quot;</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight update via Levenberg-Marquardt algorithm &quot;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                     <span class="stringliteral">&quot;selected: updaterType::UT_LM (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown updater type.\n&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> = (<a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">ParallelMode</a>)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;parallel_mode&quot;</span>].c_str());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">//if (parallelMode == PM_DATASET)</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">//{</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">//    log &lt;&lt; strpr(&quot;Serial training selected: &quot;</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">//                 &quot;ParallelMode::PM_DATASET (%d)\n&quot;,</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">//                 parallelMode);</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Parallel training (rank 0 updates) selected: &quot;</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                     <span class="stringliteral">&quot;ParallelMode::PM_TRAIN_RK0 (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Parallel training (all ranks update) selected: &quot;</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                     <span class="stringliteral">&quot;ParallelMode::PM_TRAIN_ALL (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown parallelization mode.\n&quot;</span>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> = (<a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">JacobianMode</a>)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;jacobian_mode&quot;</span>].c_str());</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Gradient summation only selected: &quot;</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                     <span class="stringliteral">&quot;JacobianMode::JM_SUM (%d)\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;No Jacobi matrix, gradients of all training candidates are &quot;</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               <span class="stringliteral">&quot;summed up instead.\n&quot;</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Per-task Jacobian selected: &quot;</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                     <span class="stringliteral">&quot;JacobianMode::JM_TASK (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;One Jacobi matrix row per MPI task is stored, within each &quot;</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;               <span class="stringliteral">&quot;task gradients are summed up.\n&quot;</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Full Jacobian selected: &quot;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                     <span class="stringliteral">&quot;JacobianMode::JM_FULL (%d)\n&quot;</span>,</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Each update candidate generates one Jacobi matrix &quot;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;               <span class="stringliteral">&quot;row entry.\n&quot;</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown Jacobian mode.\n&quot;</span>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> != <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Gradient descent methods can only be &quot;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                            <span class="stringliteral">&quot;combined with Jacobian mode JM_SUM.\n&quot;</span>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> = (<a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a>)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;update_strategy&quot;</span>].c_str());</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// This section is pushed into a separate function because it&#39;s needed also</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// for testing purposes.</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory</a>(<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// Now it is possible to fill the weights arrays with weight parameters</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// from the neural network.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights</a>();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Set up update candidate selection modes.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode</a>(<span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) <a class="code" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode</a>(k);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">repeatedEnergyUpdates</a> = <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;repeated_energy_update&quot;</span>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">repeatedEnergyUpdates</a>)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Repeated energy updates are not correctly&quot;</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                            <span class="stringliteral">&quot; implemented at the moment.\n&quot;</span>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment">//log &lt;&lt; &quot;After each force update an energy update for the\n&quot;;</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="comment">//log &lt;&lt; &quot;corresponding structure will be performed.\n&quot;;</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a> = !(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;memorize_symfunc_results&quot;</span>));</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Symmetry function memory is cleared after each calculation.\n&quot;</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Symmetry function memory is reused (HIGH MEMORY USAGE!).\n&quot;</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a> = (size_t)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;epochs&quot;</span>].c_str());</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Training will be stopped after %zu epochs.\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// Set up how often comparison output files should be written.</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) <a class="code" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput</a>(k);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// Set up how often weight files should be written.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput</a>(<span class="stringliteral">&quot;weights_epoch&quot;</span>);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">// Set up how often neuron statistics files should be written.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput</a>(<span class="stringliteral">&quot;neuronstats&quot;</span>);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// Prepare training log header.</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a> = <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;write_trainlog&quot;</span>);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a> &amp;&amp; <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a> += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;.stage-%zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Training log with update information will be written to:&quot;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                     <span class="stringliteral">&quot; %s.\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a>.c_str());</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.open(<a class="code" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a>.c_str());</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        vector&lt;string&gt; title;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        vector&lt;string&gt; colName;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        title.push_back(<span class="stringliteral">&quot;Detailed information on each weight update.&quot;</span>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        colSize.push_back(3);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        colName.push_back(<span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Update type (E = energy, F = force, Q = charge).&quot;</span>);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        colSize.push_back(5);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        colName.push_back(<span class="stringliteral">&quot;epoch&quot;</span>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Current training epoch.&quot;</span>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        colName.push_back(<span class="stringliteral">&quot;count&quot;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Update counter (Multiple lines with identical count&quot;</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                          <span class="stringliteral">&quot; for multi-streaming!).&quot;</span>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        colSize.push_back(5);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        colName.push_back(<span class="stringliteral">&quot;proc&quot;</span>);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;MPI process providing this update candidate.&quot;</span>);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        colSize.push_back(3);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        colName.push_back(<span class="stringliteral">&quot;tl&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Threshold loop counter.&quot;</span>);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        colName.push_back(<span class="stringliteral">&quot;rmse_frac&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Update candidates error divided by this &quot;</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                          <span class="stringliteral">&quot;epochs RMSE.&quot;</span>);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        colName.push_back(<span class="stringliteral">&quot;s_ind_g&quot;</span>);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Global structure index.&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        colSize.push_back(5);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        colName.push_back(<span class="stringliteral">&quot;s_ind&quot;</span>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Local structure index on this MPI process.&quot;</span>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        colSize.push_back(5);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        colName.push_back(<span class="stringliteral">&quot;a_ind&quot;</span>);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Atom index.&quot;</span>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        colSize.push_back(2);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        colName.push_back(<span class="stringliteral">&quot;c&quot;</span>);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Force component (0 = x, 1 = y, 2 = z).&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(<a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>,</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                          <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo));</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">// Compute number of updates and properties per update.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) <a class="code" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan</a>(k);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(<span class="stringliteral">&quot;energy&quot;</span>) &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(<span class="stringliteral">&quot;force&quot;</span>))</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        Property&amp; pe = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[<span class="stringliteral">&quot;energy&quot;</span>];</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        Property&amp; pf = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[<span class="stringliteral">&quot;force&quot;</span>];</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Energy to force ratio                        : &quot;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                     <span class="stringliteral">&quot;     1 : %5.1f\n&quot;</span>,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                     <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                         pf.numUpdates * pf.patternsPerUpdateGlobal)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                         / (pe.numUpdates * pe.patternsPerUpdateGlobal));</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Energy to force percentages                  : &quot;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                     <span class="stringliteral">&quot;%5.1f%% : %5.1f%%\n&quot;</span>,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                     pe.numUpdates * pe.patternsPerUpdateGlobal * 100.0 /</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                     (pe.numUpdates * pe.patternsPerUpdateGlobal</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                     + pf.numUpdates * pf.patternsPerUpdateGlobal),</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                     pf.numUpdates * pf.patternsPerUpdateGlobal * 100.0 /</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                     (pe.numUpdates * pe.patternsPerUpdateGlobal</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                     + pf.numUpdates * pf.patternsPerUpdateGlobal));</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordtype">double</span> totalUpdates = 0.0;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) totalUpdates += <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].numUpdates;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// Allocate error and Jacobian arrays.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) <a class="code" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays</a>(k);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// Set up new C++11 random number generator (TODO: move it!).</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">rngGlobalNew</a>.seed(gsl_rng_get(<a class="code" href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">rngGlobal</a>));</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">rngNew</a>.seed(gsl_rng_get(<a class="code" href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">rng</a>));</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// Updater setup.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27e">GradientDescent::DescentType</a> descentType = <a class="code" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27eaf3f7383ef188f4eb5c5e0bda3c048b25">GradientDescent::DT_FIXED</a>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        descentType = (<a class="code" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27e">GradientDescent::DescentType</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                      atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_type&quot;</span>].c_str());</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963a">KalmanFilter::KalmanType</a> kalmanType = <a class="code" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aa8054c56093b2a97bc14d3722d08b0aee">KalmanFilter::KT_STANDARD</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        kalmanType = (<a class="code" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963a">KalmanFilter::KalmanType</a>)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                     atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_type&quot;</span>].c_str());</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) || (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>) )</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.push_back(</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    (<a class="code" href="classnnp_1_1Updater.html">Updater</a>*)<span class="keyword">new</span> <a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>(<a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i),</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                  descentType));</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.push_back(</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                    (<a class="code" href="classnnp_1_1Updater.html">Updater</a>*)<span class="keyword">new</span> <a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>(<a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i),</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                               kalmanType));</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.back()-&gt;setState(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).front()));</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.back()-&gt;setupTiming(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;wupd%zu&quot;</span>, i));</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.back()-&gt;resetTimingLoop();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.size() &gt; 0) <a class="code" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordflow">if</span> (descentType == <a class="code" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27eaf3f7383ef188f4eb5c5e0bda3c048b25">GradientDescent::DT_FIXED</a>)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> eta = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_eta&quot;</span>].c_str());</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>* u =</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>*<span class="keyword">&gt;</span>(<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i));</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                u-&gt;<a class="code" href="classnnp_1_1GradientDescent.html#a0fc36f84c5f9d35f75be83b1e8d54b9d">setParametersFixed</a>(eta);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span> (descentType == <a class="code" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27ea64d014e31fc1b88e2f4fcec133340c6e">GradientDescent::DT_ADAM</a>)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> eta = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_adam_eta&quot;</span>].c_str());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> beta1 = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_adam_beta1&quot;</span>].c_str());</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> beta2 = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_adam_beta2&quot;</span>].c_str());</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> eps = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;gradient_adam_epsilon&quot;</span>].c_str());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>* u =</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1GradientDescent.html">GradientDescent</a>*<span class="keyword">&gt;</span>(<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i));</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                u-&gt;<a class="code" href="classnnp_1_1GradientDescent.html#a26d7bd9f4c4d88d27a1046364b0f779a">setParametersAdam</a>(eta, beta1, beta2, eps);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">if</span> (kalmanType == <a class="code" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aa8054c56093b2a97bc14d3722d08b0aee">KalmanFilter::KT_STANDARD</a>)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> epsilon = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_epsilon&quot;</span>].c_str());</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> q0      = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_q0&quot;</span>     ].c_str());</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> qtau    = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_qtau&quot;</span>   ].c_str())</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                 / totalUpdates;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;qtau is divided by number &quot;</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                   <span class="stringliteral">&quot;of projected updates per epoch.\n&quot;</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> qmin    = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_qmin&quot;</span>   ].c_str());</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> eta0    = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_eta&quot;</span>    ].c_str());</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            <span class="keywordtype">double</span> etatau  = 1.0;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordtype">double</span> etamax  = eta0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;kalman_etatau&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;kalman_etamax&quot;</span>))</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                etatau = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_etatau&quot;</span>].c_str())</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                       / totalUpdates;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;etatau is divided by number &quot;</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                       <span class="stringliteral">&quot;of projected updates per epoch.\n&quot;</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                etamax = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_etamax&quot;</span>].c_str());</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.size(); ++i)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>* u = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>*<span class="keyword">&gt;</span>(<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i));</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                u-&gt;<a class="code" href="classnnp_1_1KalmanFilter.html#a0969a2748b485c3ca33c20c76fb4f5e2">setParametersStandard</a>(epsilon,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                         q0,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                         qtau,</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                         qmin,</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                         eta0,</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                         etatau,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                         etamax);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (kalmanType == <a class="code" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aac400ef737d94b7dfcc280f37f76dbf38">KalmanFilter::KT_FADINGMEMORY</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> epsilon = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_epsilon&quot;</span>].c_str());</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> q0      = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_q0&quot;</span>     ].c_str());</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> qtau    = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_qtau&quot;</span>   ].c_str())</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                                 / totalUpdates;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;qtau is divided by number &quot;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                   <span class="stringliteral">&quot;of projected updates per epoch.\n&quot;</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> qmin   = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_qmin&quot;</span>].c_str());</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> lambda =</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                 atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_lambda_short&quot;</span>].c_str());</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="comment">//double const nu =</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="comment">//       pow(atof(settings[&quot;kalman_nue_short&quot;].c_str()), numProcs);</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="comment">//log &lt;&lt; &quot;nu is exponentiated with the number of streams.\n&quot;;</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordtype">double</span> <span class="keyword">const</span> nu = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;kalman_nue_short&quot;</span>].c_str());</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.size(); ++i)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>* u = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>*<span class="keyword">&gt;</span>(<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i));</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                u-&gt;<a class="code" href="classnnp_1_1KalmanFilter.html#a5792beef75d223f3df178ce494c74ac6">setParametersFadingMemory</a>(epsilon,</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                             q0,</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                             qtau,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                             qmin,</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                             lambda,</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                             nu);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.size(); ++i)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Combined weight updater:\n&quot;</span>);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight updater for element %2s :\n&quot;</span>,</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                             <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getSymbol().c_str());</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                   <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;info();</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Note: During training loop the actual observation\n&quot;</span>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;      size corresponds to error vector size:\n&quot;</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;sizeObservation = %zu (%s updates)\n&quot;</span>,</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                 <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].error.at(i).size(), k.c_str());</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                   <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;TIMING Finished setup: %.2f seconds.\n&quot;</span>,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                 <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;setup&quot;</span>].stop());</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27ea64d014e31fc1b88e2f4fcec133340c6e">nnp::GradientDescent::DT_ADAM</a>, <a class="el" href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27eaf3f7383ef188f4eb5c5e0bda3c048b25">nnp::GradientDescent::DT_FIXED</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">nnp::Training::PropertyMap::exists()</a>, <a class="el" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>, <a class="el" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>, <a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights()</a>, <a class="el" href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">hasUpdaters</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>, <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aac400ef737d94b7dfcc280f37f76dbf38">nnp::KalmanFilter::KT_FADINGMEMORY</a>, <a class="el" href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aa8054c56093b2a97bc14d3722d08b0aee">nnp::KalmanFilter::KT_STANDARD</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a4617cc6dde93700e2a722b856ef5af91">nnp::Training::Property::numUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#ad882355197f0566544af7a65fb6d6d3f">nnp::Training::Property::patternsPerUpdateGlobal</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>, <a class="el" href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">repeatedEnergyUpdates</a>, <a class="el" href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">nnp::Dataset::rng</a>, <a class="el" href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">nnp::Dataset::rngGlobal</a>, <a class="el" href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">rngGlobalNew</a>, <a class="el" href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">rngNew</a>, <a class="el" href="classnnp_1_1GradientDescent.html#a26d7bd9f4c4d88d27a1046364b0f779a">nnp::GradientDescent::setParametersAdam()</a>, <a class="el" href="classnnp_1_1KalmanFilter.html#a5792beef75d223f3df178ce494c74ac6">nnp::KalmanFilter::setParametersFadingMemory()</a>, <a class="el" href="classnnp_1_1GradientDescent.html#a0fc36f84c5f9d35f75be83b1e8d54b9d">nnp::GradientDescent::setParametersFixed()</a>, <a class="el" href="classnnp_1_1KalmanFilter.html#a0969a2748b485c3ca33c20c76fb4f5e2">nnp::KalmanFilter::setParametersStandard()</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, <a class="el" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>, <a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>, <a class="el" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a>, <a class="el" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>, <a class="el" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>, <a class="el" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>, <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">UT_GD</a>, <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>, <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6">UT_LM</a>, <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>, and <a class="el" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_cgraph.png" border="0" usemap="#classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_cgraph" id="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_cgraph">
<area shape="rect" title="General training settings and setup of weight update routine." alt="" coords="5,390,205,417"/>
<area shape="rect" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7" title="Allocate error and Jacobian arrays for given property." alt="" coords="273,54,479,81"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="609,142,693,169"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="289,441,463,467"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="293,491,459,518"/>
<area shape="rect" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4" title="Check if property is present." alt="" coords="553,347,749,388"/>
<area shape="rect" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0" title="Get weights from neural network class." alt="" coords="283,542,469,569"/>
<area shape="rect" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59" title="Initialize weights vector according to update strategy." alt="" coords="291,105,461,147"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="547,274,756,301"/>
<area shape="rect" href="classnnp_1_1GradientDescent.html#a26d7bd9f4c4d88d27a1046364b0f779a" title="Set parameters for Adam algorithm." alt="" coords="295,593,457,635"/>
<area shape="rect" href="classnnp_1_1KalmanFilter.html#a5792beef75d223f3df178ce494c74ac6" title="Set parameters for fading memory Kalman filter." alt="" coords="270,659,482,700"/>
<area shape="rect" href="classnnp_1_1GradientDescent.html#a0fc36f84c5f9d35f75be83b1e8d54b9d" title="Set parameters for fixed step gradient descent algorithm." alt="" coords="295,724,457,765"/>
<area shape="rect" href="classnnp_1_1KalmanFilter.html#a0969a2748b485c3ca33c20c76fb4f5e2" title="Set parameters for standard Kalman filter." alt="" coords="289,789,463,831"/>
<area shape="rect" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1" title="Set file output intervals for properties and other quantities." alt="" coords="290,223,462,264"/>
<area shape="rect" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978" title="Set selection mode for specific training property." alt="" coords="253,171,499,198"/>
<area shape="rect" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78" title="Set up how often properties are updated." alt="" coords="264,339,488,366"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_icgraph.png" border="0" usemap="#classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_icgraph" id="classnnp_1_1Training_a2b2b016d87bcea95f460b8a2ae93b451_icgraph">
<area shape="rect" title="General training settings and setup of weight update routine." alt="" coords="108,5,308,32"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="ac0de14f9b249aa70a7648c7c3c1cc783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0de14f9b249aa70a7648c7c3c1cc783">&#9670;&nbsp;</a></span>calculateNeighborLists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::calculateNeighborLists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate neighbor lists for all structures. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01160">1160</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;{</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;nl&quot;</span>].start();</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** CALCULATE NEIGHBOR LISTS ************&quot;</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordtype">int</span> num_threads = omp_get_max_threads();</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    omp_set_num_threads(1);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Temporarily disabling OpenMP parallelization: %d threads.\n&quot;</span>,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                 omp_get_max_threads());</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Calculating neighbor lists for all structures.\n&quot;</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordtype">double</span> maxCutoffRadiusPhys = <a class="code" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>) maxCutoffRadiusPhys = <a class="code" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a> / <a class="code" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Cutoff radius for neighbor lists: %f\n&quot;</span>,</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                 maxCutoffRadiusPhys);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Structure&gt;::iterator it = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.begin();</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         it != <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.end(); ++it)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        it-&gt;calculateNeighborList(<a class="code" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    omp_set_num_threads(num_threads);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Restoring OpenMP parallelization: max. %d threads.\n&quot;</span>,</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                 omp_get_max_threads());</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;TIMING Finished neighbor lists: %.2f seconds.\n&quot;</span>,</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                 <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;nl&quot;</span>].stop());</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a>, <a class="el" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>, and <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_cgraph.png" border="0" usemap="#classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_cgraph" id="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_cgraph">
<area shape="rect" title="Calculate neighbor lists for all structures." alt="" coords="5,5,177,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="225,13,309,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_icgraph.png" border="0" usemap="#classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_icgraph" id="classnnp_1_1Training_ac0de14f9b249aa70a7648c7c3c1cc783_icgraph">
<area shape="rect" title="Calculate neighbor lists for all structures." alt="" coords="108,5,280,47"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<a id="adc45ef017066bdbfaef2846a39eb733c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc45ef017066bdbfaef2846a39eb733c">&#9670;&nbsp;</a></span>calculateError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::calculateError </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; std::string, std::pair&lt; std::string, std::string &gt;&gt; const&#160;</td>
          <td class="paramname"><em>fileNames</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate error metrics for all structures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileNames</td><td>Map of properties to file names for training/test comparison files.</td></tr>
  </table>
  </dd>
</dl>
<p>If fileNames map is empty, no files will be written. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01200">1200</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;{</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordtype">int</span> num_threads = omp_get_max_threads();</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    omp_set_num_threads(1);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    vector&lt;string&gt; write;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : fileNames)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <span class="keywordflow">if</span> (i.second.first.size() == 0 || i.second.second.size() == 0)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: No filename provided for comparison &quot;</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                <span class="stringliteral">&quot;files.\n&quot;</span>);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        write.push_back(i.first);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keyword">auto</span> doWrite = [&amp;write](<span class="keywordtype">string</span> key){</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                       <span class="keywordflow">return</span> find(write.begin(),</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                   write.end(),</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                   key) != write.end();</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                   };</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    map&lt;string, size_t&gt; countTrain;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    map&lt;string, size_t&gt; countTest;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) countTrain[k] = 0;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) countTest[k]  = 0;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    map&lt;string, ofstream&gt; filesTrain;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    map&lt;string, ofstream&gt; filesTest;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">// Reset current error metrics.</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain) m.second = 0.0;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest) m.second = 0.0;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : write)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        filesTrain[k].open(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%s.%04d&quot;</span>,</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                 fileNames.at(k).first.c_str(),</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                 <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>).c_str());</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        filesTest[k].open(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%s.%04d&quot;</span>,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                fileNames.at(k).second.c_str(),</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>).c_str());</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        vector&lt;string&gt; header;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            vector&lt;string&gt; title;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            vector&lt;string&gt; colName;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                title.push_back(<span class="stringliteral">&quot;Energy comparison.&quot;</span>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                colSize.push_back(10);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                colName.push_back(<span class="stringliteral">&quot;index&quot;</span>);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Structure index.&quot;</span>);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Eref&quot;</span>);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Reference potential energy per atom &quot;</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                  <span class="stringliteral">&quot;(training units).&quot;</span>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Ennp&quot;</span>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;NNP potential energy per atom &quot;</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                  <span class="stringliteral">&quot;(training units).&quot;</span>);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                title.push_back(<span class="stringliteral">&quot;Force comparison.&quot;</span>);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                colSize.push_back(10);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                colName.push_back(<span class="stringliteral">&quot;index_s&quot;</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Structure index.&quot;</span>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                colSize.push_back(10);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                colName.push_back(<span class="stringliteral">&quot;index_a&quot;</span>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Atom index (x, y, z components in &quot;</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                  <span class="stringliteral">&quot;consecutive lines).&quot;</span>);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Fref&quot;</span>);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Reference force (training units).&quot;</span>);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Fnnp&quot;</span>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;NNP force (training units).&quot;</span>);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                title.push_back(<span class="stringliteral">&quot;Charge comparison.&quot;</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                colSize.push_back(10);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                colName.push_back(<span class="stringliteral">&quot;index_s&quot;</span>);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Structure index.&quot;</span>);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                colSize.push_back(10);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                colName.push_back(<span class="stringliteral">&quot;index_a&quot;</span>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Atom index.&quot;</span>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Qref&quot;</span>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;Reference charge.&quot;</span>);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                colName.push_back(<span class="stringliteral">&quot;Qnnp&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;NNP charge.&quot;</span>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            header = <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(filesTrain.at(k), header);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(filesTest.at(k), header);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Structure&gt;::iterator it = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.begin();</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         it != <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.end(); ++it)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor">#ifdef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>((*it), <a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>((*it), <a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">calculateAtomicNeuralNetworks</a>((*it), <a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a>((*it));</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>) <a class="code" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a>((*it));</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            map&lt;string, double&gt;* error = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keywordtype">size_t</span>* count = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            ofstream* file = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordflow">if</span> (it-&gt;sampleType == <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">Structure::ST_TRAINING</a>)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                error = &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                count = &amp;(countTrain.at(k));</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                <span class="keywordflow">if</span> (doWrite(k)) file = &amp;(filesTrain.at(k));</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it-&gt;sampleType == <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">Structure::ST_TEST</a>)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                error = &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                count = &amp;(countTest.at(k));</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="keywordflow">if</span> (doWrite(k)) file = &amp;(filesTest.at(k));</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            it-&gt;updateError(k, *error, *count);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <span class="keywordflow">if</span> (doWrite(k))</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                <span class="keywordflow">if</span>      (k == <span class="stringliteral">&quot;energy&quot;</span>) (*file) &lt;&lt; it-&gt;getEnergyLine();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> l : it-&gt;getForcesLines()) (*file) &lt;&lt; l;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> l : it-&gt;getChargesLines()) (*file) &lt;&lt; l;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>) it-&gt;freeAtoms(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <a class="code" href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">collectError</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain, countTrain.at(k));</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <a class="code" href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">collectError</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest, countTest.at(k));</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span> (doWrite(k))</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            filesTrain.at(k).close();</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            filesTest.at(k).close();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            MPI_Barrier(<a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                <a class="code" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a>(fileNames.at(k).first);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <a class="code" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">combineFiles</a>(fileNames.at(k).second);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    omp_set_num_threads(num_threads);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">nnp::Mode::calculateAtomicNeuralNetworks()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">nnp::Dataset::collectError()</a>, <a class="el" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">nnp::Dataset::combineFiles()</a>, <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>, and <a class="el" href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">useForces</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_cgraph.png" border="0" usemap="#classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_cgraph" id="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_cgraph">
<area shape="rect" title="Calculate error metrics for all structures." alt="" coords="5,254,177,295"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="251,5,425,32"/>
<area shape="rect" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7" title="Calculate a single atomic neural network for a given atom and nn type." alt="" coords="237,57,439,98"/>
<area shape="rect" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308" title="Calculate potential energy for a given structure." alt="" coords="237,123,439,149"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1" title="Calculate forces for all atoms in given structure." alt="" coords="239,173,437,200"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure." alt="" coords="225,225,451,266"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="499,320,583,347"/>
<area shape="rect" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure." alt="" coords="225,342,451,383"/>
<area shape="rect" href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2" title="Collect error metrics of a property over all MPI procs." alt="" coords="245,408,431,435"/>
<area shape="rect" href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225" title="Combine individual MPI proc files to one." alt="" coords="239,459,437,485"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="255,509,421,536"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_icgraph.png" border="0" usemap="#classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_icgraph" id="classnnp_1_1Training_adc45ef017066bdbfaef2846a39eb733c_icgraph">
<area shape="rect" title="Calculate error metrics for all structures." alt="" coords="225,5,397,47"/>
<area shape="rect" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9" title="Calculate error metrics per epoch for all structures with file names used in training loop." alt="" coords="5,5,177,47"/>
</map>
</div>

</div>
</div>
<a id="ae5d67463993440b215a9b165854c8cf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5d67463993440b215a9b165854c8cf9">&#9670;&nbsp;</a></span>calculateErrorEpoch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::calculateErrorEpoch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate error metrics per epoch for all structures with file names used in training loop. </p>
<p>Also write training curve to file. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01379">1379</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;{</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// Check whether property comparison files should be written for</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">// this epoch.</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    map&lt;string, pair&lt;string, string&gt;&gt; fileNames;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; ip : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordtype">string</span> <span class="keyword">const</span>&amp; k = ip.first; <span class="comment">// key</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        Property <span class="keyword">const</span>&amp; <a class="code" href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = ip.second; <span class="comment">// data</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>.writeCompEvery &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> % <a class="code" href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>.writeCompEvery == 0 || <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> &lt;= <a class="code" href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>.writeCompAlways))</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            <span class="keywordtype">string</span> middle;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <span class="keywordflow">if</span>      (k == <span class="stringliteral">&quot;energy&quot;</span>) middle = <span class="stringliteral">&quot;points&quot;</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span> ) middle = <span class="stringliteral">&quot;forces&quot;</span>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>) middle = <span class="stringliteral">&quot;charges&quot;</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            fileNames[k] = make_pair(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;train%s.%06zu.out&quot;</span>,</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                           middle.c_str(), <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>),</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                     <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;test%s.%06zu.out&quot;</span>,</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                           middle.c_str(), <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>));</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// Calculate errors and write comparison files.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <a class="code" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError</a>(fileNames);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError()</a>, <a class="el" href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_cgraph.png" border="0" usemap="#classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_cgraph" id="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_cgraph">
<area shape="rect" title="Calculate error metrics per epoch for all structures with file names used in training loop." alt="" coords="5,35,177,76"/>
<area shape="rect" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c" title="Calculate error metrics for all structures." alt="" coords="225,5,397,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="445,42,529,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_icgraph.png" border="0" usemap="#classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_icgraph" id="classnnp_1_1Training_ae5d67463993440b215a9b165854c8cf9_icgraph">
<area shape="rect" title="Calculate error metrics per epoch for all structures with file names used in training loop." alt="" coords="195,5,367,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="a5ba30ce58e186c7f2e518355aa707863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba30ce58e186c7f2e518355aa707863">&#9670;&nbsp;</a></span>printHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::printHeader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print training loop header on screen. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01409">1409</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;{</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordtype">string</span> metric = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordtype">string</span> peratom = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;The training loop output covers different errors, update and\n&quot;</span>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;timing information. The following quantities are organized\n&quot;</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;according to the matrix scheme below:\n&quot;</span>;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ep ........ Epoch.\n&quot;</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordtype">string</span> <span class="keyword">const</span>&amp; pmetric = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">if</span>      (pmetric.find(<span class="stringliteral">&quot;RMSE&quot;</span>) != pmetric.npos) metric = <span class="stringliteral">&quot;RMSE&quot;</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pmetric.find(<span class="stringliteral">&quot;MAE&quot;</span>)  != pmetric.npos) metric = <span class="stringliteral">&quot;MAE&quot;</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">if</span>      (pmetric.find(<span class="stringliteral">&quot;pa&quot;</span>) != pmetric.npos) peratom = <span class="stringliteral">&quot; per atom&quot;</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">else</span> peratom = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny &lt;&lt; <span class="stringliteral">&quot;_count ... Number of &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; updates.\n&quot;</span>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny &lt;&lt; <span class="stringliteral">&quot;_train ... &quot;</span> &lt;&lt; metric &lt;&lt; <span class="stringliteral">&quot; of training &quot;</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural &lt;&lt; peratom &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny &lt;&lt; <span class="stringliteral">&quot;_test .... &quot;</span> &lt;&lt; metric &lt;&lt; <span class="stringliteral">&quot; of test     &quot;</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural &lt;&lt; peratom &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="comment">//log &lt;&lt; p[k].tiny &lt;&lt; &quot;_time ........ Time for &quot; &lt;&lt; k &lt;&lt; &quot; updates &quot;</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="comment">//                 &lt;&lt; &quot;(seconds).\n&quot;;</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny &lt;&lt; <span class="stringliteral">&quot;_pt ...... Percentage of time for &quot;</span> &lt;&lt; k &lt;&lt;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                            <span class="stringliteral">&quot; updates w.r.t. to t_train.\n&quot;</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;count ..... Total number of updates.\n&quot;</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;train ..... Percentage of time for training.\n&quot;</span>;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;error ..... Percentage of time for error calculation.\n&quot;</span>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;other ..... Percentage of time for other purposes.\n&quot;</span>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;epoch ..... Total time for this epoch (seconds).\n&quot;</span>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;total ..... Total time for all epochs (seconds).\n&quot;</span>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-6s&quot;</span>, k.c_str())</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5s&quot;</span>, <span class="stringliteral">&quot;ep&quot;</span>)</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %7s&quot;</span>, (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;_count&quot;</span>).c_str())</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %11s&quot;</span>, (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;_train&quot;</span>).c_str())</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %11s&quot;</span>, (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;_test&quot;</span>).c_str())</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %5s&quot;</span>, (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;_pt&quot;</span>).c_str())</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-6s&quot;</span>, <span class="stringliteral">&quot;timing&quot;</span>)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5s&quot;</span>, <span class="stringliteral">&quot;ep&quot;</span>)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %7s&quot;</span>, <span class="stringliteral">&quot;count&quot;</span>)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5s&quot;</span>, <span class="stringliteral">&quot;train&quot;</span>)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5s&quot;</span>, <span class="stringliteral">&quot;error&quot;</span>)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5s&quot;</span>, <span class="stringliteral">&quot;other&quot;</span>)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %9s&quot;</span>, <span class="stringliteral">&quot;epoch&quot;</span>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %9s&quot;</span>, <span class="stringliteral">&quot;total&quot;</span>)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_cgraph.png" border="0" usemap="#classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_cgraph" id="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_cgraph">
<area shape="rect" title="Print training loop header on screen." alt="" coords="5,5,196,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="244,5,328,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_icgraph.png" border="0" usemap="#classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_icgraph" id="classnnp_1_1Training_a5ba30ce58e186c7f2e518355aa707863_icgraph">
<area shape="rect" title="Print training loop header on screen." alt="" coords="195,5,385,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="a86b54c7bf103e141f9870ee2bbb30c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86b54c7bf103e141f9870ee2bbb30c4f">&#9670;&nbsp;</a></span>printEpoch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::printEpoch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print preferred error metric and timing information on screen. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01467">1467</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="keywordtype">double</span> timeLoop = <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getLoop();</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">double</span> timeTrain = <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop();</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordtype">size_t</span> totalUpdates = 0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        totalUpdates += <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].countUpdates;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keywordtype">double</span> timeProp = <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].getLoop();</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordtype">string</span> caps = k;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; c : caps) c = toupper(c);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-6s&quot;</span>, caps.c_str());</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %7zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].<a class="code" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a> &amp;&amp; (k != <span class="stringliteral">&quot;charge&quot;</span>))</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %11.5E   %11.5E&quot;</span>,</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                         <a class="code" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">physical</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain.at(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric)),</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                         <a class="code" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">physical</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest.at(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric)));</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %11.5E   %11.5E&quot;</span>,</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                         <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain.at(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric),</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                         <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest.at(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].displayMetric));</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> == 0) <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %5.1f&quot;</span>, 0.0);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;   %5.1f&quot;</span>, timeProp / timeTrain * 100.0);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordtype">double</span> timeOther = timeLoop;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    timeOther -= <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].getLoop();</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    timeOther -= <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop();</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-6s&quot;</span>, <span class="stringliteral">&quot;TIMING&quot;</span>);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %7zu&quot;</span>, totalUpdates);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5.1f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop() / timeLoop * 100.0);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5.1f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].getLoop() / timeLoop * 100.0);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %5.1f&quot;</span>, timeOther / timeLoop * 100.0);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %9.2f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getLoop());</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  %9.2f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getTotal());</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">nnp::Mode::physical()</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_cgraph.png" border="0" usemap="#classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_cgraph" id="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_cgraph">
<area shape="rect" title="Print preferred error metric and timing information on screen." alt="" coords="5,31,188,57"/>
<area shape="rect" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b" title="Undo normalization for a given property." alt="" coords="236,5,388,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="270,56,354,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_icgraph.png" border="0" usemap="#classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_icgraph" id="classnnp_1_1Training_a86b54c7bf103e141f9870ee2bbb30c4f_icgraph">
<area shape="rect" title="Print preferred error metric and timing information on screen." alt="" coords="195,5,377,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="af600a10225c7035afa59ce709bc105a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af600a10225c7035afa59ce709bc105a7">&#9670;&nbsp;</a></span>writeWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeWeights </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>nnName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>fileNameFormat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write weights to files (one file for each element). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nnName</td><td>Identifier for neural network. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileNameFormat</td><td>String with file name format. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01513">1513</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;{</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    ofstream file;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordtype">string</span> fileName = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(fileNameFormat.c_str(),</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicNumber());</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        file.open(fileName.c_str());</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(nnName).writeConnections(file);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        file.close();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a664dec664ebd703206f7c515bf3e96f0">dataSetNormalization()</a>, <a class="el" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_cgraph.png" border="0" usemap="#classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_cgraph" id="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_cgraph">
<area shape="rect" title="Write weights to files (one file for each element)." alt="" coords="5,5,204,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="252,5,336,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_icgraph.png" border="0" usemap="#classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_icgraph" id="classnnp_1_1Training_af600a10225c7035afa59ce709bc105a7_icgraph">
<area shape="rect" title="Write weights to files (one file for each element)." alt="" coords="308,56,507,83"/>
<area shape="rect" href="classnnp_1_1Training.html#a664dec664ebd703206f7c515bf3e96f0" title="Apply normalization based on initial weights prediction." alt="" coords="5,5,260,32"/>
<area shape="rect" href="nnp-norm2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="105,56,160,83"/>
<area shape="rect" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde" title="Write weights to files during training loop." alt="" coords="33,107,232,149"/>
</map>
</div>

</div>
</div>
<a id="a369e6446df8b2b39db30b799c912afde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369e6446df8b2b39db30b799c912afde">&#9670;&nbsp;</a></span>writeWeightsEpoch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeWeightsEpoch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write weights to files during training loop. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01530">1530</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;{</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a> &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> % <a class="code" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a> == 0 || <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> &lt;= <a class="code" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a>))</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a> ||</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2))</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <a class="code" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights</a>(<span class="stringliteral">&quot;short&quot;</span>, <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;weights.%%03zu.%06d.out&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>));</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <a class="code" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights</a>(<span class="stringliteral">&quot;charge&quot;</span>, <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;weightse.%%03zu.%06d.out&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>));</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">writeWeights()</a>, <a class="el" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a>, and <a class="el" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_cgraph.png" border="0" usemap="#classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_cgraph" id="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_cgraph">
<area shape="rect" title="Write weights to files during training loop." alt="" coords="5,5,204,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="499,13,583,39"/>
<area shape="rect" href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7" title="Write weights to files (one file for each element)." alt="" coords="252,38,451,65"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_icgraph.png" border="0" usemap="#classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_icgraph" id="classnnp_1_1Training_a369e6446df8b2b39db30b799c912afde_icgraph">
<area shape="rect" title="Write weights to files during training loop." alt="" coords="195,5,393,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="ae4ccff5ae694d46c03cae84aa7ae696d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ccff5ae694d46c03cae84aa7ae696d">&#9670;&nbsp;</a></span>writeLearningCurve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeLearningCurve </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;learning-curve.out&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write current RMSEs and epoch information to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>If true, append to file, otherwise create new file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>File name for learning curve file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01549">1549</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;{</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    ofstream file;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordtype">string</span> fileNameActual = fileName;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        fileNameActual += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;.stage-%zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">if</span> (append) file.open(fileNameActual.c_str(), ofstream::app);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        file.open(fileNameActual.c_str());</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        vector&lt;string&gt; title;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        vector&lt;string&gt; colName;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a> ||</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2))</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            title.push_back(<span class="stringliteral">&quot;Learning curves for energies and forces.&quot;</span>);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            title.push_back(<span class="stringliteral">&quot;Learning curves for charges.&quot;</span>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        colName.push_back(<span class="stringliteral">&quot;epoch&quot;</span>);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Current epoch.&quot;</span>);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        map&lt;string, string&gt; text;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        text[<span class="stringliteral">&quot;RMSEpa&quot;</span>] = <span class="stringliteral">&quot;RMSE of %s %s per atom&quot;</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        text[<span class="stringliteral">&quot;RMSE&quot;</span>]   = <span class="stringliteral">&quot;RMSE of %s %s&quot;</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        text[<span class="stringliteral">&quot;MAEpa&quot;</span>]  = <span class="stringliteral">&quot;MAE of %s %s per atom&quot;</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        text[<span class="stringliteral">&quot;MAE&quot;</span>]    = <span class="stringliteral">&quot;MAE of %s %s&quot;</span>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorMetrics)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                colName.push_back(m + <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;train_pu&quot;</span>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                colInfo.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                       (text[m] + <span class="stringliteral">&quot; (physical units)&quot;</span>).c_str(),</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                       <span class="stringliteral">&quot;training&quot;</span>,</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                       <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural.c_str()));</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                colSize.push_back(16);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                colName.push_back(m + <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;test_pu&quot;</span>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                colInfo.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                       (text[m] + <span class="stringliteral">&quot; (physical units)&quot;</span>).c_str(),</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                                       <span class="stringliteral">&quot;test&quot;</span>,</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                       <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural.c_str()));</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                <span class="comment">// Internal units only for energies and forces.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                <span class="keywordflow">if</span> (!(k == <span class="stringliteral">&quot;energy&quot;</span> || k == <span class="stringliteral">&quot;force&quot;</span>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorMetrics)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    colSize.push_back(16);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    colName.push_back(m + <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;train_iu&quot;</span>);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                    colInfo.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                       (text[m] + <span class="stringliteral">&quot; (training units)&quot;</span>).c_str(),</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                       <span class="stringliteral">&quot;training&quot;</span>,</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                       <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural.c_str()));</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    colSize.push_back(16);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    colName.push_back(m + <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;test_iu&quot;</span>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    colInfo.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                       (text[m] + <span class="stringliteral">&quot; (training units)&quot;</span>).c_str(),</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                                       <span class="stringliteral">&quot;test&quot;</span>,</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                       <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].plural.c_str()));</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(file,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                          <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo));</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%10zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">if</span> (!(k == <span class="stringliteral">&quot;energy&quot;</span> || k == <span class="stringliteral">&quot;force&quot;</span>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorMetrics)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %16.8E %16.8E&quot;</span>,</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                              <a class="code" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">physical</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain.at(m)),</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                              <a class="code" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">physical</a>(k, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest.at(m)));</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> m : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorMetrics)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %16.8E %16.8E&quot;</span>,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                          <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTrain.at(m),</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                          <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].errorTest.at(m));</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    file.flush();</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    file.close();</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">nnp::Mode::physical()</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_cgraph.png" border="0" usemap="#classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_cgraph" id="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_cgraph">
<area shape="rect" title="Write current RMSEs and epoch information to file." alt="" coords="5,74,208,115"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="256,5,429,32"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="260,56,425,83"/>
<area shape="rect" href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b" title="Undo normalization for a given property." alt="" coords="267,107,419,133"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="301,157,385,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_icgraph.png" border="0" usemap="#classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_icgraph" id="classnnp_1_1Training_ae4ccff5ae694d46c03cae84aa7ae696d_icgraph">
<area shape="rect" title="Write current RMSEs and epoch information to file." alt="" coords="195,5,397,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="ac2e1f74df67860c5776bf811e5b6a518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e1f74df67860c5776bf811e5b6a518">&#9670;&nbsp;</a></span>writeNeuronStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeNeuronStatistics </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>nnName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write neuron statistics collected since last invocation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nnName</td><td>Identifier of neural network to process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>File name for statistics file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01662">1662</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;{</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    ofstream file;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        file.open(fileName.c_str());</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        vector&lt;string&gt; title;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        vector&lt;string&gt; colName;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        title.push_back(<span class="stringliteral">&quot;Statistics for individual neurons of network \&quot;&quot;</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                        + nnName + <span class="stringliteral">&quot;\&quot; gathered during RMSE calculation.&quot;</span>);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        colName.push_back(<span class="stringliteral">&quot;element&quot;</span>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Element index.&quot;</span>);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        colName.push_back(<span class="stringliteral">&quot;neuron&quot;</span>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Neuron number.&quot;</span>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        colName.push_back(<span class="stringliteral">&quot;count&quot;</span>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Number of neuron value computations.&quot;</span>);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        colName.push_back(<span class="stringliteral">&quot;min&quot;</span>);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Minimum neuron value encounterd.&quot;</span>);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        colName.push_back(<span class="stringliteral">&quot;max&quot;</span>);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Maximum neuron value encounterd.&quot;</span>);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        colName.push_back(<span class="stringliteral">&quot;mean&quot;</span>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Mean neuron value.&quot;</span>);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        colSize.push_back(16);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        colName.push_back(<span class="stringliteral">&quot;sigma&quot;</span>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Standard deviation of neuron value.&quot;</span>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(file,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                          <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo));</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordtype">size_t</span> n = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(nnName).getNumNeurons();</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        vector&lt;long&gt;   count(n, 0);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        vector&lt;double&gt; min(n, 0.0);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        vector&lt;double&gt; max(n, 0.0);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        vector&lt;double&gt; mean(n, 0.0);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        vector&lt;double&gt; sigma(n, 0.0);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(nnName).</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            getNeuronStatistics(&amp;(count.front()),</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                &amp;(min.front()),</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                &amp;(max.front()),</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                &amp;(mean.front()),</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                                &amp;(sigma.front()));</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="comment">// Collect statistics from all processors on proc 0.</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            MPI_Reduce(MPI_IN_PLACE, &amp;(count.front()), n, MPI_LONG  , MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            MPI_Reduce(MPI_IN_PLACE, &amp;(min.front())  , n, MPI_DOUBLE, MPI_MIN, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            MPI_Reduce(MPI_IN_PLACE, &amp;(max.front())  , n, MPI_DOUBLE, MPI_MAX, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            MPI_Reduce(MPI_IN_PLACE, &amp;(mean.front()) , n, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            MPI_Reduce(MPI_IN_PLACE, &amp;(sigma.front()), n, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            MPI_Reduce(&amp;(count.front()), &amp;(count.front()), n, MPI_LONG  , MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            MPI_Reduce(&amp;(min.front())  , &amp;(min.front())  , n, MPI_DOUBLE, MPI_MIN, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            MPI_Reduce(&amp;(max.front())  , &amp;(max.front())  , n, MPI_DOUBLE, MPI_MAX, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            MPI_Reduce(&amp;(mean.front()) , &amp;(mean.front()) , n, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            MPI_Reduce(&amp;(sigma.front()), &amp;(sigma.front()), n, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                <span class="keywordtype">size_t</span> m = count.at(j);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                sigma.at(j) = sqrt((m * sigma.at(j) - mean.at(j) * mean.at(j))</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                            / (m * (m - 1)));</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                mean.at(j) /= m;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%10d %10d %10d %16.8E %16.8E %16.8E %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                              i + 1,</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                              j + 1,</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                              count[j],</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                              min[j],</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                              max[j],</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                              mean[j],</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                              sigma[j]);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        file.close();</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_cgraph.png" border="0" usemap="#classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_cgraph" id="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_cgraph">
<area shape="rect" title="Write neuron statistics collected since last invocation." alt="" coords="5,49,199,90"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="247,5,420,32"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="251,56,416,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="291,107,375,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_icgraph.png" border="0" usemap="#classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_icgraph" id="classnnp_1_1Training_ac2e1f74df67860c5776bf811e5b6a518_icgraph">
<area shape="rect" title="Write neuron statistics collected since last invocation." alt="" coords="247,5,440,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8" title="Write neuron statistics during training loop." alt="" coords="5,5,199,47"/>
</map>
</div>

</div>
</div>
<a id="a79793fcf50af45c9b128ea972b14b6a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79793fcf50af45c9b128ea972b14b6a8">&#9670;&nbsp;</a></span>writeNeuronStatisticsEpoch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeNeuronStatisticsEpoch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write neuron statistics during training loop. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01761">1761</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;{</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    vector&lt;pair&lt;string, string&gt;&gt; nnInfo; <span class="comment">// NN name and file name.</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a> &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> % <a class="code" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a> == 0</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        || <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> &lt;= <a class="code" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a>))</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            nnInfo.push_back(</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                make_pair(<span class="stringliteral">&quot;short&quot;</span>, <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;neuron-stats.%06zu.out&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>)));</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 1)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                nnInfo.push_back(</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                    make_pair(<span class="stringliteral">&quot;charge&quot;</span>,</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                              <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;neuron-stats.%s.%06zu.out.stage-%zu&quot;</span>,</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                    <span class="stringliteral">&quot;charge&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>)));</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a> == 2)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                nnInfo.push_back(</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    make_pair(<span class="stringliteral">&quot;charge&quot;</span>,</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                              <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;neuron-stats.%s.%06zu.out.stage-%zu&quot;</span>,</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                    <span class="stringliteral">&quot;charge&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>)));</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                nnInfo.push_back(</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                    make_pair(<span class="stringliteral">&quot;short&quot;</span>,</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                              <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;neuron-stats.%s.%06zu.out.stage-%zu&quot;</span>,</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                    <span class="stringliteral">&quot;short&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>)));</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; i : nnInfo) <a class="code" href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518">writeNeuronStatistics</a>(i.first, i.second);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518">writeNeuronStatistics()</a>, <a class="el" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a>, and <a class="el" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_cgraph.png" border="0" usemap="#classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_cgraph" id="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_cgraph">
<area shape="rect" title="Write neuron statistics during training loop." alt="" coords="5,5,199,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="488,13,572,39"/>
<area shape="rect" href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518" title="Write neuron statistics collected since last invocation." alt="" coords="247,35,440,76"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_icgraph.png" border="0" usemap="#classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_icgraph" id="classnnp_1_1Training_a79793fcf50af45c9b128ea972b14b6a8_icgraph">
<area shape="rect" title="Write neuron statistics during training loop." alt="" coords="195,5,388,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="adfd1869f65ece08e34f5ccea23c676f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfd1869f65ece08e34f5ccea23c676f1">&#9670;&nbsp;</a></span>resetNeuronStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::resetNeuronStatistics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset neuron statistics for all elements. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01801">1801</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;{</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;         it != <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; nn : it-&gt;neuralNetworks) nn.second.resetNeuronStatistics();</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_adfd1869f65ece08e34f5ccea23c676f1_icgraph.png" border="0" usemap="#classnnp_1_1Training_adfd1869f65ece08e34f5ccea23c676f1_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_adfd1869f65ece08e34f5ccea23c676f1_icgraph" id="classnnp_1_1Training_adfd1869f65ece08e34f5ccea23c676f1_icgraph">
<area shape="rect" title="Reset neuron statistics for all elements." alt="" coords="195,5,388,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="ad50f7e1c48f3f558653f831aae83a38c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad50f7e1c48f3f558653f831aae83a38c">&#9670;&nbsp;</a></span>writeUpdaterStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeUpdaterStatus </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileNameFormat</em> = <code>&quot;updater.%03zu.out&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write updater information to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>If true, append to file, otherwise create new file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileNameFormat</td><td>String with file name format. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01811">1811</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;{</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    ofstream file;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordtype">string</span> fileNameFormatActual = fileNameFormat;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        fileNameFormatActual += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;.stage-%zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordtype">string</span> fileName;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            fileName = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(fileNameFormatActual.c_str(), 0);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            fileName = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(fileNameFormatActual.c_str(),</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                             <a class="code" href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#acd54eb7c8fd1f9967604463ff11ffce1">atomicNumber</a>(i));</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">if</span> (append) file.open(fileName.c_str(), ofstream::app);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            file.open(fileName.c_str());</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(file, <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;statusHeader());</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        file &lt;&lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;status(<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        file.close();</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; </div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="classnnp_1_1ElementMap.html#acd54eb7c8fd1f9967604463ff11ffce1">nnp::ElementMap::atomicNumber()</a>, <a class="el" href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, and <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_cgraph.png" border="0" usemap="#classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_cgraph" id="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_cgraph">
<area shape="rect" title="Write updater information to file." alt="" coords="5,49,204,90"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="286,5,459,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#acd54eb7c8fd1f9967604463ff11ffce1" title="Get atomic number from element index." alt="" coords="252,56,493,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="331,107,415,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_icgraph.png" border="0" usemap="#classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_icgraph" id="classnnp_1_1Training_ad50f7e1c48f3f558653f831aae83a38c_icgraph">
<area shape="rect" title="Write updater information to file." alt="" coords="195,5,393,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="a7427bd5388a7c72eec65e8a2407cb7f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7427bd5388a7c72eec65e8a2407cb7f7">&#9670;&nbsp;</a></span>sortUpdateCandidates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::sortUpdateCandidates </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort update candidates with descending RMSE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01846">1846</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;{</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// Update error for all structures.</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; uc : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].updateCandidates)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <a class="code" href="structnnp_1_1Structure.html">Structure</a> <span class="keyword">const</span>&amp; s = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(uc.s);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            uc.error = fabs((s.<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - s.<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>) / s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(uc.s).atoms.at(uc.a);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            uc.error = fabs(a.<a class="code" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">fRef</a>[uc.c] - a.<a class="code" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">f</a>[uc.c]);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(uc.s).atoms.at(uc.a);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            uc.error = fabs(a.<a class="code" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">chargeRef</a> - a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// Sort update candidates list.</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    sort(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].updateCandidates.begin(),</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;         <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].updateCandidates.end());</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">// Reset current position.</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].posUpdateCandidates = 0;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">nnp::Atom::chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">nnp::Atom::f</a>, <a class="el" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">nnp::Atom::fRef</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, and <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a7427bd5388a7c72eec65e8a2407cb7f7_icgraph.png" border="0" usemap="#classnnp_1_1Training_a7427bd5388a7c72eec65e8a2407cb7f7_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a7427bd5388a7c72eec65e8a2407cb7f7_icgraph" id="classnnp_1_1Training_a7427bd5388a7c72eec65e8a2407cb7f7_icgraph">
<area shape="rect" title="Sort update candidates with descending RMSE." alt="" coords="195,5,380,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="aacf38b0b03a3d30695ac9a9cfe70fa5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf38b0b03a3d30695ac9a9cfe70fa5a">&#9670;&nbsp;</a></span>shuffleUpdateCandidates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::shuffleUpdateCandidates </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shuffle update candidates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01876">1876</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;{</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    shuffle(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].updateCandidates.begin(),</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].updateCandidates.end(),</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">rngNew</a>);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">// Reset current position.</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].posUpdateCandidates = 0;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, and <a class="el" href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">rngNew</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_aacf38b0b03a3d30695ac9a9cfe70fa5a_icgraph.png" border="0" usemap="#classnnp_1_1Training_aacf38b0b03a3d30695ac9a9cfe70fa5a_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_aacf38b0b03a3d30695ac9a9cfe70fa5a_icgraph" id="classnnp_1_1Training_aacf38b0b03a3d30695ac9a9cfe70fa5a_icgraph">
<area shape="rect" title="Shuffle update candidates." alt="" coords="195,5,399,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,13,147,39"/>
</map>
</div>

</div>
</div>
<a id="a3d0cecb1a3e0197fdb693186d39c8796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d0cecb1a3e0197fdb693186d39c8796">&#9670;&nbsp;</a></span>checkSelectionMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::checkSelectionMode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if selection mode should be changed. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01915">1915</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;{</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionModeSchedule.find(<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            != <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionModeSchedule.end())</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionModeSchedule[<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>];</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> != 0)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                <span class="keywordtype">string</span> message = <span class="stringliteral">&quot;INFO   Switching selection mode for &quot;</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                                 <span class="stringliteral">&quot;property \&quot;&quot;</span> + k + <span class="stringliteral">&quot;\&quot; to &quot;</span>;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    message += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;SM_RANDOM (%d).\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>)</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                    message += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;SM_SORT (%d).\n&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>)</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                    message += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;SM_THRESHOLD (%d).\n&quot;</span>,</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                                     <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; message;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_cgraph.png" border="0" usemap="#classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_cgraph" id="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_cgraph">
<area shape="rect" title="Check if selection mode should be changed." alt="" coords="5,5,252,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="300,5,384,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_icgraph.png" border="0" usemap="#classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_icgraph" id="classnnp_1_1Training_a3d0cecb1a3e0197fdb693186d39c8796_icgraph">
<area shape="rect" title="Check if selection mode should be changed." alt="" coords="195,5,441,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="a84e2af12e3007a2f9955630cd27a0167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e2af12e3007a2f9955630cd27a0167">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute main training loop. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01948">1948</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;{</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].start();</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** TRAINING LOOP ***********************&quot;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">printHeader</a>();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// Calculate initial RMSE and write comparison files.</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].start();</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch</a>();</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].stop();</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">// Write initial weights to files.</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch</a>();</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">// Write learning curve.</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="comment">// Write updater status to file.</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// Write neuron statistics.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch</a>();</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// Print timing information.</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].stop();</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch</a>();</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">// Check if training should be continued.</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">advance</a>())</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].start();</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">// Increment epoch counter.</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>++;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;------\n&quot;</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="comment">// Reset update counters.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>) <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].countUpdates = 0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="comment">// Check if selection mode should be changed in this epoch.</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode</a>();</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="comment">// Sort or shuffle update candidates.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>) <a class="code" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">sortUpdateCandidates</a>(k);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">shuffleUpdateCandidates</a>(k);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="comment">// Determine epoch update schedule.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <a class="code" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule</a>();</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="comment">// Perform property updates according to schedule.</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].start();</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <span class="keywordtype">string</span> <span class="keyword">property</span> = <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.at(i);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update</a>(property);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].countUpdates++;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].stop();</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="comment">// Reset neuron statistics.</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <a class="code" href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1">resetNeuronStatistics</a>();</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="comment">// Calculate errors and write comparison files.</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].start();</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <a class="code" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch</a>();</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].stop();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        <span class="comment">// Write weights to files.</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch</a>();</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="comment">// Append to learning curve.</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="comment">// Write updater status to file.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <span class="comment">// Write neuron statistics.</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch</a>();</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="comment">// Print error overview and timing information.</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].stop();</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch</a>();</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) <a class="code" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData</a>(<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> != 1);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    }</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;TIMING Training loop finished: %.2f seconds.\n&quot;</span>,</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                 <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getTotal());</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">advance()</a>, <a class="el" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">printHeader()</a>, <a class="el" href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1">resetNeuronStatistics()</a>, <a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule()</a>, <a class="el" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">shuffleUpdateCandidates()</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">sortUpdateCandidates()</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, <a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve()</a>, <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>, <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_cgraph.png" border="0" usemap="#classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_cgraph" id="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_cgraph">
<area shape="rect" title="Execute main training loop." alt="" coords="5,421,147,448"/>
<area shape="rect" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e" title="Check if training loop should be continued." alt="" coords="234,5,402,32"/>
<area shape="rect" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9" title="Calculate error metrics per epoch for all structures with file names used in training loop." alt="" coords="232,57,404,98"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="489,455,573,481"/>
<area shape="rect" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796" title="Check if selection mode should be changed." alt="" coords="195,173,441,200"/>
<area shape="rect" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f" title="Print preferred error metric and timing information on screen." alt="" coords="227,224,409,251"/>
<area shape="rect" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863" title="Print training loop header on screen." alt="" coords="223,275,413,301"/>
<area shape="rect" href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1" title="Reset neuron statistics for all elements." alt="" coords="221,326,415,367"/>
<area shape="rect" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2" title="Select energies/forces schedule for one epoch." alt="" coords="203,392,433,419"/>
<area shape="rect" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a" title="Shuffle update candidates." alt="" coords="216,443,420,485"/>
<area shape="rect" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7" title="Sort update candidates with descending RMSE." alt="" coords="225,509,411,550"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="239,575,397,601"/>
<area shape="rect" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d" title="Write current RMSEs and epoch information to file." alt="" coords="217,626,419,667"/>
<area shape="rect" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8" title="Write neuron statistics during training loop." alt="" coords="221,691,415,733"/>
<area shape="rect" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464" title="Write timing data for all clocks." alt="" coords="207,757,429,784"/>
<area shape="rect" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c" title="Write updater information to file." alt="" coords="219,809,417,850"/>
<area shape="rect" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde" title="Write weights to files during training loop." alt="" coords="219,874,417,915"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_icgraph.png" border="0" usemap="#classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_icgraph" id="classnnp_1_1Training_a84e2af12e3007a2f9955630cd27a0167_icgraph">
<area shape="rect" title="Execute main training loop." alt="" coords="108,5,249,32"/>
<area shape="rect" href="nnp-train_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="aee02964b08a2acc442add33d96dbb1a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee02964b08a2acc442add33d96dbb1a2">&#9670;&nbsp;</a></span>setEpochSchedule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setEpochSchedule </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select energies/forces schedule for one epoch. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l01887">1887</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;{</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// Clear epoch schedule.</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>.clear();</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    vector&lt;int&gt;(<a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>).swap(<a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">// Grow schedule vector by each property&#39;s number of desired updates.</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">// Fill this array looping in reverse direction for backward compatibility.</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">//for (size_t i = 0; i &lt; pk.size(); ++i)</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.size() - 1; i &gt;= 0; --i)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>.insert(<a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>.end(), <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.at(i)].numUpdates, i);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">// Return if there is only a single training property.</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.size() == 1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="comment">// Now shuffle the schedule to get a random sequence.</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    shuffle(<a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>.begin(), <a class="code" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>.end(), <a class="code" href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">rngGlobalNew</a>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">//for (size_t i = 0; i &lt; epochSchedule.size(); ++i)</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">//{</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">//    log &lt;&lt; strpr(&quot;%zu %zu\n&quot;, i, epochSchedule.at(i));</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">epochSchedule</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, and <a class="el" href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">rngGlobalNew</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_aee02964b08a2acc442add33d96dbb1a2_icgraph.png" border="0" usemap="#classnnp_1_1Training_aee02964b08a2acc442add33d96dbb1a2_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_aee02964b08a2acc442add33d96dbb1a2_icgraph" id="classnnp_1_1Training_aee02964b08a2acc442add33d96dbb1a2_icgraph">
<area shape="rect" title="Select energies/forces schedule for one epoch." alt="" coords="195,5,425,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="a6432b845ccd07996ab2f8f4f707a0d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6432b845ccd07996ab2f8f4f707a0d8d">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::update </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform one update. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property to use for update. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02050">2050</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;{</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="comment">// Shortcuts.</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordtype">string</span> <span class="keyword">const</span>&amp; k = property; <span class="comment">// Property key.</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    Property&amp; pu = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k]; <span class="comment">// Update property.</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">// Start watch for error and jacobian computation, reset loop timer if</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="comment">// first update in this epoch.</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordtype">bool</span> newLoop = pu.countUpdates == 0;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].start(newLoop);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_err&quot;</span>].start(newLoop);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordtype">int</span> num_threads = omp_get_max_threads();</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    omp_set_num_threads(1);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// PART 1: Find update candidate, compute error fractions and derivatives</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordtype">size_t</span> batchSize = pu.taskBatchSize;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <span class="keywordflow">if</span> (batchSize == 0) batchSize = pu.patternsPerUpdate;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordtype">bool</span> derivatives = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>) derivatives = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    vector&lt;size_t&gt; thresholdLoopCount(batchSize, 0);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    vector&lt;double&gt; currentRmseFraction(batchSize, 0.0);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    vector&lt;UpdateCandidate*&gt; currentUpdateCandidates(batchSize, NULL);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        fill(pu.error.at(i).begin(), pu.error.at(i).end(), 0.0);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        fill(pu.jacobian.at(i).begin(), pu.jacobian.at(i).end(), 0.0);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="comment">// Loop over (mini-)batch size.</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> b = 0; b &lt; batchSize; ++b)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        UpdateCandidate* c = NULL; <span class="comment">// Actual current update candidate.</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keywordtype">size_t</span> indexBest = 0; <span class="comment">// Index of best update candidate so far.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordtype">double</span> rmseFractionBest = 0.0; <span class="comment">// RMSE of best update candidate so far.</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        <span class="comment">// For SM_THRESHOLD need to loop until candidate&#39;s RMSE is above</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <span class="comment">// threshold. Other modes don&#39;t loop here.</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordtype">size_t</span> trials = 1;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        <span class="keywordflow">if</span> (pu.selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>) trials = pu.rmseThresholdTrials;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="keywordtype">size_t</span> il = 0;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">for</span> (il = 0; il &lt; trials; ++il)</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <span class="comment">// Restart position index if necessary.</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <span class="keywordflow">if</span> (pu.posUpdateCandidates &gt;= pu.updateCandidates.size())</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                pu.posUpdateCandidates = 0;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            <span class="comment">//log &lt;&lt; strpr(&quot;pos %zu b %zu size %zu\n&quot;, pu.posUpdateCandidates, b, currentUpdateCandidates.size());</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <span class="comment">// Set current update candidate.</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            c = &amp;(pu.updateCandidates.at(pu.posUpdateCandidates));</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <span class="comment">// Keep update candidates (for logging later).</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            currentUpdateCandidates.at(b) = c;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <span class="comment">// Shortcut for current structure.</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(c-&gt;s);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            <span class="comment">// Calculate symmetry functions (if results are already stored</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            <span class="comment">// these functions will return immediately).</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="preprocessor">#ifdef NOSFGROUPS</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>(s, derivatives);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>(s, derivatives);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            <span class="comment">// For SM_THRESHOLD calculate RMSE of update candidate.</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            <span class="keywordflow">if</span> (pu.selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                    {</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                        <a class="code" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">calculateAtomicNeuralNetworks</a>(s, derivatives);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                        <a class="code" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a>(s);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                        currentRmseFraction.at(b) =</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                            fabs(s.<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - s.<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                            / (s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * pu.errorTrain.at(<span class="stringliteral">&quot;RMSEpa&quot;</span>));</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                    <span class="comment">// Assume stage 2.</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                    {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                        <span class="comment">// TODO: Reuse already present charge-NN data and</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                        <span class="comment">// compute only short-NN energy contributions.</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Not implemented.\n&quot;</span>);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                    }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                    {</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                        <a class="code" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">calculateAtomicNeuralNetworks</a>(s, derivatives);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                        <a class="code" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a>(s);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                        <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                        currentRmseFraction.at(b) =</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                            fabs(a.<a class="code" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">fRef</a>[c-&gt;c] - a.<a class="code" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">f</a>[c-&gt;c])</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                            / pu.errorTrain.at(<span class="stringliteral">&quot;RMSE&quot;</span>);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                    }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                    <span class="comment">// Assume stage 2.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                    {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                        <span class="comment">// TODO: Reuse already present charge-NN data and</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                        <span class="comment">// compute only short-NN force contributions.</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Not implemented.\n&quot;</span>);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                    }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                    <span class="comment">// Assume NNPType::SHORT_CHARGE_NN stage 1.</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                    <span class="comment">// Compute only charge-NN</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                    <a class="code" href="structnnp_1_1Atom.html">Atom</a>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                    <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn =</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(a.<a class="code" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>).neuralNetworks.at(<span class="stringliteral">&quot;charge&quot;</span>);</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;(a.<a class="code" href="structnnp_1_1Atom.html#abc64f09e49aabb8112004f5af6983102">G</a>.front()));</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>));</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                    currentRmseFraction.at(b) = fabs(a.<a class="code" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">chargeRef</a> - a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>)</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                              / pu.errorTrain.at(<span class="stringliteral">&quot;RMSE&quot;</span>);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                <span class="comment">// If force RMSE is above threshold stop loop immediately.</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                <span class="keywordflow">if</span> (currentRmseFraction.at(b) &gt; pu.rmseThreshold)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                    <span class="comment">// Increment position in update candidate list.</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                    pu.posUpdateCandidates++;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                <span class="comment">// If loop continues, free memory and remember best candidate</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                <span class="comment">// so far.</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                    s.<a class="code" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                <span class="keywordflow">if</span> (currentRmseFraction.at(b) &gt; rmseFractionBest)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                    rmseFractionBest = currentRmseFraction.at(b);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                    indexBest = pu.posUpdateCandidates;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                }</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                <span class="comment">// Increment position in update candidate list.</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                pu.posUpdateCandidates++;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="comment">// Break loop for all selection modes but SM_THRESHOLD.</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pu.selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a> ||</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                     pu.selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                <span class="comment">// Increment position in update candidate list.</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                pu.posUpdateCandidates++;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        thresholdLoopCount.at(b) = il;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        <span class="comment">// If loop was not stopped because of a proper update candidate found</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="comment">// (RMSE above threshold) use best candidate during iteration.</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        <span class="keywordflow">if</span> (pu.selectionMode == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a> &amp;&amp; il == trials)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            <span class="comment">// Set best candidate.</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            currentUpdateCandidates.at(b) =</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                &amp;(pu.updateCandidates.at(indexBest));</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            currentRmseFraction.at(b) = rmseFractionBest;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            <span class="comment">// Need to calculate the symmetry functions again, maybe results</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="comment">// were not stored.</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(c-&gt;s);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="preprocessor">#ifdef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>(s, derivatives);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>(s, derivatives);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">// PART 2: Compute error vector and Jacobian</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(c-&gt;s);</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="comment">// Temporary storage for derivative contributions of atoms (dXdc stores</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="comment">// dEdc, dFdc or dQdc for energy, force or charge update, respectively.</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        vector&lt;vector&lt;double&gt;&gt; dXdc;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        dXdc.resize(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <span class="keywordtype">size_t</span> n = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>)</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                       .getNumConnections();</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            dXdc.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="comment">// Precalculate offset in Jacobian array.</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="keywordtype">size_t</span> iu = 0;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        vector&lt;size_t&gt; offset(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, 0);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        {</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>) iu = i;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            <span class="keywordflow">else</span> iu = 0;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> != <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            {</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                offset.at(i) += pu.offsetPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                              * <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(iu);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                <span class="comment">//log &lt;&lt; strpr(&quot;%zu os 1: %zu &quot;, i, offset.at(i));</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                offset.at(i) += b * <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(iu);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                <span class="comment">//log &lt;&lt; strpr(&quot;%zu os 2: %zu &quot;, i, offset.at(i));</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                offset.at(i) += <a class="code" href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">weightsOffset</a>.at(i);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                <span class="comment">//log &lt;&lt; strpr(&quot;%zu os 3: %zu&quot;, i, offset.at(i));</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            <span class="comment">//log &lt;&lt; strpr(&quot; %zu final os: %zu\n&quot;, i, offset.at(i));</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <span class="comment">// Now compute Jacobian.</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;            {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                <span class="comment">// Loop over atoms and calculate atomic energy contributions.</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                     it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                    <span class="keywordtype">size_t</span> i = it-&gt;element;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                    <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;((it-&gt;G).front()));</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(it-&gt;energy));</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                    <span class="comment">// Compute derivative of output node with respect to all</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                    <span class="comment">// neural network connections (weights + biases).</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">calculateDEdc</a>(&amp;(dXdc.at(i).front()));</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                    <span class="comment">// Finally sum up Jacobian.</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>) iu = i;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                    <span class="keywordflow">else</span> iu = 0;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dXdc.at(i).size(); ++j)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                    {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                        pu.jacobian.at(iu).at(offset.at(i) + j) +=</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                            dXdc.at(i).at(j);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                    }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Not implemented.\n&quot;</span>);</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            }</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">NNPType::SHORT_ONLY</a>)</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            {</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                <span class="comment">// Loop over atoms and calculate atomic energy contributions.</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                     it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                    <span class="comment">// For force update save derivative of symmetry function</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                    <span class="comment">// with respect to coordinate.</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia</a>((*it), c-&gt;a, c-&gt;c);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                    it-&gt;collectDGdxia(c-&gt;a, c-&gt;c);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                    <span class="keywordtype">size_t</span> i = it-&gt;element;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                    <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;((it-&gt;G).front()));</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                    <span class="keywordflow">if</span> (derivatives) nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#abf46d0d0d2a4c068f67bb13ae445d725">calculateDEdG</a>(&amp;((it-&gt;dEdG).front()));</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(it-&gt;energy));</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                    <span class="comment">// Compute derivative of output node with respect to all</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                    <span class="comment">// neural network connections (weights + biases).</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">calculateDFdc</a>(&amp;(dXdc.at(i).front()),</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                                     &amp;(<a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>.front()));</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                    nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">calculateDFdc</a>(&amp;(dXdc.at(i).front()),</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                                     &amp;(it-&gt;dGdxia.front()));</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                    <span class="comment">// Finally sum up Jacobian.</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>) iu = i;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                    <span class="keywordflow">else</span> iu = 0;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dXdc.at(i).size(); ++j)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                    {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                        pu.jacobian.at(iu).at(offset.at(i) + j) +=</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                            dXdc.at(i).at(j);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                    }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Not implemented.\n&quot;</span>);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <span class="comment">// Assume NNPType::SHORT_CHARGE_NN stage 1.</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            <span class="comment">// Shortcut to selected atom.</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <a class="code" href="structnnp_1_1Atom.html">Atom</a>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <span class="keywordtype">size_t</span> i = a.<a class="code" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;(a.<a class="code" href="structnnp_1_1Atom.html#abc64f09e49aabb8112004f5af6983102">G</a>.front()));</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>));</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            <span class="comment">// Compute derivative of output node with respect to all</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            <span class="comment">// neural network connections (weights + biases).</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">calculateDEdc</a>(&amp;(dXdc.at(i).front()));</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="comment">// Finally sum up Jacobian.</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>) iu = i;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordflow">else</span> iu = 0;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dXdc.at(i).size(); ++j)</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            {</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                pu.jacobian.at(iu).at(offset.at(i) + j) +=</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                    dXdc.at(i).at(j);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        }</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        <span class="comment">// Sum up total potential energy or calculate force.</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a>(s);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            currentRmseFraction.at(b) = fabs(s.<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - s.<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>)</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                                      / (s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                                         * pu.errorTrain.at(<span class="stringliteral">&quot;RMSEpa&quot;</span>));</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a>(s);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            currentRmseFraction.at(b) = fabs(a.<a class="code" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">fRef</a>[c-&gt;c] - a.<a class="code" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">f</a>[c-&gt;c])</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                                      / pu.errorTrain.at(<span class="stringliteral">&quot;RMSE&quot;</span>);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            currentRmseFraction.at(b) = fabs(a.<a class="code" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">chargeRef</a> - a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>)</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                                      / pu.errorTrain.at(<span class="stringliteral">&quot;RMSE&quot;</span>);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        }</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="comment">// Now symmetry function memory is not required any more for this</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        <span class="comment">// update.</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>) s.<a class="code" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="comment">// Precalculate offset in error array.</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordtype">size_t</span> offset2 = 0;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a> &amp;&amp; <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> != <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            offset2 += pu.offsetPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            <span class="comment">//log &lt;&lt; strpr(&quot;os 4: %zu &quot;, offset2);</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            offset2 += b;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <span class="comment">//log &lt;&lt; strpr(&quot;os 5: %zu &quot;, offset2);</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="comment">//log &lt;&lt; strpr(&quot; final os: %zu\n&quot;, offset2);</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="comment">// Compute error vector (depends on update strategy).</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        {</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                pu.error.at(0).at(offset2) += s.<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - s.<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            {</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                pu.error.at(0).at(offset2) +=  a.<a class="code" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">fRef</a>[c-&gt;c] - a.<a class="code" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">f</a>[c-&gt;c];</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                pu.error.at(0).at(offset2) +=  a.<a class="code" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">chargeRef</a> - a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                    pu.error.at(i).at(offset2) += (s.<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - s.<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>)</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                                               * s.<a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                                               / s.<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                {</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                    <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                    pu.error.at(i).at(offset2) += (a.<a class="code" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">fRef</a>[c-&gt;c] - a.<a class="code" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">f</a>[c-&gt;c])</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                                               * a.<a class="code" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">numNeighborsPerElement</a>.at(i)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                                               / a.<a class="code" href="structnnp_1_1Atom.html#afebaaf27a0e6b30eab2f4cbc8c66d046">numNeighbors</a>;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                    <a class="code" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; a = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(c-&gt;a);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                    pu.error.at(i).at(offset2) += a.<a class="code" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">chargeRef</a> - a.<a class="code" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                }</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">// Apply force update weight to error and Jacobian.</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; pu.error.at(i).size(); ++j)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                pu.error.at(i).at(j) *= <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            }</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; pu.jacobian.at(i).size(); ++j)</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                pu.jacobian.at(i).at(j) *= <a class="code" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;            }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        }</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_err&quot;</span>].stop();</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="comment">// PART 3: Communicate error and Jacobian.</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_com&quot;</span>].start(newLoop);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>)</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        {</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Reduce(MPI_IN_PLACE             , &amp;(pu.error.at(i).front()), 1, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                <span class="keywordflow">else</span>             MPI_Reduce(&amp;(pu.error.at(i).front()), &amp;(pu.error.at(i).front()), 1, MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Reduce(MPI_IN_PLACE                , &amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                <span class="keywordflow">else</span>             MPI_Reduce(&amp;(pu.jacobian.at(i).front()), &amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, MPI_SUM, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>)</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                MPI_Allreduce(MPI_IN_PLACE, &amp;(pu.error.at(i).front()), 1, MPI_DOUBLE, MPI_SUM, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                MPI_Allreduce(MPI_IN_PLACE, &amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, MPI_SUM, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>)</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Gather(MPI_IN_PLACE             , 1, MPI_DOUBLE, &amp;(pu.error.at(i).front()),  1, MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                <span class="keywordflow">else</span>             MPI_Gather(&amp;(pu.error.at(i).front()), 1, MPI_DOUBLE, NULL                     ,  1, MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Gather(MPI_IN_PLACE                , <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, &amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                <span class="keywordflow">else</span>             MPI_Gather(&amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, NULL                        , <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        }</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>)</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            {</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                MPI_Allgather(MPI_IN_PLACE, 1, MPI_DOUBLE, &amp;(pu.error.at(i).front()),  1, MPI_DOUBLE, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                MPI_Allgather(MPI_IN_PLACE, <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, &amp;(pu.jacobian.at(i).front()), <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), MPI_DOUBLE, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    {</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>)</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Gatherv(MPI_IN_PLACE             , 0                          , MPI_DOUBLE, &amp;(pu.error.at(i).front()), &amp;(pu.errorsPerTask.front()), &amp;(pu.offsetPerTask.front()), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                <span class="keywordflow">else</span>             MPI_Gatherv(&amp;(pu.error.at(i).front()), pu.errorsPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>), MPI_DOUBLE, NULL                     , NULL                       , NULL                       , MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Gatherv(MPI_IN_PLACE                , 0                                 , MPI_DOUBLE, &amp;(pu.jacobian.at(i).front()), &amp;(pu.weightsPerTask.at(i).front()), &amp;(pu.offsetJacobian.at(i).front()), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                <span class="keywordflow">else</span>             MPI_Gatherv(&amp;(pu.jacobian.at(i).front()), pu.weightsPerTask.at(i).at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>), MPI_DOUBLE, NULL                        , NULL                              , NULL                              , MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            }</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                MPI_Allgatherv(MPI_IN_PLACE, 0, MPI_DOUBLE, &amp;(pu.error.at(i).front()), &amp;(pu.errorsPerTask.front()), &amp;(pu.offsetPerTask.front()), MPI_DOUBLE, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                MPI_Allgatherv(MPI_IN_PLACE, 0, MPI_DOUBLE, &amp;(pu.jacobian.at(i).front()), &amp;(pu.weightsPerTask.at(i).front()), &amp;(pu.offsetJacobian.at(i).front()), MPI_DOUBLE, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            }</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_com&quot;</span>].stop();</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="comment">// PART 4: Perform weight update and apply new weights.</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_upd&quot;</span>].start(newLoop);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    omp_set_num_threads(num_threads);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="comment">// Loop over all updaters.</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.size(); ++i)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;setError(&amp;(pu.error.at(i).front()),</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                                 pu.error.at(i).size());</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;setJacobian(&amp;(pu.jacobian.at(i).front()),</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                                    pu.error.at(i).size());</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a> == <a class="code" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>)</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        {</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            <a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>* kf = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classnnp_1_1KalmanFilter.html">KalmanFilter</a>*<span class="keyword">&gt;</span>(<a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i));</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            kf-&gt;<a class="code" href="classnnp_1_1KalmanFilter.html#aa75026a60054469cc7fb3a211e501f2f">setSizeObservation</a>(pu.error.at(i).size());</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        }</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>.at(i)-&gt;update();</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>++;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="comment">// Redistribute weights to all MPI tasks.</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>)</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        {</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            MPI_Bcast(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).front()), <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).size(), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        }</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="comment">// Set new weights in neural networks.</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights</a>();</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_upd&quot;</span>].stop();</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160; </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="comment">// PART 5: Communicate candidates and RMSE fractions and write log.</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_log&quot;</span>].start(newLoop);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a>)</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        vector&lt;int&gt;    procUpdateCandidate;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        vector&lt;size_t&gt; indexStructure;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        vector&lt;size_t&gt; indexStructureGlobal;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        vector&lt;size_t&gt; indexAtom;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        vector&lt;size_t&gt; indexCoordinate;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        vector&lt;int&gt; currentUpdateCandidatesPerTask;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        vector&lt;int&gt; currentUpdateCandidatesOffset;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="keywordtype">int</span> myCurrentUpdateCandidates = currentUpdateCandidates.size();</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            currentUpdateCandidatesPerTask.resize(<a class="code" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a>, 0);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            currentUpdateCandidatesPerTask.at(0) = myCurrentUpdateCandidates;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0) MPI_Gather(MPI_IN_PLACE                , 1, MPI_INT, &amp;(currentUpdateCandidatesPerTask.front()),  1, MPI_INT, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="keywordflow">else</span>             MPI_Gather(&amp;(myCurrentUpdateCandidates), 1, MPI_INT, NULL                                     ,  1, MPI_INT, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        {</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            <span class="keywordtype">int</span> totalUpdateCandidates = 0;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; currentUpdateCandidatesPerTask.size(); ++i)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            {</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                currentUpdateCandidatesOffset.push_back(totalUpdateCandidates);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                totalUpdateCandidates += currentUpdateCandidatesPerTask.at(i);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            procUpdateCandidate.resize(totalUpdateCandidates, 0);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;            indexStructure.resize(totalUpdateCandidates, 0);</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            indexStructureGlobal.resize(totalUpdateCandidates, 0);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            indexAtom.resize(totalUpdateCandidates, 0);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            indexCoordinate.resize(totalUpdateCandidates, 0);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <span class="comment">// Increase size of this vectors (only rank 0).</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            currentRmseFraction.resize(totalUpdateCandidates, 0.0);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;            thresholdLoopCount.resize(totalUpdateCandidates, 0.0);</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        {</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;            procUpdateCandidate.resize(myCurrentUpdateCandidates, 0);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            indexStructure.resize(myCurrentUpdateCandidates, 0);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            indexStructureGlobal.resize(myCurrentUpdateCandidates, 0);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            indexAtom.resize(myCurrentUpdateCandidates, 0);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            indexCoordinate.resize(myCurrentUpdateCandidates, 0);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        }</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; myCurrentUpdateCandidates; ++i)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        {</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            procUpdateCandidate.at(i) = <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            UpdateCandidate&amp; c = *(currentUpdateCandidates.at(i));</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;            indexStructure.at(i) = c.s;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            indexStructureGlobal.at(i) = <a class="code" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">structures</a>.at(c.s).index;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            indexAtom.at(i) = c.a;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;            indexCoordinate.at(i) = c.c;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        }</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        {</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, MPI_DOUBLE, &amp;(currentRmseFraction.front()) , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, &amp;(thresholdLoopCount.front())  , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, MPI_INT   , &amp;(procUpdateCandidate.front()) , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), MPI_INT   , 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, &amp;(indexStructure.front())      , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, &amp;(indexStructureGlobal.front()), &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, &amp;(indexAtom.front())           , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            MPI_Gatherv(MPI_IN_PLACE, 0, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, &amp;(indexCoordinate.front())     , &amp;(currentUpdateCandidatesPerTask.front()), &amp;(currentUpdateCandidatesOffset.front()), <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;            MPI_Gatherv(&amp;(currentRmseFraction.front()) , myCurrentUpdateCandidates, MPI_DOUBLE, NULL, NULL, NULL, MPI_DOUBLE, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;            MPI_Gatherv(&amp;(thresholdLoopCount.front())  , myCurrentUpdateCandidates, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, NULL, NULL, NULL, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            MPI_Gatherv(&amp;(procUpdateCandidate.front()) , myCurrentUpdateCandidates, MPI_INT   , NULL, NULL, NULL, MPI_INT   , 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            MPI_Gatherv(&amp;(indexStructure.front())      , myCurrentUpdateCandidates, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, NULL, NULL, NULL, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            MPI_Gatherv(&amp;(indexStructureGlobal.front()), myCurrentUpdateCandidates, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, NULL, NULL, NULL, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            MPI_Gatherv(&amp;(indexAtom.front())           , myCurrentUpdateCandidates, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, NULL, NULL, NULL, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            MPI_Gatherv(&amp;(indexCoordinate.front())     , myCurrentUpdateCandidates, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, NULL, NULL, NULL, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, 0, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; procUpdateCandidate.size(); ++i)</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                {</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry</a>(procUpdateCandidate.at(i),</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                                        thresholdLoopCount.at(i),</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                                        currentRmseFraction.at(i),</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                                        indexStructureGlobal.at(i),</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                                        indexStructure.at(i));</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;force&quot;</span>)</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry</a>(procUpdateCandidate.at(i),</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                                        thresholdLoopCount.at(i),</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                                        currentRmseFraction.at(i),</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                                        indexStructureGlobal.at(i),</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                                        indexStructure.at(i),</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                                        indexAtom.at(i),</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                                        indexCoordinate.at(i));</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                    <a class="code" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry</a>(procUpdateCandidate.at(i),</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                                        thresholdLoopCount.at(i),</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                                        currentRmseFraction.at(i),</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                                        indexStructureGlobal.at(i),</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                                        indexStructure.at(i),</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                                        indexAtom.at(i));</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + <span class="stringliteral">&quot;_log&quot;</span>].stop();</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].stop();</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Training_1_1UpdateCandidate.html#a38352286993a1ab398323449c40f0a10">nnp::Training::UpdateCandidate::a</a>, <a class="el" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry()</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="structnnp_1_1Training_1_1UpdateCandidate.html#a6bbdc3fd01e620d5b5020331bde0d4df">nnp::Training::UpdateCandidate::c</a>, <a class="el" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">nnp::Mode::calculateAtomicNeuralNetworks()</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">nnp::NeuralNetwork::calculateDEdc()</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#abf46d0d0d2a4c068f67bb13ae445d725">nnp::NeuralNetwork::calculateDEdG()</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">nnp::NeuralNetwork::calculateDFdc()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">nnp::Atom::chargeRef</a>, <a class="el" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia()</a>, <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a83476357f0f604bcbe7134fc5d85046e">nnp::Training::Property::countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a66fa78822af01cac13621484af8b583b">nnp::Training::Property::error</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a237fdc1c832aebec499d03095e72f409">nnp::Training::Property::errorsPerTask</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#ab71068e08e9c78fe54f9384450b24b1a">nnp::Training::Property::errorTrain</a>, <a class="el" href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">nnp::Atom::f</a>, <a class="el" href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">forceWeight</a>, <a class="el" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">nnp::Structure::freeAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">freeMemory</a>, <a class="el" href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">nnp::Atom::fRef</a>, <a class="el" href="structnnp_1_1Atom.html#abc64f09e49aabb8112004f5af6983102">nnp::Atom::G</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput()</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#abb61edfe4a242cd6cd1a1e6a6dc44892">nnp::Training::Property::jacobian</a>, <a class="el" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">JM_TASK</a>, <a class="el" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="structnnp_1_1Atom.html#afebaaf27a0e6b30eab2f4cbc8c66d046">nnp::Atom::numNeighbors</a>, <a class="el" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a>, <a class="el" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">nnp::Dataset::numProcs</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a7c7b1a154236e7778ca8846a3f95e2d8">nnp::Training::Property::offsetJacobian</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#aac52bd2258c7f7b53133d425fb1c94f9">nnp::Training::Property::offsetPerTask</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a54c2a8fc1d0aa231de78393cca59c213">nnp::Training::Property::patternsPerUpdate</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#afe1cf7a3763961006e72dc75f56ad864">nnp::Training::Property::posUpdateCandidates</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate()</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a48523786912eceacede5ec0983fa9446">nnp::Training::Property::rmseThreshold</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#af77b515f04b843319a50af7ee0d38297">nnp::Training::Property::rmseThresholdTrials</a>, <a class="el" href="structnnp_1_1Training_1_1UpdateCandidate.html#ad631306aff9f9e0bca74425d3ab9e5bc">nnp::Training::UpdateCandidate::s</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a43c72f360013f0c54bbd093023c109a0">nnp::Training::Property::selectionMode</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput()</a>, <a class="el" href="classnnp_1_1KalmanFilter.html#aa75026a60054469cc7fb3a211e501f2f">nnp::KalmanFilter::setSizeObservation()</a>, <a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights()</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::SHORT_ONLY</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>, <a class="el" href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a>, <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a61d413cda5e23ae4a0a6398aec99d7bf">nnp::Training::Property::taskBatchSize</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#ab02367acc5fadb9ffe9cac2f8dd1f0c3">nnp::Training::Property::updateCandidates</a>, <a class="el" href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">updaters</a>, <a class="el" href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">updaterType</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>, <a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">UT_KF</a>, <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>, <a class="el" href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">weightsOffset</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a9c1498b6d1ba640b41701ee752010128">nnp::Training::Property::weightsPerTask</a>, and <a class="el" href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">writeTrainingLog</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_cgraph.png" border="0" usemap="#classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_cgraph" id="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_cgraph">
<area shape="rect" title="Perform one update." alt="" coords="5,443,164,470"/>
<area shape="rect" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f" title="Write energy update data to training log file." alt="" coords="231,5,419,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7" title="Calculate a single atomic neural network for a given atom and nn type." alt="" coords="223,173,426,215"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#abf46d0d0d2a4c068f67bb13ae445d725" title="Calculate derivative of output neuron with respect to input neurons." alt="" coords="485,67,637,108"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7" title="Get neural network output layer node values." alt="" coords="485,133,637,175"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2" title="Propagate input information through all layers." alt="" coords="485,201,637,243"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37" title="Set neural network input layer node values." alt="" coords="485,272,637,313"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca" title="Calculate derivative of output neuron with respect to connections." alt="" coords="249,341,401,383"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161" title="Calculate &quot;second&quot; derivative of output with respect to connections." alt="" coords="249,407,401,448"/>
<area shape="rect" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308" title="Calculate potential energy for a given structure." alt="" coords="223,473,426,499"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1" title="Calculate forces for all atoms in given structure." alt="" coords="225,523,424,550"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure." alt="" coords="212,575,437,616"/>
<area shape="rect" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure." alt="" coords="212,640,437,681"/>
<area shape="rect" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf" title="Collect derivative of symmetry functions with repect to one atom&#39;s coordinate." alt="" coords="223,706,427,733"/>
<area shape="rect" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d" title="Free symmetry function memory for all atoms, see free() in Atom class." alt="" coords="230,757,419,783"/>
<area shape="rect" href="classnnp_1_1KalmanFilter.html#aa75026a60054469cc7fb3a211e501f2f" title="Set observation vector size." alt="" coords="251,808,399,849"/>
<area shape="rect" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb" title="Set weights in neural network class." alt="" coords="232,874,417,901"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_icgraph.png" border="0" usemap="#classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_icgraph" id="classnnp_1_1Training_a6432b845ccd07996ab2f8f4f707a0d8d_icgraph">
<area shape="rect" title="Perform one update." alt="" coords="195,5,353,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="ab2d9c91a092bdb9e8eac8441ccb09ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2d9c91a092bdb9e8eac8441ccb09ef8">&#9670;&nbsp;</a></span>getSingleWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Training::getSingleWeight </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>element</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a single weight value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">element</td><td><a class="el" href="classnnp_1_1Element.html" title="Contains element-specific data.">Element</a> index of weight. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Weight index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Weight value.</dd></dl>
<p>Note: This function is implemented for testing purposes and works correctly only with update strategy <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf" title="Separate updaters for individual elements.">US_ELEMENT</a>. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02691">2691</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;{</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights</a>();</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(element).at(index);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights()</a>, and <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ab2d9c91a092bdb9e8eac8441ccb09ef8_cgraph.png" border="0" usemap="#classnnp_1_1Training_ab2d9c91a092bdb9e8eac8441ccb09ef8_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ab2d9c91a092bdb9e8eac8441ccb09ef8_cgraph" id="classnnp_1_1Training_ab2d9c91a092bdb9e8eac8441ccb09ef8_cgraph">
<area shape="rect" title="Get a single weight value." alt="" coords="5,5,180,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0" title="Get weights from neural network class." alt="" coords="228,13,415,39"/>
</map>
</div>

</div>
</div>
<a id="aaa4815462bd1b49907a9bce52eb2da43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa4815462bd1b49907a9bce52eb2da43">&#9670;&nbsp;</a></span>setSingleWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setSingleWeight </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>element</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a single weight value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">element</td><td><a class="el" href="classnnp_1_1Element.html" title="Contains element-specific data.">Element</a> index of weight. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Weight index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>Weight value.</td></tr>
  </table>
  </dd>
</dl>
<p>Note: This function is implemented for testing purposes and works correctly only with update strategy <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf" title="Separate updaters for individual elements.">US_ELEMENT</a>. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02698">2698</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;{</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(element).at(index) = value;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights</a>();</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights()</a>, and <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_aaa4815462bd1b49907a9bce52eb2da43_cgraph.png" border="0" usemap="#classnnp_1_1Training_aaa4815462bd1b49907a9bce52eb2da43_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_aaa4815462bd1b49907a9bce52eb2da43_cgraph" id="classnnp_1_1Training_aaa4815462bd1b49907a9bce52eb2da43_cgraph">
<area shape="rect" title="Set a single weight value." alt="" coords="5,5,179,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb" title="Set weights in neural network class." alt="" coords="227,13,412,39"/>
</map>
</div>

</div>
</div>
<a id="ae22bf5b246022c4f52f45bcc98d7c4be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae22bf5b246022c4f52f45bcc98d7c4be">&#9670;&nbsp;</a></span>calculateWeightDerivatives() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; vector&lt; double &gt; &gt; Training::calculateWeightDerivatives </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Structure.html">Structure</a> *&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate derivatives of energy with respect to weights. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">structure</td><td><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> to process.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector with derivatives of energy with respect to weights (per element).</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is implemented for testing purposes. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02707">2707</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = *structure;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="preprocessor">#ifdef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>(s, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>(s, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    vector&lt;vector&lt;double&gt; &gt; dEdc;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    vector&lt;vector&lt;double&gt; &gt; dedc;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    dEdc.resize(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    dedc.resize(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordtype">size_t</span> n = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<span class="stringliteral">&quot;short&quot;</span>)</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                   .getNumConnections();</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        dEdc.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        dedc.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;         it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        <span class="keywordtype">size_t</span> i = it-&gt;element;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<span class="stringliteral">&quot;short&quot;</span>);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;((it-&gt;G).front()));</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(it-&gt;energy));</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">calculateDEdc</a>(&amp;(dedc.at(i).front()));</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dedc.at(i).size(); ++j)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            dEdc.at(i).at(j) += dedc.at(i).at(j);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="keywordflow">return</span> dEdc;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">nnp::NeuralNetwork::calculateDEdc()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput()</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate()</a>, and <a class="el" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ae22bf5b246022c4f52f45bcc98d7c4be_cgraph.png" border="0" usemap="#classnnp_1_1Training_ae22bf5b246022c4f52f45bcc98d7c4be_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ae22bf5b246022c4f52f45bcc98d7c4be_cgraph" id="classnnp_1_1Training_ae22bf5b246022c4f52f45bcc98d7c4be_cgraph">
<area shape="rect" title="Calculate derivatives of energy with respect to weights." alt="" coords="5,169,177,211"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca" title="Calculate derivative of output neuron with respect to connections." alt="" coords="262,5,414,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure." alt="" coords="225,71,451,112"/>
<area shape="rect" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure." alt="" coords="225,136,451,177"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7" title="Get neural network output layer node values." alt="" coords="262,201,414,243"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2" title="Propagate input information through all layers." alt="" coords="262,267,414,308"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37" title="Set neural network input layer node values." alt="" coords="262,332,414,373"/>
</map>
</div>

</div>
</div>
<a id="abf466a175faf1511b305ed728042edb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf466a175faf1511b305ed728042edb9">&#9670;&nbsp;</a></span>calculateWeightDerivatives() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; vector&lt; double &gt; &gt; Training::calculateWeightDerivatives </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Structure.html">Structure</a> *&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>component</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate derivatives of force with respect to weights. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">structure</td><td><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> to process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atom</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">component</td><td>x, y or z-component of force (0, 1, 2).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector with derivatives of force with respect to weights (per element).</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is implemented for testing purposes. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02747">2747</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;{</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <a class="code" href="structnnp_1_1Structure.html">Structure</a>&amp; s = *structure;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="preprocessor">#ifdef N2P2_NO_SF_GROUPS</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a>(s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a>(s, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160; </div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    vector&lt;vector&lt;double&gt; &gt; dFdc;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    vector&lt;vector&lt;double&gt; &gt; dfdc;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    dFdc.resize(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    dfdc.resize(<a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keywordtype">size_t</span> n = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<span class="stringliteral">&quot;short&quot;</span>)</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                   .getNumConnections();</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        dFdc.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        dfdc.at(i).resize(n, 0.0);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    }</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         it != s.<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia</a>((*it), atom, component);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        it-&gt;collectDGdxia(atom, component);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="keywordtype">size_t</span> i = it-&gt;element;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<span class="stringliteral">&quot;short&quot;</span>);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;((it-&gt;G).front()));</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(it-&gt;energy));</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">calculateDFdc</a>(&amp;(dfdc.at(i).front()), &amp;(<a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>.front()));</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">calculateDFdc</a>(&amp;(dfdc.at(i).front()), &amp;(it-&gt;dGdxia.front()));</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dfdc.at(i).size(); ++j)</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;            dFdc.at(i).at(j) += dfdc.at(i).at(j);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">return</span> dFdc;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">nnp::NeuralNetwork::calculateDFdc()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia()</a>, <a class="el" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput()</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate()</a>, and <a class="el" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_abf466a175faf1511b305ed728042edb9_cgraph.png" border="0" usemap="#classnnp_1_1Training_abf466a175faf1511b305ed728042edb9_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_abf466a175faf1511b305ed728042edb9_cgraph" id="classnnp_1_1Training_abf466a175faf1511b305ed728042edb9_cgraph">
<area shape="rect" title="Calculate derivatives of force with respect to weights." alt="" coords="5,195,177,236"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161" title="Calculate &quot;second&quot; derivative of output with respect to connections." alt="" coords="262,5,414,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure." alt="" coords="225,71,451,112"/>
<area shape="rect" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure." alt="" coords="225,136,451,177"/>
<area shape="rect" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf" title="Collect derivative of symmetry functions with repect to one atom&#39;s coordinate." alt="" coords="236,202,440,229"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7" title="Get neural network output layer node values." alt="" coords="262,253,414,295"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2" title="Propagate input information through all layers." alt="" coords="262,319,414,360"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37" title="Set neural network input layer node values." alt="" coords="262,384,414,425"/>
</map>
</div>

</div>
</div>
<a id="a00f0177f326dacee6f7c5a1f7628e21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f0177f326dacee6f7c5a1f7628e21c">&#9670;&nbsp;</a></span>setTrainingLogFileName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setTrainingLogFileName </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set training log file name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>File name for training log. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02796">2796</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;{</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a> = fileName;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160; </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">trainingLogFileName</a>.</p>

</div>
</div>
<a id="a6c96bd09f7bae33a10ccca37cb655f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c96bd09f7bae33a10ccca37cb655f0e">&#9670;&nbsp;</a></span>advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Training::advance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if training loop should be continued. </p>
<dl class="section return"><dt>Returns</dt><dd>True if further training should be performed, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02803">2803</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;{</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a> &lt; <a class="code" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, and <a class="el" href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">numEpochs</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a6c96bd09f7bae33a10ccca37cb655f0e_icgraph.png" border="0" usemap="#classnnp_1_1Training_a6c96bd09f7bae33a10ccca37cb655f0e_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a6c96bd09f7bae33a10ccca37cb655f0e_icgraph" id="classnnp_1_1Training_a6c96bd09f7bae33a10ccca37cb655f0e_icgraph">
<area shape="rect" title="Check if training loop should be continued." alt="" coords="195,5,363,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<a id="a9e7a7553f60ebf30dbdfb8efc64b32c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e7a7553f60ebf30dbdfb8efc64b32c0">&#9670;&nbsp;</a></span>getWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::getWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get weights from neural network class. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02809">2809</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;{</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="keywordtype">size_t</span> pos = 0;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a> <span class="keyword">const</span>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a93e137591120925fe9ec70011385a972">getConnections</a>(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(0).at(pos)));</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            pos += nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">getNumConnections</a>();</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        }</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    }</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        {</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a> <span class="keyword">const</span>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a93e137591120925fe9ec70011385a972">getConnections</a>(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).front()));</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        }</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    }</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a93e137591120925fe9ec70011385a972">nnp::NeuralNetwork::getConnections()</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">nnp::NeuralNetwork::getNumConnections()</a>, <a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>, and <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ab2d9c91a092bdb9e8eac8441ccb09ef8">getSingleWeight()</a>, and <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_cgraph.png" border="0" usemap="#classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_cgraph" id="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_cgraph">
<area shape="rect" title="Get weights from neural network class." alt="" coords="5,46,192,73"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a93e137591120925fe9ec70011385a972" title="Get neural network weights and biases." alt="" coords="245,5,397,47"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050" title="Return total number of connections." alt="" coords="240,71,403,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_icgraph.png" border="0" usemap="#classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_icgraph" id="classnnp_1_1Training_a9e7a7553f60ebf30dbdfb8efc64b32c0_icgraph">
<area shape="rect" title="Get weights from neural network class." alt="" coords="253,42,440,69"/>
<area shape="rect" href="classnnp_1_1Training.html#ab2d9c91a092bdb9e8eac8441ccb09ef8" title="Get a single weight value." alt="" coords="18,5,193,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,71,205,98"/>
</map>
</div>

</div>
</div>
<a id="a82549ec0800f63ffaf830b46f865cdbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82549ec0800f63ffaf830b46f865cdbb">&#9670;&nbsp;</a></span>setWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set weights in neural network class. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02833">2833</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;{</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>)</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <span class="keywordtype">size_t</span> pos = 0;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">setConnections</a>(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(0).at(pos)));</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            pos += nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">getNumConnections</a>();</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a> == <a class="code" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>)</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(<a class="code" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">setConnections</a>(&amp;(<a class="code" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.at(i).front()));</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">nnp::NeuralNetwork::getNumConnections()</a>, <a class="el" href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnId</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">nnp::NeuralNetwork::setConnections()</a>, <a class="el" href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">updateStrategy</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">US_COMBINED</a>, <a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">US_ELEMENT</a>, and <a class="el" href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">weights</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#aaa4815462bd1b49907a9bce52eb2da43">setSingleWeight()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_cgraph.png" border="0" usemap="#classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_cgraph" id="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_cgraph">
<area shape="rect" title="Set weights in neural network class." alt="" coords="5,46,191,73"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050" title="Return total number of connections." alt="" coords="239,5,401,47"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868" title="Set neural network weights and biases." alt="" coords="244,71,396,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_icgraph.png" border="0" usemap="#classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_icgraph" id="classnnp_1_1Training_a82549ec0800f63ffaf830b46f865cdbb_icgraph">
<area shape="rect" title="Set weights in neural network class." alt="" coords="227,42,412,69"/>
<area shape="rect" href="classnnp_1_1Training.html#aaa4815462bd1b49907a9bce52eb2da43" title="Set a single weight value." alt="" coords="5,5,179,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="13,71,171,98"/>
</map>
</div>

</div>
</div>
<a id="a94e6d295200728de7780f6796b86593f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e6d295200728de7780f6796b86593f">&#9670;&nbsp;</a></span>addTrainingLogEntry() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::addTrainingLogEntry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>il</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>isg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write energy update data to training log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">proc</td><td>Processor which provided update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il</td><td>Loop index of threshold loop. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>RMSE fraction of update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is</td><td>Local structure index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isg</td><td>Global structure index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02858">2858</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;{</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keywordtype">string</span> s = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  E %5zu %10zu %5d %3zu %10.2E %10zu %5zu\n&quot;</span>,</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, proc, il + 1, f, isg, is);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a> &lt;&lt; s;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_cgraph.png" border="0" usemap="#classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_cgraph" id="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_cgraph">
<area shape="rect" title="Write energy update data to training log file." alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="241,13,325,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_icgraph.png" border="0" usemap="#classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_icgraph" id="classnnp_1_1Training_a94e6d295200728de7780f6796b86593f_icgraph">
<area shape="rect" title="Write energy update data to training log file." alt="" coords="212,5,400,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,13,164,39"/>
</map>
</div>

</div>
</div>
<a id="a74b44b3fdc51d3a16c6d0f8b13ec2f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b44b3fdc51d3a16c6d0f8b13ec2f1f">&#9670;&nbsp;</a></span>addTrainingLogEntry() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::addTrainingLogEntry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>il</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>isg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>ic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write force update data to training log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">proc</td><td>Processor which provided update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il</td><td>Loop index of threshold loop. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>RMSE fraction of update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is</td><td>Local structure index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isg</td><td>Global structure index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ic</td><td>Component index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02872">2872</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;{</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordtype">string</span> s = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  F %5zu %10zu %5d %3zu %10.2E %10zu %5zu %5zu %2zu\n&quot;</span>,</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, proc, il + 1, f, isg, is, ia, ic);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a> &lt;&lt; s;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160; </div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a74b44b3fdc51d3a16c6d0f8b13ec2f1f_cgraph.png" border="0" usemap="#classnnp_1_1Training_a74b44b3fdc51d3a16c6d0f8b13ec2f1f_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a74b44b3fdc51d3a16c6d0f8b13ec2f1f_cgraph" id="classnnp_1_1Training_a74b44b3fdc51d3a16c6d0f8b13ec2f1f_cgraph">
<area shape="rect" title="Write force update data to training log file." alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="241,13,325,39"/>
</map>
</div>

</div>
</div>
<a id="ac204d69eac864cb4286a0f26ddd8d048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac204d69eac864cb4286a0f26ddd8d048">&#9670;&nbsp;</a></span>addTrainingLogEntry() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::addTrainingLogEntry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>il</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>isg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>ia</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write charge update data to training log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">proc</td><td>Processor which provided update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il</td><td>Loop index of threshold loop. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>RMSE fraction of update candidate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is</td><td>Local structure index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isg</td><td>Global structure index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> index. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02888">2888</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;{</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordtype">string</span> s = <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  Q %5zu %10zu %5d %3zu %10.2E %10zu %5zu %5zu\n&quot;</span>,</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                     <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="code" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, proc, il + 1, f, isg, is, ia);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a> &lt;&lt; s;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">countUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">trainingLog</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_ac204d69eac864cb4286a0f26ddd8d048_cgraph.png" border="0" usemap="#classnnp_1_1Training_ac204d69eac864cb4286a0f26ddd8d048_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_ac204d69eac864cb4286a0f26ddd8d048_cgraph" id="classnnp_1_1Training_ac204d69eac864cb4286a0f26ddd8d048_cgraph">
<area shape="rect" title="Write charge update data to training log file." alt="" coords="5,5,193,47"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="241,13,325,39"/>
</map>
</div>

</div>
</div>
<a id="a80d3c7681f0727847d717ab7a333abbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80d3c7681f0727847d717ab7a333abbf">&#9670;&nbsp;</a></span>collectDGdxia()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::collectDGdxia </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>indexAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>indexComponent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect derivative of symmetry functions with repect to one atom's coordinate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">atom</td><td>The atom which owns the symmetry functions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indexAtom</td><td>The index \(i\) of the atom requested. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indexComponent</td><td>The component \(\alpha\) of the atom requested.</td></tr>
  </table>
  </dd>
</dl>
<p>This calculates an array of derivatives </p><p class="formulaDsp">
\[ \left(\frac{\partial G_1}{\partial x_{i,\alpha}}, \ldots, \frac{\partial G_n}{\partial x_{i,\alpha}}\right), \]
</p>
<p> where \(\{G_j\}_{j=1,\ldots,n}\) are the symmetry functions for this atom and \(x_{i,\alpha}\) is the \(\alpha\)-component of the position of atom \(i\). The result is stored in <a class="el" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62" title="Derivative of symmetry functions with respect to one specific atom coordinate.">dGdxia</a>. </p>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02903">2903</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;{</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordtype">size_t</span> <span class="keyword">const</span> nsf = atom.numSymmetryFunctions;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160; </div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="comment">// Reset dGdxia array.</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>.clear();</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    vector&lt;double&gt;(<a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>).swap(<a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>.resize(nsf, 0.0);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    vector&lt;vector&lt;size_t&gt; &gt; <span class="keyword">const</span>&amp; tableFull</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(atom.element).getSymmetryFunctionTable();</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; atom.numNeighbors; i++)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    {</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        <span class="keywordflow">if</span> (atom.neighbors[i].index == indexAtom)</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        {</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;            <a class="code" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a> <span class="keyword">const</span>&amp; n = atom.neighbors[i];</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;            vector&lt;size_t&gt; <span class="keyword">const</span>&amp; table = tableFull.at(n.<a class="code" href="structnnp_1_1Atom_1_1Neighbor.html#a3c0720664c09022328aeb7a676b1a266">element</a>);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n.<a class="code" href="structnnp_1_1Atom_1_1Neighbor.html#ace4770399203773624ab9c7db8db66d5">dGdr</a>.size(); ++j)</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;            {</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                <a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>[table.at(j)] += n.<a class="code" href="structnnp_1_1Atom_1_1Neighbor.html#ace4770399203773624ab9c7db8db66d5">dGdr</a>[j][indexComponent];</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;            }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    }</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <span class="keywordflow">if</span> (atom.index == indexAtom)</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    {</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nsf; ++i)</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>[i] += atom.dGdr[i][indexComponent];</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        }</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    }</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Atom_1_1Neighbor.html#ace4770399203773624ab9c7db8db66d5">nnp::Atom::Neighbor::dGdr</a>, <a class="el" href="structnnp_1_1Atom.html#a482ea8be24723a1a05012e4d405a60db">nnp::Atom::dGdr</a>, <a class="el" href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">dGdxia</a>, <a class="el" href="structnnp_1_1Atom_1_1Neighbor.html#a3c0720664c09022328aeb7a676b1a266">nnp::Atom::Neighbor::element</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="structnnp_1_1Atom.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a>, <a class="el" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="structnnp_1_1Atom.html#afebaaf27a0e6b30eab2f4cbc8c66d046">nnp::Atom::numNeighbors</a>, and <a class="el" href="structnnp_1_1Atom.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#abf466a175faf1511b305ed728042edb9">calculateWeightDerivatives()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a80d3c7681f0727847d717ab7a333abbf_icgraph.png" border="0" usemap="#classnnp_1_1Training_a80d3c7681f0727847d717ab7a333abbf_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a80d3c7681f0727847d717ab7a333abbf_icgraph" id="classnnp_1_1Training_a80d3c7681f0727847d717ab7a333abbf_icgraph">
<area shape="rect" title="Collect derivative of symmetry functions with repect to one atom&#39;s coordinate." alt="" coords="225,42,429,69"/>
<area shape="rect" href="classnnp_1_1Training.html#abf466a175faf1511b305ed728042edb9" title="Calculate derivatives of force with respect to weights." alt="" coords="5,5,177,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="12,71,171,98"/>
</map>
</div>

</div>
</div>
<a id="a111011beb9eb1fb43550139a615b2b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a111011beb9eb1fb43550139a615b2b39">&#9670;&nbsp;</a></span>randomizeNeuralNetworkWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::randomizeNeuralNetworkWeights </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Randomly initialize specificy neural network weights. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Actual network type to initialize ("short" or "charge"). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l02941">2941</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;{</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="keywordtype">string</span> keywordNW = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">if</span>      (type == <span class="stringliteral">&quot;short&quot;</span> ) keywordNW = <span class="stringliteral">&quot;nguyen_widrow_weights_short&quot;</span>;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;charge&quot;</span>) keywordNW = <span class="stringliteral">&quot;nguyen_widrow_weights_charge&quot;</span>;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown neural network type.\n&quot;</span>);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    }</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160; </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="keywordtype">double</span> minWeights = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;weights_min&quot;</span>].c_str());</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordtype">double</span> maxWeights = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;weights_max&quot;</span>].c_str());</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Initial weights selected randomly in interval &quot;</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                 <span class="stringliteral">&quot;[%f, %f).\n&quot;</span>, minWeights, maxWeights);</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    vector&lt;double&gt; w;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).neuralNetworks.at(type);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        w.resize(nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">getNumConnections</a>(), 0);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; w.size(); ++j)</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            w.at(j) = minWeights + gsl_rng_uniform(<a class="code" href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">rngGlobal</a>)</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                    * (maxWeights - minWeights);</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        }</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">setConnections</a>(&amp;(w.front()));</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    }</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keywordNW))</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    {</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Weights modified according to Nguyen Widrow scheme.\n&quot;</span>;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;             it != <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = it-&gt;neuralNetworks.at(type);</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7">modifyConnections</a>(<a class="code" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ade647e2d9f5c0d6f8f20d95df165c827">NeuralNetwork::MS_NGUYENWIDROW</a>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        }</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    }</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;precondition_weights&quot;</span>))</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    {</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Preconditioning of weights not yet&quot;</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                            <span class="stringliteral">&quot; implemented.\n&quot;</span>);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    }</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Weights modified accoring to Glorot Bengio scheme.\n&quot;</span>;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <span class="comment">//log &lt;&lt; &quot;Weights connected to output layer node set to zero.\n&quot;;</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Biases set to zero.\n&quot;</span>;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;             it != <a class="code" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        {</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;            <a class="code" href="classnnp_1_1NeuralNetwork.html">NeuralNetwork</a>&amp; nn = it-&gt;neuralNetworks.at(type);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7">modifyConnections</a>(<a class="code" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ab96a1476ad0c41c52f782708a82d7949">NeuralNetwork::MS_GLOROTBENGIO</a>);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;            <span class="comment">//nn-&gt;modifyConnections(NeuralNetwork::MS_ZEROOUTPUTWEIGHTS);</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;            nn.<a class="code" href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7">modifyConnections</a>(<a class="code" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1a66ae2f43aca0c9fbc5285c4b81e79bfa">NeuralNetwork::MS_ZEROBIAS</a>);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        }</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160; </div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">nnp::NeuralNetwork::getNumConnections()</a>, <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7">nnp::NeuralNetwork::modifyConnections()</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ab96a1476ad0c41c52f782708a82d7949">nnp::NeuralNetwork::MS_GLOROTBENGIO</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ade647e2d9f5c0d6f8f20d95df165c827">nnp::NeuralNetwork::MS_NGUYENWIDROW</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1a66ae2f43aca0c9fbc5285c4b81e79bfa">nnp::NeuralNetwork::MS_ZEROBIAS</a>, <a class="el" href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a>, <a class="el" href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">nnp::Dataset::rngGlobal</a>, <a class="el" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">nnp::NeuralNetwork::setConnections()</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ab3025fc3780b67e91e063fd490640043">initializeWeights()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_cgraph.png" border="0" usemap="#classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_cgraph" id="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_cgraph">
<area shape="rect" title="Randomly initialize specificy neural network weights." alt="" coords="5,123,188,164"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050" title="Return total number of connections." alt="" coords="259,5,422,47"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="236,71,445,98"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7" title="Change connections according to a given modification scheme." alt="" coords="263,123,418,164"/>
<area shape="rect" href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868" title="Set neural network weights and biases." alt="" coords="265,188,417,229"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="299,254,383,281"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_icgraph.png" border="0" usemap="#classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_icgraph" id="classnnp_1_1Training_a111011beb9eb1fb43550139a615b2b39_icgraph">
<area shape="rect" title="Randomly initialize specificy neural network weights." alt="" coords="223,5,405,47"/>
<area shape="rect" href="classnnp_1_1Training.html#ab3025fc3780b67e91e063fd490640043" title="Initialize weights for all elements." alt="" coords="5,5,175,47"/>
</map>
</div>

</div>
</div>
<a id="a5362ed9fa8992ca8ec88ab5c6daab978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5362ed9fa8992ca8ec88ab5c6daab978">&#9670;&nbsp;</a></span>setupSelectionMode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setupSelectionMode </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set selection mode for specific training property. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property (uses corresponding keyword). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l03000">3000</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;{</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordtype">bool</span> all = (<span class="keyword">property</span> == <span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordtype">bool</span> isProperty = (find(<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.begin(), <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end(), property) != <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end());</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="keywordflow">if</span> (!(all || isProperty))</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown property for selection mode&quot;</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                            <span class="stringliteral">&quot; setup.\n&quot;</span>);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160; </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="keywordflow">if</span> (all)</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;selection_mode&quot;</span>) ||</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;              <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;rmse_threshold&quot;</span>) ||</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;              <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;rmse_threshold_trials&quot;</span>))) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Global selection mode settings:\n&quot;</span>;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    }</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    {</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;selection_mode_&quot;</span> + property) ||</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;              <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;rmse_threshold_&quot;</span> + property) ||</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;              <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;rmse_threshold_trials_&quot;</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                                     + property))) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Selection mode settings specific to property \&quot;&quot;</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;            &lt;&lt; <span class="keyword">property</span> &lt;&lt; <span class="stringliteral">&quot;\&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordtype">string</span> keyword;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="keywordflow">if</span> (all) keyword = <span class="stringliteral">&quot;selection_mode&quot;</span>;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordflow">else</span> keyword = <span class="stringliteral">&quot;selection_mode_&quot;</span> + property;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160; </div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keyword))</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        map&lt;size_t, SelectionMode&gt; schedule;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        vector&lt;string&gt; args = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword]);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <span class="keywordflow">if</span> (args.size() % 2 != 1)</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        {</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Incorrect selection mode format.\n&quot;</span>);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        }</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        schedule[0] = (<a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">SelectionMode</a>)atoi(args.at(0).c_str());</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; args.size(); i = i + 2)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            schedule[(size_t)atoi(args.at(i).c_str())] =</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                (<a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">SelectionMode</a>)atoi(args.at(i + 1).c_str());</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;        }</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <span class="keywordflow">for</span> (map&lt;size_t, SelectionMode&gt;::const_iterator it = schedule.begin();</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;             it != schedule.end(); ++it)</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Selection mode starting with epoch %zu:\n&quot;</span>,</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                         it-&gt;first);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            <span class="keywordflow">if</span> (it-&gt;second == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>)</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            {</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  Random selection of update candidates: &quot;</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                             <span class="stringliteral">&quot;SelectionMode::SM_RANDOM (%d)\n&quot;</span>, it-&gt;second);</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;            }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it-&gt;second == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>)</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;            {</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  Update candidates selected according to error: &quot;</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;                             <span class="stringliteral">&quot;SelectionMode::SM_SORT (%d)\n&quot;</span>, it-&gt;second);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;            }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it-&gt;second == <a class="code" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>)</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;            {</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;  Update candidates chosen randomly above RMSE &quot;</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                             <span class="stringliteral">&quot;threshold: SelectionMode::SM_THRESHOLD (%d)\n&quot;</span>,</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                             it-&gt;second);</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;            }</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            {</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown selection mode.\n&quot;</span>);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            }</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        <span class="keywordflow">if</span> (all)</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        {</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; i : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>)</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            {</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                i.second.selectionModeSchedule = schedule;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                i.second.selectionMode = schedule[0];</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            }</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        {</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].selectionModeSchedule = schedule;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].selectionMode = schedule[0];</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        }</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    }</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="keywordflow">if</span> (all) keyword = <span class="stringliteral">&quot;rmse_threshold&quot;</span>;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="keywordflow">else</span> keyword = <span class="stringliteral">&quot;rmse_threshold_&quot;</span> + property;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keyword))</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    {</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;        <span class="keywordtype">double</span> t = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword].c_str());</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- RMSE selection threshold: %.2f * RMSE\n&quot;</span>, t);</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        <span class="keywordflow">if</span> (all) <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; i : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>) i.second.rmseThreshold = t;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].rmseThreshold = t;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="keywordflow">if</span> (all) keyword = <span class="stringliteral">&quot;rmse_threshold_trials&quot;</span>;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="keywordflow">else</span> keyword = <span class="stringliteral">&quot;rmse_threshold_trials_&quot;</span> + property;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keyword))</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    {</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        <span class="keywordtype">size_t</span> t = atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword].c_str());</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- RMSE selection trials   : %zu\n&quot;</span>, t);</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <span class="keywordflow">if</span> (all) <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; i : <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>) i.second.rmseThresholdTrials = t;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property].rmseThresholdTrials = t;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">SM_RANDOM</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">SM_SORT</a>, <a class="el" href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">SM_THRESHOLD</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_cgraph.png" border="0" usemap="#classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_cgraph" id="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_cgraph">
<area shape="rect" title="Set selection mode for specific training property." alt="" coords="5,56,251,83"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="299,5,508,32"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="362,56,445,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="361,107,445,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_icgraph.png" border="0" usemap="#classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_icgraph" id="classnnp_1_1Training_a5362ed9fa8992ca8ec88ab5c6daab978_icgraph">
<area shape="rect" title="Set selection mode for specific training property." alt="" coords="253,5,499,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a8a99d257e8c71aaf4dba65a1b9a1b5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a99d257e8c71aaf4dba65a1b9a1b5f1">&#9670;&nbsp;</a></span>setupFileOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setupFileOutput </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set file output intervals for properties and other quantities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property or <code>weights</code> or <code>neuron-stats</code>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l03108">3108</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;{</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keywordtype">string</span> keyword = <span class="stringliteral">&quot;write_&quot;</span>;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keywordtype">bool</span> isProperty = (find(<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.begin(), <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end(), type) != <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end());</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="keywordflow">if</span>      (type == <span class="stringliteral">&quot;energy&quot;</span>       ) keyword += <span class="stringliteral">&quot;trainpoints&quot;</span>;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;force&quot;</span>        ) keyword += <span class="stringliteral">&quot;trainforces&quot;</span>;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;charge&quot;</span>       ) keyword += <span class="stringliteral">&quot;traincharges&quot;</span>;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;weights_epoch&quot;</span>) keyword += type;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;neuronstats&quot;</span>  ) keyword += type;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Invalid type for file output setup.\n&quot;</span>);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    }</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160; </div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="comment">// Check how often energy comparison files should be written.</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keyword))</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keywordtype">size_t</span>* writeEvery = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="keywordtype">size_t</span>* writeAlways = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <span class="keywordtype">string</span> message;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="keywordflow">if</span> (isProperty)</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        {</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;            writeEvery = &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[type].writeCompEvery);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;            writeAlways = &amp;(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[type].writeCompAlways);</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;            message = <span class="stringliteral">&quot;Property \&quot;&quot;</span> + type + <span class="stringliteral">&quot;\&quot; comparison&quot;</span>;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;            message.at(0) = toupper(message.at(0));</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;weights_epoch&quot;</span>)</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        {</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;            writeEvery = &amp;<a class="code" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;            writeAlways = &amp;<a class="code" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a>;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;            message = <span class="stringliteral">&quot;Weight&quot;</span>;</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;neuronstats&quot;</span>)</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        {</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            writeEvery = &amp;<a class="code" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a>;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            writeAlways = &amp;<a class="code" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a>;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;            message = <span class="stringliteral">&quot;Neuron statistics&quot;</span>;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        *writeEvery = 1;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        vector&lt;string&gt; v = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword]));</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="keywordflow">if</span> (v.size() == 1) *writeEvery = (size_t)atoi(v.at(0).c_str());</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.size() == 2)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;            *writeEvery = (size_t)atoi(v.at(0).c_str());</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            *writeAlways = (size_t)atoi(v.at(1).c_str());</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;        }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>((message</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                      + <span class="stringliteral">&quot; files will be written every %zu epochs.\n&quot;</span>).c_str(),</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                     *writeEvery);</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">if</span> (*writeAlways &gt; 0)</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>((message</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                          + <span class="stringliteral">&quot; files will always be written up to epoch &quot;</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                            <span class="stringliteral">&quot;%zu.\n&quot;</span>).c_str(), *writeAlways);</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        }</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    }</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160; </div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce()</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">writeNeuronStatisticsAlways</a>, <a class="el" href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">writeNeuronStatisticsEvery</a>, <a class="el" href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">writeWeightsAlways</a>, and <a class="el" href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">writeWeightsEvery</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_cgraph.png" border="0" usemap="#classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_cgraph" id="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_cgraph">
<area shape="rect" title="Set file output intervals for properties and other quantities." alt="" coords="5,74,177,115"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="225,5,435,32"/>
<area shape="rect" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93" title="Replace multiple whitespaces with fill." alt="" coords="281,56,379,83"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="289,107,371,133"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="288,157,372,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_icgraph.png" border="0" usemap="#classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_icgraph" id="classnnp_1_1Training_a8a99d257e8c71aaf4dba65a1b9a1b5f1_icgraph">
<area shape="rect" title="Set file output intervals for properties and other quantities." alt="" coords="253,5,425,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,13,205,39"/>
</map>
</div>

</div>
</div>
<a id="afd6d1ab9f793927b8c1d5fa707922c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6d1ab9f793927b8c1d5fa707922c78">&#9670;&nbsp;</a></span>setupUpdatePlan()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::setupUpdatePlan </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set up how often properties are updated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property (uses corresponding keyword). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l03170">3170</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;{</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="keywordtype">bool</span> isProperty = (find(<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.begin(), <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end(), property) != <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end());</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">if</span> (!isProperty)</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown property for update plan&quot;</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                            <span class="stringliteral">&quot; setup.\n&quot;</span>);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    }</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160; </div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <span class="comment">// Actual property modified here.</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    Property&amp; pa = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property];</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <span class="keywordtype">string</span> keyword = <span class="keyword">property</span> + <span class="stringliteral">&quot;_fraction&quot;</span>;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <span class="comment">// Override force fraction if keyword &quot;energy_force_ratio&quot; is provided.</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;force&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>.<a class="code" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">exists</a>(<span class="stringliteral">&quot;energy&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(<span class="stringliteral">&quot;force_energy_ratio&quot;</span>))</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    {</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keywordtype">double</span> <span class="keyword">const</span> ratio = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;force_energy_ratio&quot;</span>].c_str());</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">keywordExists</a>(keyword))</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        {</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Given force fraction is ignored because &quot;</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                   <span class="stringliteral">&quot;force/energy ratio is provided.\n&quot;</span>;</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        }</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Desired force/energy update ratio              : %.6f\n&quot;</span>,</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                     ratio);</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        pa.epochFraction = (<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[<span class="stringliteral">&quot;energy&quot;</span>].numTrainPatterns * ratio)</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;                         / <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[<span class="stringliteral">&quot;force&quot;</span>].numTrainPatterns;</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <span class="comment">// Default action = read &quot;&lt;property&gt;_fraction&quot; keyword.</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    {</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        pa.epochFraction = atof(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword].c_str());</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    }</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160; </div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    keyword = <span class="stringliteral">&quot;task_batch_size_&quot;</span> + property;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    pa.taskBatchSize = (size_t)atoi(<a class="code" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[keyword].c_str());</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <span class="keywordflow">if</span> (pa.taskBatchSize == 0)</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        pa.patternsPerUpdate =</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pa.updateCandidates.size() * pa.epochFraction);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        pa.numUpdates = 1;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        pa.patternsPerUpdate = pa.taskBatchSize;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        pa.numUpdates =</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>((pa.numTrainPatterns * pa.epochFraction)</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                                / pa.taskBatchSize / <a class="code" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a>);</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    pa.patternsPerUpdateGlobal = pa.patternsPerUpdate;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;(pa.patternsPerUpdateGlobal), 1, <a class="code" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, MPI_SUM, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    pa.errorsPerTask.resize(<a class="code" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a>, 0);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    {</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        pa.errorsPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>) = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pa.patternsPerUpdate);</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    }</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        pa.errorsPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>) = 1;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    }</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    MPI_Allgather(MPI_IN_PLACE, 1, MPI_INT, &amp;(pa.errorsPerTask.front()), 1, MPI_INT, <a class="code" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">comm</a>);</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> == <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    {</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        pa.weightsPerTask.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        {</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            pa.weightsPerTask.at(i).resize(<a class="code" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a>, 0);</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">numProcs</a>; ++j)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;            {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                pa.weightsPerTask.at(i).at(j) = pa.errorsPerTask.at(j)</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                                              * <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i);</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;            }</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        }</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    }</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    pa.numErrorsGlobal = 0;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; pa.errorsPerTask.size(); ++i)</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        pa.offsetPerTask.push_back(pa.numErrorsGlobal);</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        pa.numErrorsGlobal += pa.errorsPerTask.at(i);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    pa.offsetJacobian.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; pa.offsetPerTask.size(); ++j)</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;        {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            pa.offsetJacobian.at(i).push_back(pa.offsetPerTask.at(j) *</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                                              <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i));</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        }</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    }</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Update plan for property \&quot;&quot;</span> + <span class="keyword">property</span> + <span class="stringliteral">&quot;\&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Per-task batch size                          : %zu\n&quot;</span>,</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                 pa.taskBatchSize);</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Fraction of patterns used per epoch          : %.6f\n&quot;</span>,</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                 pa.epochFraction);</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="keywordflow">if</span> (pa.numUpdates == 0)</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    {</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: No updates are planned for this property.&quot;</span>;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    }</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Updates per epoch                            : %zu\n&quot;</span>,</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                 pa.numUpdates);</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- Patterns used per update (rank %3d / global) : &quot;</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                 <span class="stringliteral">&quot;%10zu / %zu\n&quot;</span>,</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;                 <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>, pa.patternsPerUpdate, pa.patternsPerUpdateGlobal);</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160; </div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a4fcb8f00175cafcb10a2024b69154c57">nnp::Training::Property::epochFraction</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a237fdc1c832aebec499d03095e72f409">nnp::Training::Property::errorsPerTask</a>, <a class="el" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">nnp::Training::PropertyMap::exists()</a>, <a class="el" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">JM_FULL</a>, <a class="el" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists()</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a0c16f83405eca4c233dfb9bf0008a9f9">nnp::Training::Property::numErrorsGlobal</a>, <a class="el" href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">nnp::Dataset::numProcs</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a19c5f6057a4c916892268a16bc0a97f5">nnp::Training::Property::numTrainPatterns</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a4617cc6dde93700e2a722b856ef5af91">nnp::Training::Property::numUpdates</a>, <a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a7c7b1a154236e7778ca8846a3f95e2d8">nnp::Training::Property::offsetJacobian</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#aac52bd2258c7f7b53133d425fb1c94f9">nnp::Training::Property::offsetPerTask</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a54c2a8fc1d0aa231de78393cca59c213">nnp::Training::Property::patternsPerUpdate</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#ad882355197f0566544af7a65fb6d6d3f">nnp::Training::Property::patternsPerUpdateGlobal</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a61d413cda5e23ae4a0a6398aec99d7bf">nnp::Training::Property::taskBatchSize</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#ab02367acc5fadb9ffe9cac2f8dd1f0c3">nnp::Training::Property::updateCandidates</a>, and <a class="el" href="structnnp_1_1Training_1_1Property.html#a9c1498b6d1ba640b41701ee752010128">nnp::Training::Property::weightsPerTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_cgraph.png" border="0" usemap="#classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_cgraph" id="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_cgraph">
<area shape="rect" title="Set up how often properties are updated." alt="" coords="5,71,229,98"/>
<area shape="rect" href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4" title="Check if property is present." alt="" coords="284,5,480,47"/>
<area shape="rect" href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc" title="Check if keyword is present in settings file." alt="" coords="277,71,487,98"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="340,122,424,149"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_icgraph.png" border="0" usemap="#classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_icgraph" id="classnnp_1_1Training_afd6d1ab9f793927b8c1d5fa707922c78_icgraph">
<area shape="rect" title="Set up how often properties are updated." alt="" coords="253,5,477,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a33e73c163ea6a69fc0d87acd735fd9e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33e73c163ea6a69fc0d87acd735fd9e7">&#9670;&nbsp;</a></span>allocateArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::allocateArrays </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate error and Jacobian arrays for given property. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> property. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l03280">3280</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;{</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    <span class="keywordtype">bool</span> isProperty = (find(<a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.begin(), <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end(), property) != <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>.end());</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;    <span class="keywordflow">if</span> (!isProperty)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown property for array allocation.\n&quot;</span>);</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160; </div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Allocating memory for &quot;</span> + <span class="keyword">property</span> +</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;           <span class="stringliteral">&quot; error vector and Jacobian.\n&quot;</span>;</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    Property&amp; pa = <a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[property];</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    pa.error.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    pa.jacobian.resize(<a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>);</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>; ++i)</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    {</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        <span class="keywordtype">size_t</span> size = 1;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <span class="keywordflow">if</span> (( <a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a> ||</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;              (<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a> &amp;&amp; <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> == 0)) &amp;&amp;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;            <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> != <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        {</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            size *= pa.numErrorsGlobal;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        }</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a> == <a class="code" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a> &amp;&amp; <a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                 <a class="code" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a> != <a class="code" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>)</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;        {</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            size *= pa.errorsPerTask.at(<a class="code" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">myRank</a>);</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        }</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        pa.error.at(i).resize(size, 0.0);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        pa.jacobian.at(i).resize(size * <a class="code" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>.at(i), 0.0);</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Updater %3zu:\n&quot;</span>, i);</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; - Error    size: %zu\n&quot;</span>, pa.error.at(i).size());</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; - Jacobian size: %zu\n&quot;</span>, pa.jacobian.at(i).size());</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    }</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <a class="code" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------\n&quot;</span>;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; </div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Training_1_1Property.html#a66fa78822af01cac13621484af8b583b">nnp::Training::Property::error</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a237fdc1c832aebec499d03095e72f409">nnp::Training::Property::errorsPerTask</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#abb61edfe4a242cd6cd1a1e6a6dc44892">nnp::Training::Property::jacobian</a>, <a class="el" href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">jacobianMode</a>, <a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">JM_SUM</a>, <a class="el" href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a>, <a class="el" href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a>, <a class="el" href="structnnp_1_1Training_1_1Property.html#a0c16f83405eca4c233dfb9bf0008a9f9">nnp::Training::Property::numErrorsGlobal</a>, <a class="el" href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">numUpdaters</a>, <a class="el" href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">numWeightsPerUpdater</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">parallelMode</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">PM_TRAIN_ALL</a>, <a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">PM_TRAIN_RK0</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_cgraph.png" border="0" usemap="#classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_cgraph" id="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_cgraph">
<area shape="rect" title="Allocate error and Jacobian arrays for given property." alt="" coords="5,5,212,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="260,5,344,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_icgraph.png" border="0" usemap="#classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_icgraph" id="classnnp_1_1Training_a33e73c163ea6a69fc0d87acd735fd9e7_icgraph">
<area shape="rect" title="Allocate error and Jacobian arrays for given property." alt="" coords="253,5,460,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451" title="General training settings and setup of weight update routine." alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a9920793c17beef42f87017464599f464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9920793c17beef42f87017464599f464">&#9670;&nbsp;</a></span>writeTimingData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Training::writeTimingData </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;timing.out&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write timing data for all clocks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>If true, append to file, otherwise create new file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>File name for timing data file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Training_8cpp_source.html#l03318">3318</a> of file <a class="el" href="Training_8cpp_source.html">Training.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;{</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    ofstream file;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keywordtype">string</span> fileNameActual = fileName;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnpType</a> == <a class="code" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">NNPType::SHORT_CHARGE_NN</a>)</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    {</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;        fileNameActual += <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;.stage-%zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>);</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    }</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160; </div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    vector&lt;string&gt; sub = {<span class="stringliteral">&quot;_err&quot;</span>, <span class="stringliteral">&quot;_com&quot;</span>, <span class="stringliteral">&quot;_upd&quot;</span>, <span class="stringliteral">&quot;_log&quot;</span>};</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="keywordflow">if</span> (append) file.open(fileNameActual.c_str(), ofstream::app);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    {</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        file.open(fileNameActual.c_str());</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        <span class="comment">// File header.</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        vector&lt;string&gt; title;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        vector&lt;string&gt; colName;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        vector&lt;string&gt; colInfo;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        vector&lt;size_t&gt; colSize;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        title.push_back(<span class="stringliteral">&quot;Timing data for training loop.&quot;</span>);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        colSize.push_back(10);</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        colName.push_back(<span class="stringliteral">&quot;epoch&quot;</span>);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Current epoch.&quot;</span>);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;        colSize.push_back(11);</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        colName.push_back(<span class="stringliteral">&quot;train&quot;</span>);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Time for training.&quot;</span>);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        colSize.push_back(7);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        colName.push_back(<span class="stringliteral">&quot;ptrain&quot;</span>);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Time for training (percentage of loop).&quot;</span>);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        colSize.push_back(11);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        colName.push_back(<span class="stringliteral">&quot;error&quot;</span>);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Time for error calculation.&quot;</span>);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        colSize.push_back(7);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        colName.push_back(<span class="stringliteral">&quot;perror&quot;</span>);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Time for error calculation (percentage of loop).&quot;</span>);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        colSize.push_back(11);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        colName.push_back(<span class="stringliteral">&quot;epoch&quot;</span>);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Time for this epoch.&quot;</span>);</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        colSize.push_back(11);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        colName.push_back(<span class="stringliteral">&quot;total&quot;</span>);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        colInfo.push_back(<span class="stringliteral">&quot;Total time for all epochs.&quot;</span>);</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        {</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;            colSize.push_back(11);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;            colName.push_back(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;train&quot;</span>);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;            colInfo.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;            colSize.push_back(7);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            colName.push_back(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;ptrain&quot;</span>);</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;            colInfo.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        }</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : sub)</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        {</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            {</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                colSize.push_back(11);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                colName.push_back(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + s);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                colSize.push_back(7);</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                colName.push_back(<a class="code" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>[k].tiny + <span class="stringliteral">&quot;p&quot;</span> + s);</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                colInfo.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;            }</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        }</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        <a class="code" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">appendLinesToFile</a>(file,</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                          <a class="code" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">createFileHeader</a>(title, colSize, colName, colInfo));</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    }</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160; </div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keywordtype">double</span> timeLoop = <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getLoop();</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%10zu&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>);</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop());</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %7.3f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop() / timeLoop);</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].getLoop());</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %7.3f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;error&quot;</span>].getLoop() / timeLoop);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, timeLoop);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;loop&quot;</span>].getTotal());</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160; </div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    {</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].getLoop());</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %7.3f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].getLoop() / <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[<span class="stringliteral">&quot;train&quot;</span>].getLoop());</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    }</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : sub)</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    {</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> k : <a class="code" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>)</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        {</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %11.3E&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + s].getLoop());</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            file &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %7.3f&quot;</span>, <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k + s].getLoop() / <a class="code" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>[k].getLoop());</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160; </div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    file.flush();</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    file.close();</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160; </div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile()</a>, <a class="el" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader()</a>, <a class="el" href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">epoch</a>, <a class="el" href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a>, <a class="el" href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">p</a>, <a class="el" href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">pk</a>, <a class="el" href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::SHORT_CHARGE_NN</a>, <a class="el" href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">stage</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">sw</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a9920793c17beef42f87017464599f464_cgraph.png" border="0" usemap="#classnnp_1_1Training_a9920793c17beef42f87017464599f464_cgraph" alt=""/></div>
<map name="classnnp_1_1Training_a9920793c17beef42f87017464599f464_cgraph" id="classnnp_1_1Training_a9920793c17beef42f87017464599f464_cgraph">
<area shape="rect" title="Write timing data for all clocks." alt="" coords="5,56,228,83"/>
<area shape="rect" href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866" title="Append multiple lines of strings to open file stream." alt="" coords="276,5,449,32"/>
<area shape="rect" href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570" title=" " alt="" coords="280,56,445,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="321,107,405,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnnp_1_1Training_a9920793c17beef42f87017464599f464_icgraph.png" border="0" usemap="#classnnp_1_1Training_a9920793c17beef42f87017464599f464_icgraph" alt=""/></div>
<map name="classnnp_1_1Training_a9920793c17beef42f87017464599f464_icgraph" id="classnnp_1_1Training_a9920793c17beef42f87017464599f464_icgraph">
<area shape="rect" title="Write timing data for all clocks." alt="" coords="195,5,417,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167" title="Execute main training loop." alt="" coords="5,5,147,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a03f9d45ef8680c15e578906298a1b891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f9d45ef8680c15e578906298a1b891">&#9670;&nbsp;</a></span>updaterType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">UpdaterType</a> nnp::Training::updaterType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classnnp_1_1Updater.html" title="Base class for different weight update methods.">Updater</a> type used. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00406">406</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, and <a class="el" href="classnnp_1_1Training.html#a6db6a1a9302641ca0d74308e583667af">~Training()</a>.</p>

</div>
</div>
<a id="ac2bec3d1ad183e620687bf41ede6f5ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2bec3d1ad183e620687bf41ede6f5ad">&#9670;&nbsp;</a></span>parallelMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">ParallelMode</a> nnp::Training::parallelMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parallelization mode used. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00408">408</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a3fa8fc039bdb2b4a083433fd56507f14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa8fc039bdb2b4a083433fd56507f14">&#9670;&nbsp;</a></span>jacobianMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">JacobianMode</a> nnp::Training::jacobianMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Jacobian mode used. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00410">410</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="ab9949593aada759d082eae33a3da04c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9949593aada759d082eae33a3da04c8">&#9670;&nbsp;</a></span>updateStrategy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">UpdateStrategy</a> nnp::Training::updateStrategy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update strategy used. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00412">412</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights()</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, and <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>.</p>

</div>
</div>
<a id="a3c709ea24c0cb6ea3bfdaaae6efd2202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c709ea24c0cb6ea3bfdaaae6efd2202">&#9670;&nbsp;</a></span>hasUpdaters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::hasUpdaters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If this rank performs weight updates. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00414">414</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="aeee2583a1323180d235f16717111f39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee2583a1323180d235f16717111f39e">&#9670;&nbsp;</a></span>hasStructures</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::hasStructures</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If this rank holds structure information. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00416">416</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">selectSets()</a>.</p>

</div>
</div>
<a id="a178647e7ce5eca9f6bb7cc4c371909f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a178647e7ce5eca9f6bb7cc4c371909f3">&#9670;&nbsp;</a></span>useForces</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::useForces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use forces for training. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00418">418</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError()</a>, and <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="ab8e2ffef22c4331c2892ddbd01436ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e2ffef22c4331c2892ddbd01436ec6">&#9670;&nbsp;</a></span>repeatedEnergyUpdates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::repeatedEnergyUpdates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>After force update perform energy update for corresponding structure. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00420">420</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="af4986e0d008729499003bdf5d2ff59e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4986e0d008729499003bdf5d2ff59e6">&#9670;&nbsp;</a></span>freeMemory</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::freeMemory</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Free symmetry function memory after calculation. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00422">422</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a671f1f45d0b277daec4da583d0f9ce7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a671f1f45d0b277daec4da583d0f9ce7b">&#9670;&nbsp;</a></span>writeTrainingLog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Training::writeTrainingLog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether training log file is written. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00424">424</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a7d44c6d46a17bc5a5f85898c2a70d348"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d44c6d46a17bc5a5f85898c2a70d348">&#9670;&nbsp;</a></span>stage</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::stage</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> stage. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00426">426</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a664dec664ebd703206f7c515bf3e96f0">dataSetNormalization()</a>, <a class="el" href="classnnp_1_1Training.html#ab3025fc3780b67e91e063fd490640043">initializeWeights()</a>, <a class="el" href="classnnp_1_1Training.html#afbdd4d56bb0290e139382bdfba070c2a">setStage()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve()</a>, <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>, <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>

</div>
</div>
<a id="a68e80f07031867155a7fbc4f480a2bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e80f07031867155a7fbc4f480a2bd0">&#9670;&nbsp;</a></span>numUpdaters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::numUpdaters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of updaters (depends on update strategy). </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00428">428</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, and <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>.</p>

</div>
</div>
<a id="a8a30db3b7747df34b72d89cdfb791eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a30db3b7747df34b72d89cdfb791eb0">&#9670;&nbsp;</a></span>numEpochs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::numEpochs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of epochs requested. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00430">430</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">advance()</a>, and <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="a08b98e274dffce06459a1c29a05e90a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b98e274dffce06459a1c29a05e90a7">&#9670;&nbsp;</a></span>epoch</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::epoch</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current epoch. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00432">432</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry()</a>, <a class="el" href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">advance()</a>, <a class="el" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve()</a>, <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>, <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>

</div>
</div>
<a id="a2a5d0fda76e8e10fd700405323bd9713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a5d0fda76e8e10fd700405323bd9713">&#9670;&nbsp;</a></span>writeWeightsEvery</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::writeWeightsEvery</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write weights every this many epochs. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00434">434</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>

</div>
</div>
<a id="a103de589f43d89513b741cea0bdbf541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103de589f43d89513b741cea0bdbf541">&#9670;&nbsp;</a></span>writeWeightsAlways</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::writeWeightsAlways</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Up to this epoch weights are written every epoch. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00436">436</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, and <a class="el" href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">writeWeightsEpoch()</a>.</p>

</div>
</div>
<a id="a9be53bf5fcdbefa900c9c7f8a8a6bb40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be53bf5fcdbefa900c9c7f8a8a6bb40">&#9670;&nbsp;</a></span>writeNeuronStatisticsEvery</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::writeNeuronStatisticsEvery</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write neuron statistics every this many epochs. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00438">438</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, and <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>.</p>

</div>
</div>
<a id="a61a21e51fe6761fe3a3a44533d70603d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a21e51fe6761fe3a3a44533d70603d">&#9670;&nbsp;</a></span>writeNeuronStatisticsAlways</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::writeNeuronStatisticsAlways</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Up to this epoch neuron statistics are written every epoch. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00440">440</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, and <a class="el" href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">writeNeuronStatisticsEpoch()</a>.</p>

</div>
</div>
<a id="a4daf50292f3efe2614a473be9ab1192f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4daf50292f3efe2614a473be9ab1192f">&#9670;&nbsp;</a></span>countUpdates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::countUpdates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update counter (for all training quantities together). </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00442">442</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry()</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a14ce267846960e602130171ebd485763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ce267846960e602130171ebd485763">&#9670;&nbsp;</a></span>numWeights</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Training::numWeights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of weights. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00444">444</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>.</p>

</div>
</div>
<a id="a63a1bb27c4a92c6a504588e4ace64892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63a1bb27c4a92c6a504588e4ace64892">&#9670;&nbsp;</a></span>forceWeight</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Training::forceWeight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Force update weight. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00446">446</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a3f209dcaac73586a0ebb0ea92680ee3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f209dcaac73586a0ebb0ea92680ee3e">&#9670;&nbsp;</a></span>trainingLogFileName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string nnp::Training::trainingLogFileName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>File name for training log. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00448">448</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a00f0177f326dacee6f7c5a1f7628e21c">setTrainingLogFileName()</a>, and <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="a2e7318a8dd101bc306d3ff449fca7373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e7318a8dd101bc306d3ff449fca7373">&#9670;&nbsp;</a></span>nnId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string nnp::Training::nnId</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ID of neural network the training is working on. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00450">450</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights()</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a385a420ca6f05019c349d0ca5d6bf10b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a385a420ca6f05019c349d0ca5d6bf10b">&#9670;&nbsp;</a></span>trainingLog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream nnp::Training::trainingLog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classnnp_1_1Training.html" title="Training methods.">Training</a> log file. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00452">452</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">addTrainingLogEntry()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#a6db6a1a9302641ca0d74308e583667af">~Training()</a>.</p>

</div>
</div>
<a id="ad3842dd2ab00d29da9d3b2e0ada174dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3842dd2ab00d29da9d3b2e0ada174dc">&#9670;&nbsp;</a></span>epochSchedule</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; nnp::Training::epochSchedule</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update schedule epoch (false = energy update, true = force update). </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00454">454</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>, and <a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule()</a>.</p>

</div>
</div>
<a id="a0e62e59b28ba068d154856c16219e93b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e62e59b28ba068d154856c16219e93b">&#9670;&nbsp;</a></span>numWeightsPerUpdater</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::size_t&gt; nnp::Training::numWeightsPerUpdater</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of weights per updater. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00456">456</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a8745838265af0e0436fc024d0c80de74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8745838265af0e0436fc024d0c80de74">&#9670;&nbsp;</a></span>weightsOffset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::size_t&gt; nnp::Training::weightsOffset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Offset of each element's weights in combined array. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00458">458</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="aed44026c9d76b19022856e1e82cad8bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed44026c9d76b19022856e1e82cad8bb">&#9670;&nbsp;</a></span>pk</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; nnp::Training::pk</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of actually used training properties. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00460">460</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError()</a>, <a class="el" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">printHeader()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">selectSets()</a>, <a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule()</a>, <a class="el" href="classnnp_1_1Training.html#afbdd4d56bb0290e139382bdfba070c2a">setStage()</a>, <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, <a class="el" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, <a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve()</a>, and <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>.</p>

</div>
</div>
<a id="a040f4feb5130b36ba185f437e6999a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a040f4feb5130b36ba185f437e6999a62">&#9670;&nbsp;</a></span>dGdxia</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; nnp::Training::dGdxia</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derivative of symmetry functions with respect to one specific atom coordinate. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00464">464</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#abf466a175faf1511b305ed728042edb9">calculateWeightDerivatives()</a>, <a class="el" href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">collectDGdxia()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="af28c4111f0f053fbccb6b072b47c6fea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af28c4111f0f053fbccb6b072b47c6fea">&#9670;&nbsp;</a></span>weights</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;double&gt; &gt; nnp::Training::weights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Neural network weights and biases for each element. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00468">468</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ab2d9c91a092bdb9e8eac8441ccb09ef8">getSingleWeight()</a>, <a class="el" href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">getWeights()</a>, <a class="el" href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">initializeWeightsMemory()</a>, <a class="el" href="classnnp_1_1Training.html#aaa4815462bd1b49907a9bce52eb2da43">setSingleWeight()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">setWeights()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>.</p>

</div>
</div>
<a id="a5f4d6996721dd95776b851d73ee77b7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f4d6996721dd95776b851d73ee77b7a">&#9670;&nbsp;</a></span>updaters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classnnp_1_1Updater.html">Updater</a>*&gt; nnp::Training::updaters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Weight updater (combined or for each element). </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00470">470</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, <a class="el" href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">writeUpdaterStatus()</a>, and <a class="el" href="classnnp_1_1Training.html#a6db6a1a9302641ca0d74308e583667af">~Training()</a>.</p>

</div>
</div>
<a id="a53248fb2d903d54fd37a26eca5c51b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53248fb2d903d54fd37a26eca5c51b5e">&#9670;&nbsp;</a></span>sw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::string, <a class="el" href="classnnp_1_1Stopwatch.html">Stopwatch</a>&gt; nnp::Training::sw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stopwatches for timing overview. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00473">473</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#ac0de14f9b249aa70a7648c7c3c1cc783">calculateNeighborLists()</a>, <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#af98b1bc7ed710e2fa008a72ad29dbdae">Training()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, and <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>.</p>

</div>
</div>
<a id="a5cbda69cd1b2ff7705263726577e79dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cbda69cd1b2ff7705263726577e79dd">&#9670;&nbsp;</a></span>rngNew</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mt19937_64 nnp::Training::rngNew</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Per-task random number generator. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00475">475</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, and <a class="el" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">shuffleUpdateCandidates()</a>.</p>

</div>
</div>
<a id="a2b71003bb978998c82e9cbefd454f242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b71003bb978998c82e9cbefd454f242">&#9670;&nbsp;</a></span>rngGlobalNew</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mt19937_64 nnp::Training::rngGlobalNew</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global random number generator. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00477">477</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule()</a>, and <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>.</p>

</div>
</div>
<a id="a5ef4b4d51191c4c67be8dc39c7bfd3ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ef4b4d51191c4c67be8dc39c7bfd3ed">&#9670;&nbsp;</a></span>p</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Training_1_1PropertyMap.html">PropertyMap</a> nnp::Training::p</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actual training properties. </p>

<p class="definition">Definition at line <a class="el" href="Training_8h_source.html#l00479">479</a> of file <a class="el" href="Training_8h_source.html">Training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">allocateArrays()</a>, <a class="el" href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">calculateError()</a>, <a class="el" href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">calculateErrorEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">checkSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a84e2af12e3007a2f9955630cd27a0167">loop()</a>, <a class="el" href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">printEpoch()</a>, <a class="el" href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">printHeader()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">selectSets()</a>, <a class="el" href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">setEpochSchedule()</a>, <a class="el" href="classnnp_1_1Training.html#afbdd4d56bb0290e139382bdfba070c2a">setStage()</a>, <a class="el" href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">setupFileOutput()</a>, <a class="el" href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">setupSelectionMode()</a>, <a class="el" href="classnnp_1_1Training.html#a2b2b016d87bcea95f460b8a2ae93b451">setupTraining()</a>, <a class="el" href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">setupUpdatePlan()</a>, <a class="el" href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">shuffleUpdateCandidates()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">sortUpdateCandidates()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">update()</a>, <a class="el" href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">writeLearningCurve()</a>, and <a class="el" href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">writeTimingData()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/n2p2/n2p2/src/libnnptrain/<a class="el" href="Training_8h_source.html">Training.h</a></li>
<li>/home/runner/work/n2p2/n2p2/src/libnnptrain/<a class="el" href="Training_8cpp_source.html">Training.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassnnp_1_1Mode_html_af1d1548ef2d6a9bbfdc519b76b904700"><div class="ttname"><a href="classnnp_1_1Mode.html#af1d1548ef2d6a9bbfdc519b76b904700">nnp::Mode::setupSymmetryFunctionMemory</a></div><div class="ttdeci">void setupSymmetryFunctionMemory(bool verbose=false)</div><div class="ttdoc">Extract required memory dimensions for symmetry function derivatives.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00714">Mode.cpp:714</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ae4ccff5ae694d46c03cae84aa7ae696d"><div class="ttname"><a href="classnnp_1_1Training.html#ae4ccff5ae694d46c03cae84aa7ae696d">nnp::Training::writeLearningCurve</a></div><div class="ttdeci">void writeLearningCurve(bool append, std::string const fileName=&quot;learning-curve.out&quot;) const</div><div class="ttdoc">Write current RMSEs and epoch information to file.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01549">Training.cpp:1549</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a3fa8fc039bdb2b4a083433fd56507f14"><div class="ttname"><a href="classnnp_1_1Training.html#a3fa8fc039bdb2b4a083433fd56507f14">nnp::Training::jacobianMode</a></div><div class="ttdeci">JacobianMode jacobianMode</div><div class="ttdoc">Jacobian mode used.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00410">Training.h:410</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a63a1bb27c4a92c6a504588e4ace64892"><div class="ttname"><a href="classnnp_1_1Training.html#a63a1bb27c4a92c6a504588e4ace64892">nnp::Training::forceWeight</a></div><div class="ttdeci">double forceWeight</div><div class="ttdoc">Force update weight.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00446">Training.h:446</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a9a0f3518c376324d41786e29a7b5300d"><div class="ttname"><a href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">nnp::Structure::freeAtoms</a></div><div class="ttdeci">void freeAtoms(bool all)</div><div class="ttdoc">Free symmetry function memory for all atoms, see free() in Atom class.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00513">Structure.cpp:513</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414"><div class="ttname"><a href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca01eabbe614bf6650277a9f473dc4f414">nnp::Mode::NNPType::SHORT_CHARGE_NN</a></div><div class="ttdeci">@ SHORT_CHARGE_NN</div><div class="ttdoc">Short range NNP with additional charge NN (M. Bircher).</div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd"><div class="ttname"><a href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa158efa3ab967d65d8574555d24e6fefd">nnp::Training::JM_SUM</a></div><div class="ttdeci">@ JM_SUM</div><div class="ttdoc">No Jacobian, sum up contributions from update candidates.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00087">Training.h:87</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a6c96bd09f7bae33a10ccca37cb655f0e"><div class="ttname"><a href="classnnp_1_1Training.html#a6c96bd09f7bae33a10ccca37cb655f0e">nnp::Training::advance</a></div><div class="ttdeci">bool advance() const</div><div class="ttdoc">Check if training loop should be continued.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02803">Training.cpp:2803</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a03f9d45ef8680c15e578906298a1b891"><div class="ttname"><a href="classnnp_1_1Training.html#a03f9d45ef8680c15e578906298a1b891">nnp::Training::updaterType</a></div><div class="ttdeci">UpdaterType updaterType</div><div class="ttdoc">Updater type used.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00406">Training.h:406</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_a8ef6e31fa3d3e6a0261ec2006e6c963aac400ef737d94b7dfcc280f37f76dbf38"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aac400ef737d94b7dfcc280f37f76dbf38">nnp::KalmanFilter::KT_FADINGMEMORY</a></div><div class="ttdeci">@ KT_FADINGMEMORY</div><div class="ttdoc">Kalman filtering with fading memory modification.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8h_source.html#l00040">KalmanFilter.h:40</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_afd6d1ab9f793927b8c1d5fa707922c78"><div class="ttname"><a href="classnnp_1_1Training.html#afd6d1ab9f793927b8c1d5fa707922c78">nnp::Training::setupUpdatePlan</a></div><div class="ttdeci">void setupUpdatePlan(std::string const &amp;property)</div><div class="ttdoc">Set up how often properties are updated.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l03170">Training.cpp:3170</a></div></div>
<div class="ttc" id="anamespacennp_html_aaa30280456ea59152f9e6c240f41ea93"><div class="ttname"><a href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00060">utility.cpp:60</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a9d2a2d332c23876935e3a3272f40f5c2"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate</a></div><div class="ttdeci">void propagate()</div><div class="ttdoc">Propagate input information through all layers.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00384">NeuralNetwork.cpp:384</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ab9949593aada759d082eae33a3da04c8"><div class="ttname"><a href="classnnp_1_1Training.html#ab9949593aada759d082eae33a3da04c8">nnp::Training::updateStrategy</a></div><div class="ttdeci">UpdateStrategy updateStrategy</div><div class="ttdoc">Update strategy used.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00412">Training.h:412</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_af600a10225c7035afa59ce709bc105a7"><div class="ttname"><a href="classnnp_1_1Training.html#af600a10225c7035afa59ce709bc105a7">nnp::Training::writeWeights</a></div><div class="ttdeci">void writeWeights(std::string const &amp;nnName, std::string const &amp;fileNameFormat) const</div><div class="ttdoc">Write weights to files (one file for each element).</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01513">Training.cpp:1513</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a7d44c6d46a17bc5a5f85898c2a70d348"><div class="ttname"><a href="classnnp_1_1Training.html#a7d44c6d46a17bc5a5f85898c2a70d348">nnp::Training::stage</a></div><div class="ttdeci">std::size_t stage</div><div class="ttdoc">Training stage.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00426">Training.h:426</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_af767ead6aee5477b94c95fc5db7be2b2"><div class="ttname"><a href="classnnp_1_1Dataset.html#af767ead6aee5477b94c95fc5db7be2b2">nnp::Dataset::collectError</a></div><div class="ttdeci">void collectError(std::string const &amp;property, std::map&lt; std::string, double &gt; &amp;error, std::size_t &amp;count) const</div><div class="ttdoc">Collect error metrics of a property over all MPI procs.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8cpp_source.html#l01629">Dataset.cpp:1629</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a3f209dcaac73586a0ebb0ea92680ee3e"><div class="ttname"><a href="classnnp_1_1Training.html#a3f209dcaac73586a0ebb0ea92680ee3e">nnp::Training::trainingLogFileName</a></div><div class="ttdeci">std::string trainingLogFileName</div><div class="ttdoc">File name for training log.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00448">Training.h:448</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2"><div class="ttname"><a href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa0707d216983363dba3236106dfc85ec2">nnp::Training::US_COMBINED</a></div><div class="ttdeci">@ US_COMBINED</div><div class="ttdoc">One combined updater for all elements.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00098">Training.h:98</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_a8ef6e31fa3d3e6a0261ec2006e6c963a"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963a">nnp::KalmanFilter::KalmanType</a></div><div class="ttdeci">KalmanType</div><div class="ttdoc">Enumerate different Kalman filter types.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8h_source.html#l00035">KalmanFilter.h:35</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="classnnp_1_1Mode.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00524">Mode.h:524</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a778e3d7087b98c31effaa4129d23c6d7"><div class="ttname"><a href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">nnp::Mode::calculateAtomicNeuralNetworks</a></div><div class="ttdeci">void calculateAtomicNeuralNetworks(Structure &amp;structure, bool const derivatives)</div><div class="ttdoc">Calculate a single atomic neural network for a given atom and nn type.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01310">Mode.cpp:1310</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_aeee2583a1323180d235f16717111f39e"><div class="ttname"><a href="classnnp_1_1Training.html#aeee2583a1323180d235f16717111f39e">nnp::Training::hasStructures</a></div><div class="ttdeci">bool hasStructures</div><div class="ttdoc">If this rank holds structure information.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00416">Training.h:416</a></div></div>
<div class="ttc" id="aclassnnp_1_1Updater_html"><div class="ttname"><a href="classnnp_1_1Updater.html">nnp::Updater</a></div><div class="ttdoc">Base class for different weight update methods.</div><div class="ttdef"><b>Definition:</b> <a href="Updater_8h_source.html#l00031">Updater.h:31</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a8aec6fb4708b93b93a9cfa0e8045f955"><div class="ttname"><a href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups</a></div><div class="ttdeci">void calculateSymmetryFunctionGroups(Structure &amp;structure, bool const derivatives)</div><div class="ttdoc">Calculate all symmetry function groups for all atoms in given structure.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01230">Mode.cpp:1230</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a14ce267846960e602130171ebd485763"><div class="ttname"><a href="classnnp_1_1Training.html#a14ce267846960e602130171ebd485763">nnp::Training::numWeights</a></div><div class="ttdeci">std::size_t numWeights</div><div class="ttdoc">Total number of weights.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00444">Training.h:444</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf"><div class="ttname"><a href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429aa876e8890dda60cc514658d0aaf1db4cf">nnp::Training::US_ELEMENT</a></div><div class="ttdeci">@ US_ELEMENT</div><div class="ttdoc">Separate updaters for individual elements.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00100">Training.h:100</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ac2bec3d1ad183e620687bf41ede6f5ad"><div class="ttname"><a href="classnnp_1_1Training.html#ac2bec3d1ad183e620687bf41ede6f5ad">nnp::Training::parallelMode</a></div><div class="ttdeci">ParallelMode parallelMode</div><div class="ttdoc">Parallelization mode used.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00408">Training.h:408</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a2a5d0fda76e8e10fd700405323bd9713"><div class="ttname"><a href="classnnp_1_1Training.html#a2a5d0fda76e8e10fd700405323bd9713">nnp::Training::writeWeightsEvery</a></div><div class="ttdeci">std::size_t writeWeightsEvery</div><div class="ttdoc">Write weights every this many epochs.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00434">Training.h:434</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ad50f7e1c48f3f558653f831aae83a38c"><div class="ttname"><a href="classnnp_1_1Training.html#ad50f7e1c48f3f558653f831aae83a38c">nnp::Training::writeUpdaterStatus</a></div><div class="ttdeci">void writeUpdaterStatus(bool append, std::string const fileNameFormat=&quot;updater.%03zu.out&quot;) const</div><div class="ttdoc">Write updater information to file.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01811">Training.cpp:1811</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="classnnp_1_1Mode.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00510">Mode.h:510</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb"><div class="ttname"><a href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5eda5f4e6432710423b4b73303c03cd7dddb">nnp::Training::PM_TRAIN_RK0</a></div><div class="ttdeci">@ PM_TRAIN_RK0</div><div class="ttdoc">No training parallelization, only data set distribution.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00071">Training.h:71</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_aa8ddf0701dbcd60868955ca556892bc5"><div class="ttname"><a href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset</a></div><div class="ttdeci">void removeEnergyOffset(Structure &amp;structure, bool ref=true)</div><div class="ttdoc">Remove atomic energy offsets from reference energy.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01480">Mode.cpp:1480</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html_ace4770399203773624ab9c7db8db66d5"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html#ace4770399203773624ab9c7db8db66d5">nnp::Atom::Neighbor::dGdr</a></div><div class="ttdeci">std::vector&lt; Vec3D &gt; dGdr</div><div class="ttdoc">Derivatives of symmetry functions with respect to neighbor coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00059">Atom.h:59</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_ae35949dc7242a6e2f5e81885e737e38f"><div class="ttname"><a href="classnnp_1_1Dataset.html#ae35949dc7242a6e2f5e81885e737e38f">nnp::Dataset::rngGlobal</a></div><div class="ttdeci">gsl_rng * rngGlobal</div><div class="ttdoc">Global GSL random number generator (equal seed for each MPI process).</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00208">Dataset.h:208</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_a8ef6e31fa3d3e6a0261ec2006e6c963aa8054c56093b2a97bc14d3722d08b0aee"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#a8ef6e31fa3d3e6a0261ec2006e6c963aa8054c56093b2a97bc14d3722d08b0aee">nnp::KalmanFilter::KT_STANDARD</a></div><div class="ttdeci">@ KT_STANDARD</div><div class="ttdoc">Regular Kalman filter.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8h_source.html#l00038">KalmanFilter.h:38</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_ae2fddd6f29bb63ef67b9619544d81ab1"><div class="ttname"><a href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces</a></div><div class="ttdeci">void calculateForces(Structure &amp;structure) const</div><div class="ttdoc">Calculate forces for all atoms in given structure.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01392">Mode.cpp:1392</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a61a21e51fe6761fe3a3a44533d70603d"><div class="ttname"><a href="classnnp_1_1Training.html#a61a21e51fe6761fe3a3a44533d70603d">nnp::Training::writeNeuronStatisticsAlways</a></div><div class="ttdeci">std::size_t writeNeuronStatisticsAlways</div><div class="ttdoc">Up to this epoch neuron statistics are written every epoch.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00440">Training.h:440</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a68e80f07031867155a7fbc4f480a2bd0"><div class="ttname"><a href="classnnp_1_1Training.html#a68e80f07031867155a7fbc4f480a2bd0">nnp::Training::numUpdaters</a></div><div class="ttdeci">std::size_t numUpdaters</div><div class="ttdoc">Number of updaters (depends on update strategy).</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00428">Training.h:428</a></div></div>
<div class="ttc" id="aclassnnp_1_1Settings_html_a71a38f012f2a014d17de2091a6ea76cc"><div class="ttname"><a href="classnnp_1_1Settings.html#a71a38f012f2a014d17de2091a6ea76cc">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword, bool exact=false) const</div><div class="ttdoc">Check if keyword is present in settings file.</div><div class="ttdef"><b>Definition:</b> <a href="Settings_8cpp_source.html#l00177">Settings.cpp:177</a></div></div>
<div class="ttc" id="annp-cutoff_8cpp_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="nnp-cutoff_8cpp.html#a873684cefeb665f3d5e6b495de57fc0d">d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="nnp-cutoff_8cpp_source.html#l00034">nnp-cutoff.cpp:34</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a93e137591120925fe9ec70011385a972"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a93e137591120925fe9ec70011385a972">nnp::NeuralNetwork::getConnections</a></div><div class="ttdeci">void getConnections(double *connections) const</div><div class="ttdoc">Get neural network weights and biases.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00171">NeuralNetwork.cpp:171</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429"><div class="ttname"><a href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a38d533d5bcbf5f303309afa61b8eb429">nnp::Training::SM_RANDOM</a></div><div class="ttdeci">@ SM_RANDOM</div><div class="ttdoc">Select candidates randomly.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00107">Training.h:107</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_acf9764deff52466a53699a07b6a7a7ce"><div class="ttname"><a href="structnnp_1_1Atom.html#acf9764deff52466a53699a07b6a7a7ce">nnp::Atom::chargeRef</a></div><div class="ttdeci">double chargeRef</div><div class="ttdoc">Atomic reference charge.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00116">Atom.h:116</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a0ddcfb0243cca5956075a75c90431c37"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput</a></div><div class="ttdeci">void setInput(double const *const &amp;input) const</div><div class="ttdoc">Set neural network input layer node values.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00357">NeuralNetwork.cpp:357</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a4daf50292f3efe2614a473be9ab1192f"><div class="ttname"><a href="classnnp_1_1Training.html#a4daf50292f3efe2614a473be9ab1192f">nnp::Training::countUpdates</a></div><div class="ttdeci">std::size_t countUpdates</div><div class="ttdoc">Update counter (for all training quantities together).</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00442">Training.h:442</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_aacf38b0b03a3d30695ac9a9cfe70fa5a"><div class="ttname"><a href="classnnp_1_1Training.html#aacf38b0b03a3d30695ac9a9cfe70fa5a">nnp::Training::shuffleUpdateCandidates</a></div><div class="ttdeci">void shuffleUpdateCandidates(std::string const &amp;property)</div><div class="ttdoc">Shuffle update candidates.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01876">Training.cpp:1876</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a></div><div class="ttdeci">@ ST_TRAINING</div><div class="ttdoc">Structure is part of the training set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00044">Structure.h:44</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html">nnp::NeuralNetwork</a></div><div class="ttdoc">This class implements a feed-forward neural network.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8h_source.html#l00028">NeuralNetwork.h:28</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="classnnp_1_1Mode.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00525">Mode.h:525</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a5ef4b4d51191c4c67be8dc39c7bfd3ed"><div class="ttname"><a href="classnnp_1_1Training.html#a5ef4b4d51191c4c67be8dc39c7bfd3ed">nnp::Training::p</a></div><div class="ttdeci">PropertyMap p</div><div class="ttdoc">Actual training properties.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00479">Training.h:479</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a2b71003bb978998c82e9cbefd454f242"><div class="ttname"><a href="classnnp_1_1Training.html#a2b71003bb978998c82e9cbefd454f242">nnp::Training::rngGlobalNew</a></div><div class="ttdeci">std::mt19937_64 rngGlobalNew</div><div class="ttdoc">Global random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00477">Training.h:477</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_ad7e18949cd215e5427440fce7a1437d7"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput</a></div><div class="ttdeci">void getOutput(double *output) const</div><div class="ttdoc">Get neural network output layer node values.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00374">NeuralNetwork.cpp:374</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a17ba3ecbce972ff28d7a17bdade38674"><div class="ttname"><a href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset</a></div><div class="ttdeci">void addEnergyOffset(Structure &amp;structure, bool ref=true)</div><div class="ttdoc">Add atomic energy offsets to reference energy.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01461">Mode.cpp:1461</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a043ac1c36d5edc38a6c72f4366823c69"><div class="ttname"><a href="classnnp_1_1Mode.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a></div><div class="ttdeci">bool normalize</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00514">Mode.h:514</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a103de589f43d89513b741cea0bdbf541"><div class="ttname"><a href="classnnp_1_1Training.html#a103de589f43d89513b741cea0bdbf541">nnp::Training::writeWeightsAlways</a></div><div class="ttdeci">std::size_t writeWeightsAlways</div><div class="ttdoc">Up to this epoch weights are written every epoch.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00436">Training.h:436</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html_a3c0720664c09022328aeb7a676b1a266"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html#a3c0720664c09022328aeb7a676b1a266">nnp::Atom::Neighbor::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of neighbor atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00041">Atom.h:41</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="classnnp_1_1Mode.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00517">Mode.h:517</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a6f0184f87845a572cf4c3db0958a97d9"><div class="ttname"><a href="classnnp_1_1Mode.html#a6f0184f87845a572cf4c3db0958a97d9">nnp::Mode::setupSymmetryFunctionGroups</a></div><div class="ttdeci">virtual void setupSymmetryFunctionGroups()</div><div class="ttdoc">Set up symmetry function groups.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00662">Mode.cpp:662</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ad641fa6c3bd89c5c3efd964c9a47429a"><div class="ttname"><a href="classnnp_1_1Training.html#ad641fa6c3bd89c5c3efd964c9a47429a">nnp::Training::UpdateStrategy</a></div><div class="ttdeci">UpdateStrategy</div><div class="ttdoc">Update strategies available for Training.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00095">Training.h:95</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html_a26d7bd9f4c4d88d27a1046364b0f779a"><div class="ttname"><a href="classnnp_1_1GradientDescent.html#a26d7bd9f4c4d88d27a1046364b0f779a">nnp::GradientDescent::setParametersAdam</a></div><div class="ttdeci">void setParametersAdam(double const eta, double const beta1, double const beta2, double const epsilon)</div><div class="ttdoc">Set parameters for Adam algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8cpp_source.html#l00127">GradientDescent.cpp:127</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367"><div class="ttname"><a href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98abd8af4b4dae6d18a6d3a2be8927fc367">nnp::Training::SM_SORT</a></div><div class="ttdeci">@ SM_SORT</div><div class="ttdoc">Sort candidates according to their RMSE and pick worst first.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00109">Training.h:109</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ae5d67463993440b215a9b165854c8cf9"><div class="ttname"><a href="classnnp_1_1Training.html#ae5d67463993440b215a9b165854c8cf9">nnp::Training::calculateErrorEpoch</a></div><div class="ttdeci">void calculateErrorEpoch()</div><div class="ttdoc">Calculate error metrics per epoch for all structures with file names used in training loop.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01379">Training.cpp:1379</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_abc64f09e49aabb8112004f5af6983102"><div class="ttname"><a href="structnnp_1_1Atom.html#abc64f09e49aabb8112004f5af6983102">nnp::Atom::G</a></div><div class="ttdeci">std::vector&lt; double &gt; G</div><div class="ttdoc">Symmetry function values.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00134">Atom.h:134</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a94e6d295200728de7780f6796b86593f"><div class="ttname"><a href="classnnp_1_1Training.html#a94e6d295200728de7780f6796b86593f">nnp::Training::addTrainingLogEntry</a></div><div class="ttdeci">void addTrainingLogEntry(int proc, std::size_t il, double f, std::size_t isg, std::size_t is)</div><div class="ttdoc">Write energy update data to training log file.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02858">Training.cpp:2858</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a87219d930829f343d65e5c59bc0220b1ab96a1476ad0c41c52f782708a82d7949"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ab96a1476ad0c41c52f782708a82d7949">nnp::NeuralNetwork::MS_GLOROTBENGIO</a></div><div class="ttdeci">@ MS_GLOROTBENGIO</div><div class="ttdoc">Normalize connections according to Glorot and Bengio.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8h_source.html#l00088">NeuralNetwork.h:88</a></div></div>
<div class="ttc" id="anamespacennp_html_a9d1bbacf408dac7e040ce679791bc570"><div class="ttname"><a href="namespacennp.html#a9d1bbacf408dac7e040ce679791bc570">nnp::createFileHeader</a></div><div class="ttdeci">vector&lt; string &gt; createFileHeader(vector&lt; string &gt; const &amp;title, vector&lt; size_t &gt; const &amp;colSize, vector&lt; string &gt; const &amp;colName, vector&lt; string &gt; const &amp;colInfo, char const &amp;commentChar)</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00104">utility.cpp:104</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a87219d930829f343d65e5c59bc0220b1ade647e2d9f5c0d6f8f20d95df165c827"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1ade647e2d9f5c0d6f8f20d95df165c827">nnp::NeuralNetwork::MS_NGUYENWIDROW</a></div><div class="ttdeci">@ MS_NGUYENWIDROW</div><div class="ttdoc">Initialize connections according to Nguyen-Widrow scheme.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8h_source.html#l00100">NeuralNetwork.h:100</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_af28c4111f0f053fbccb6b072b47c6fea"><div class="ttname"><a href="classnnp_1_1Training.html#af28c4111f0f053fbccb6b072b47c6fea">nnp::Training::weights</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; weights</div><div class="ttdoc">Neural network weights and biases for each element.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00468">Training.h:468</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_aa75026a60054469cc7fb3a211e501f2f"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#aa75026a60054469cc7fb3a211e501f2f">nnp::KalmanFilter::setSizeObservation</a></div><div class="ttdeci">void setSizeObservation(std::size_t const sizeObservation)</div><div class="ttdoc">Set observation vector size.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8cpp_source.html#l00076">KalmanFilter.cpp:76</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a33e73c163ea6a69fc0d87acd735fd9e7"><div class="ttname"><a href="classnnp_1_1Training.html#a33e73c163ea6a69fc0d87acd735fd9e7">nnp::Training::allocateArrays</a></div><div class="ttdeci">void allocateArrays(std::string const &amp;property)</div><div class="ttdoc">Allocate error and Jacobian arrays for given property.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l03280">Training.cpp:3280</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aaee087b13af754a75198def4d12c8b61"><div class="ttname"><a href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a></div><div class="ttdeci">double energyRef</div><div class="ttdoc">Reference potential energy.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00078">Structure.h:78</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_ad53c703ea0d760ad25b5f6ebb7bdbf4c"><div class="ttname"><a href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numNeighborsPerElement</div><div class="ttdoc">Number of neighbors per element.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00126">Atom.h:126</a></div></div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_acd54eb7c8fd1f9967604463ff11ffce1"><div class="ttname"><a href="classnnp_1_1ElementMap.html#acd54eb7c8fd1f9967604463ff11ffce1">nnp::ElementMap::atomicNumber</a></div><div class="ttdeci">std::size_t atomicNumber(std::size_t index) const</div><div class="ttdoc">Get atomic number from element index.</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8h_source.html#l00145">ElementMap.h:145</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_af4986e0d008729499003bdf5d2ff59e6"><div class="ttname"><a href="classnnp_1_1Training.html#af4986e0d008729499003bdf5d2ff59e6">nnp::Training::freeMemory</a></div><div class="ttdeci">bool freeMemory</div><div class="ttdoc">Free symmetry function memory after calculation.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00422">Training.h:422</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="classnnp_1_1Mode.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap().</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00508">Mode.h:508</a></div></div>
<div class="ttc" id="aclassnnp_1_1Log_html_a91771eb48c9896ab3abce172a8627bc1"><div class="ttname"><a href="classnnp_1_1Log.html#a91771eb48c9896ab3abce172a8627bc1">nnp::Log::silent</a></div><div class="ttdeci">bool silent</div><div class="ttdoc">Completely silence output.</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00087">Log.h:87</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a45f426cc1948a782e161d0bd0072fbaa"><div class="ttname"><a href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaa">nnp::Training::JacobianMode</a></div><div class="ttdeci">JacobianMode</div><div class="ttdoc">Jacobian matrix preparation mode.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00084">Training.h:84</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_ab86800b032be86f1321d3f6683c75b01"><div class="ttname"><a href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset</a></div><div class="ttdeci">double getEnergyWithOffset(Structure const &amp;structure, bool ref=true) const</div><div class="ttdoc">Add atomic energy offsets and return energy.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01512">Mode.cpp:1512</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a3d0cecb1a3e0197fdb693186d39c8796"><div class="ttname"><a href="classnnp_1_1Training.html#a3d0cecb1a3e0197fdb693186d39c8796">nnp::Training::checkSelectionMode</a></div><div class="ttdeci">void checkSelectionMode()</div><div class="ttdoc">Check if selection mode should be changed.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01915">Training.cpp:1915</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a87219d930829f343d65e5c59bc0220b1a66ae2f43aca0c9fbc5285c4b81e79bfa"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a87219d930829f343d65e5c59bc0220b1a66ae2f43aca0c9fbc5285c4b81e79bfa">nnp::NeuralNetwork::MS_ZEROBIAS</a></div><div class="ttdeci">@ MS_ZEROBIAS</div><div class="ttdoc">Set all bias values to zero.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8h_source.html#l00060">NeuralNetwork.h:60</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_ad0080b25ea49cdd6ce085162751a379b"><div class="ttname"><a href="classnnp_1_1Mode.html#ad0080b25ea49cdd6ce085162751a379b">nnp::Mode::setupSymmetryFunctions</a></div><div class="ttdeci">virtual void setupSymmetryFunctions()</div><div class="ttdoc">Set up all symmetry functions.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00435">Mode.cpp:435</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a3479cb0b5dc64c4260837adbfa11f868"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a3479cb0b5dc64c4260837adbfa11f868">nnp::NeuralNetwork::setConnections</a></div><div class="ttdeci">void setConnections(double const *const &amp;connections)</div><div class="ttdoc">Set neural network weights and biases.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00147">NeuralNetwork.cpp:147</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a15574dbe2ae544ee27a79519d6c92146"><div class="ttname"><a href="classnnp_1_1Mode.html#a15574dbe2ae544ee27a79519d6c92146">nnp::Mode::nnpType</a></div><div class="ttdeci">NNPType nnpType</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00513">Mode.h:513</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a9be53bf5fcdbefa900c9c7f8a8a6bb40"><div class="ttname"><a href="classnnp_1_1Training.html#a9be53bf5fcdbefa900c9c7f8a8a6bb40">nnp::Training::writeNeuronStatisticsEvery</a></div><div class="ttdeci">std::size_t writeNeuronStatisticsEvery</div><div class="ttdoc">Write neuron statistics every this many epochs.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00438">Training.h:438</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a5ba30ce58e186c7f2e518355aa707863"><div class="ttname"><a href="classnnp_1_1Training.html#a5ba30ce58e186c7f2e518355aa707863">nnp::Training::printHeader</a></div><div class="ttdeci">void printHeader()</div><div class="ttdoc">Print training loop header on screen.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01409">Training.cpp:1409</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html">nnp::KalmanFilter</a></div><div class="ttdoc">Implementation of the Kalman filter method.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8h_source.html#l00031">KalmanFilter.h:31</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a53248fb2d903d54fd37a26eca5c51b5e"><div class="ttname"><a href="classnnp_1_1Training.html#a53248fb2d903d54fd37a26eca5c51b5e">nnp::Training::sw</a></div><div class="ttdeci">std::map&lt; std::string, Stopwatch &gt; sw</div><div class="ttdoc">Stopwatches for timing overview.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00473">Training.h:473</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a6a74c4b42491ec361d8d9192cd43c82b"><div class="ttname"><a href="classnnp_1_1Mode.html#a6a74c4b42491ec361d8d9192cd43c82b">nnp::Mode::physical</a></div><div class="ttdeci">double physical(std::string const &amp;property, double value) const</div><div class="ttdoc">Undo normalization for a given property.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01549">Mode.cpp:1549</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="classnnp_1_1Mode.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00523">Mode.h:523</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a79df98867453f340a4cea8a9e432be98"><div class="ttname"><a href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98">nnp::Training::SelectionMode</a></div><div class="ttdeci">SelectionMode</div><div class="ttdoc">How update candidates are selected during Training.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00104">Training.h:104</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ad3842dd2ab00d29da9d3b2e0ada174dc"><div class="ttname"><a href="classnnp_1_1Training.html#ad3842dd2ab00d29da9d3b2e0ada174dc">nnp::Training::epochSchedule</a></div><div class="ttdeci">std::vector&lt; int &gt; epochSchedule</div><div class="ttdoc">Update schedule epoch (false = energy update, true = force update).</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00454">Training.h:454</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_a5792beef75d223f3df178ce494c74ac6"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#a5792beef75d223f3df178ce494c74ac6">nnp::KalmanFilter::setParametersFadingMemory</a></div><div class="ttdeci">void setParametersFadingMemory(double const epsilon, double const q0, double const qtau, double const qmin, double const lambda, double const nu)</div><div class="ttdoc">Set parameters for fading memory Kalman filter.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8cpp_source.html#l00219">KalmanFilter.cpp:219</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a5362ed9fa8992ca8ec88ab5c6daab978"><div class="ttname"><a href="classnnp_1_1Training.html#a5362ed9fa8992ca8ec88ab5c6daab978">nnp::Training::setupSelectionMode</a></div><div class="ttdeci">void setupSelectionMode(std::string const &amp;property)</div><div class="ttdoc">Set selection mode for specific training property.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l03000">Training.cpp:3000</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a2352aabf707595bd9893ed59a9c4977e"><div class="ttname"><a href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a></div><div class="ttdeci">double charge</div><div class="ttdoc">Atomic charge determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00114">Atom.h:114</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a385a420ca6f05019c349d0ca5d6bf10b"><div class="ttname"><a href="classnnp_1_1Training.html#a385a420ca6f05019c349d0ca5d6bf10b">nnp::Training::trainingLog</a></div><div class="ttdeci">std::ofstream trainingLog</div><div class="ttdoc">Training log file.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00452">Training.h:452</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a6671e3eb01b86af1162273218df0e5ed"><div class="ttname"><a href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5ed">nnp::Training::ParallelMode</a></div><div class="ttdeci">ParallelMode</div><div class="ttdoc">Training parallelization mode.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00055">Training.h:55</a></div></div>
<div class="ttc" id="anamespacennp_html_aeed037cd4a793db2c1b490e6607c0866"><div class="ttname"><a href="namespacennp.html#aeed037cd4a793db2c1b490e6607c0866">nnp::appendLinesToFile</a></div><div class="ttdeci">void appendLinesToFile(ofstream &amp;file, vector&lt; string &gt; const lines)</div><div class="ttdoc">Append multiple lines of strings to open file stream.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00218">utility.cpp:218</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_afebaaf27a0e6b30eab2f4cbc8c66d046"><div class="ttname"><a href="structnnp_1_1Atom.html#afebaaf27a0e6b30eab2f4cbc8c66d046">nnp::Atom::numNeighbors</a></div><div class="ttdeci">std::size_t numNeighbors</div><div class="ttdoc">Total number of neighbors.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00106">Atom.h:106</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html"><div class="ttname"><a href="structnnp_1_1Atom.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00031">Atom.h:31</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ad2c737c945e42ec42fa852e4dbacaf90"><div class="ttname"><a href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a></div><div class="ttdeci">std::size_t numAtoms</div><div class="ttdoc">Total number of atoms present in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00068">Structure.h:68</a></div></div>
<div class="ttc" id="anamespacennp_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00090">utility.cpp:90</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html_a54d38d540466c376ccd73014954de27eaf3f7383ef188f4eb5c5e0bda3c048b25"><div class="ttname"><a href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27eaf3f7383ef188f4eb5c5e0bda3c048b25">nnp::GradientDescent::DT_FIXED</a></div><div class="ttdeci">@ DT_FIXED</div><div class="ttdoc">Fixed step size.</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8h_source.html#l00036">GradientDescent.h:36</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_af2d61853475185baae3fa3a7d358557a"><div class="ttname"><a href="classnnp_1_1Mode.html#af2d61853475185baae3fa3a7d358557a">nnp::Mode::writeSettingsFile</a></div><div class="ttdeci">void writeSettingsFile(std::ofstream *const &amp;file) const</div><div class="ttdoc">Write complete settings file.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01650">Mode.cpp:1650</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html_a0fc36f84c5f9d35f75be83b1e8d54b9d"><div class="ttname"><a href="classnnp_1_1GradientDescent.html#a0fc36f84c5f9d35f75be83b1e8d54b9d">nnp::GradientDescent::setParametersFixed</a></div><div class="ttdeci">void setParametersFixed(double const eta)</div><div class="ttdoc">Set parameters for fixed step gradient descent algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8cpp_source.html#l00120">GradientDescent.cpp:120</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6"><div class="ttname"><a href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626eaa6c9bb7b381d38168a1286c62da7c1f6">nnp::Training::UT_LM</a></div><div class="ttdeci">@ UT_LM</div><div class="ttdoc">Levenberg-Marquardt algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00046">Training.h:46</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a80d3c7681f0727847d717ab7a333abbf"><div class="ttname"><a href="classnnp_1_1Training.html#a80d3c7681f0727847d717ab7a333abbf">nnp::Training::collectDGdxia</a></div><div class="ttdeci">void collectDGdxia(Atom const &amp;atom, std::size_t indexAtom, std::size_t indexComponent)</div><div class="ttdoc">Collect derivative of symmetry functions with repect to one atom's coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02903">Training.cpp:2903</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00076">Structure.h:76</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a178647e7ce5eca9f6bb7cc4c371909f3"><div class="ttname"><a href="classnnp_1_1Training.html#a178647e7ce5eca9f6bb7cc4c371909f3">nnp::Training::useForces</a></div><div class="ttdeci">bool useForces</div><div class="ttdoc">Use forces for training.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00418">Training.h:418</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_aed44026c9d76b19022856e1e82cad8bb"><div class="ttname"><a href="classnnp_1_1Training.html#aed44026c9d76b19022856e1e82cad8bb">nnp::Training::pk</a></div><div class="ttdeci">std::vector&lt; std::string &gt; pk</div><div class="ttdoc">Vector of actually used training properties.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00460">Training.h:460</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a86b54c7bf103e141f9870ee2bbb30c4f"><div class="ttname"><a href="classnnp_1_1Training.html#a86b54c7bf103e141f9870ee2bbb30c4f">nnp::Training::printEpoch</a></div><div class="ttdeci">void printEpoch()</div><div class="ttdoc">Print preferred error metric and timing information on screen.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01467">Training.cpp:1467</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a79793fcf50af45c9b128ea972b14b6a8"><div class="ttname"><a href="classnnp_1_1Training.html#a79793fcf50af45c9b128ea972b14b6a8">nnp::Training::writeNeuronStatisticsEpoch</a></div><div class="ttdeci">void writeNeuronStatisticsEpoch() const</div><div class="ttdoc">Write neuron statistics during training loop.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01761">Training.cpp:1761</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_a96f37380d0a1d86920e3da271df3b089"><div class="ttname"><a href="classnnp_1_1Dataset.html#a96f37380d0a1d86920e3da271df3b089">nnp::Dataset::numProcs</a></div><div class="ttdeci">int numProcs</div><div class="ttdoc">Total number of MPI processors.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00198">Dataset.h:198</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a4526b9a7e947a38b861098d0826a6161"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a4526b9a7e947a38b861098d0826a6161">nnp::NeuralNetwork::calculateDFdc</a></div><div class="ttdeci">void calculateDFdc(double *dFdc, double const *const &amp;dGdxyz) const</div><div class="ttdoc">Calculate &quot;second&quot; derivative of output with respect to connections.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00488">NeuralNetwork.cpp:488</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a8a99d257e8c71aaf4dba65a1b9a1b5f1"><div class="ttname"><a href="classnnp_1_1Training.html#a8a99d257e8c71aaf4dba65a1b9a1b5f1">nnp::Training::setupFileOutput</a></div><div class="ttdeci">void setupFileOutput(std::string const &amp;type)</div><div class="ttdoc">Set file output intervals for properties and other quantities.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l03108">Training.cpp:3108</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_adc45ef017066bdbfaef2846a39eb733c"><div class="ttname"><a href="classnnp_1_1Training.html#adc45ef017066bdbfaef2846a39eb733c">nnp::Training::calculateError</a></div><div class="ttdeci">void calculateError(std::map&lt; std::string, std::pair&lt; std::string, std::string &gt;&gt; const fileNames)</div><div class="ttdoc">Calculate error metrics for all structures.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01200">Training.cpp:1200</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b"><div class="ttname"><a href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea2eed92f93d5b762945cdd863429fde3b">nnp::Training::UT_GD</a></div><div class="ttdeci">@ UT_GD</div><div class="ttdoc">Simple gradient descent methods.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00042">Training.h:42</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a2e7318a8dd101bc306d3ff449fca7373"><div class="ttname"><a href="classnnp_1_1Training.html#a2e7318a8dd101bc306d3ff449fca7373">nnp::Training::nnId</a></div><div class="ttdeci">std::string nnId</div><div class="ttdoc">ID of neural network the training is working on.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00450">Training.h:450</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a0e62e59b28ba068d154856c16219e93b"><div class="ttname"><a href="classnnp_1_1Training.html#a0e62e59b28ba068d154856c16219e93b">nnp::Training::numWeightsPerUpdater</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numWeightsPerUpdater</div><div class="ttdoc">Number of weights per updater.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00456">Training.h:456</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a3c709ea24c0cb6ea3bfdaaae6efd2202"><div class="ttname"><a href="classnnp_1_1Training.html#a3c709ea24c0cb6ea3bfdaaae6efd2202">nnp::Training::hasUpdaters</a></div><div class="ttdeci">bool hasUpdaters</div><div class="ttdoc">If this rank performs weight updates.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00414">Training.h:414</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a040f4feb5130b36ba185f437e6999a62"><div class="ttname"><a href="classnnp_1_1Training.html#a040f4feb5130b36ba185f437e6999a62">nnp::Training::dGdxia</a></div><div class="ttdeci">std::vector&lt; double &gt; dGdxia</div><div class="ttdoc">Derivative of symmetry functions with respect to one specific atom coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00464">Training.h:464</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a3ef1d07944abca654800f68676cd2e89"><div class="ttname"><a href="structnnp_1_1Atom.html#a3ef1d07944abca654800f68676cd2e89">nnp::Atom::fRef</a></div><div class="ttdeci">Vec3D fRef</div><div class="ttdoc">Reference force vector from data set.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00122">Atom.h:122</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a12b98d35abbe2cd5d6357e061a2a5bc7"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a12b98d35abbe2cd5d6357e061a2a5bc7">nnp::NeuralNetwork::modifyConnections</a></div><div class="ttdeci">void modifyConnections(ModificationScheme modificationScheme)</div><div class="ttdoc">Change connections according to a given modification scheme.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00212">NeuralNetwork.cpp:212</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a3427c9bd877e3bf72ad71f30dfb76ac2"><div class="ttname"><a href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numAtomsPerElement</div><div class="ttdoc">Number of atoms of each element in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00094">Structure.h:94</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a8745838265af0e0436fc024d0c80de74"><div class="ttname"><a href="classnnp_1_1Training.html#a8745838265af0e0436fc024d0c80de74">nnp::Training::weightsOffset</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; weightsOffset</div><div class="ttdoc">Offset of each element's weights in combined array.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00458">Training.h:458</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee"><div class="ttname"><a href="classnnp_1_1Mode.html#a46a0c99828036f91e87b97344b36fa8ca1fa83558f300cc51d0fd0910971a34ee">nnp::Mode::NNPType::SHORT_ONLY</a></div><div class="ttdeci">@ SHORT_ONLY</div><div class="ttdoc">Short range NNP only.</div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a82549ec0800f63ffaf830b46f865cdbb"><div class="ttname"><a href="classnnp_1_1Training.html#a82549ec0800f63ffaf830b46f865cdbb">nnp::Training::setWeights</a></div><div class="ttdeci">void setWeights()</div><div class="ttdoc">Set weights in neural network class.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02833">Training.cpp:2833</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a6432b845ccd07996ab2f8f4f707a0d8d"><div class="ttname"><a href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update</a></div><div class="ttdeci">void update(std::string const &amp;property)</div><div class="ttdoc">Perform one update.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02050">Training.cpp:2050</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a8a30db3b7747df34b72d89cdfb791eb0"><div class="ttname"><a href="classnnp_1_1Training.html#a8a30db3b7747df34b72d89cdfb791eb0">nnp::Training::numEpochs</a></div><div class="ttdeci">std::size_t numEpochs</div><div class="ttdoc">Number of epochs requested.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00430">Training.h:430</a></div></div>
<div class="ttc" id="aclassnnp_1_1Settings_html_abe55e2b7294788622da5e888799732ff"><div class="ttname"><a href="classnnp_1_1Settings.html#abe55e2b7294788622da5e888799732ff">nnp::Settings::getSettingsLines</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getSettingsLines() const</div><div class="ttdoc">Get complete settings file.</div><div class="ttdef"><b>Definition:</b> <a href="Settings_8cpp_source.html#l00244">Settings.cpp:244</a></div></div>
<div class="ttc" id="anamespacennp_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00033">utility.cpp:33</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a170d82083599ace5c7973bd22c79ddae"><div class="ttname"><a href="structnnp_1_1Atom.html#a170d82083599ace5c7973bd22c79ddae">nnp::Atom::f</a></div><div class="ttdeci">Vec3D f</div><div class="ttdoc">Force vector calculated by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00120">Atom.h:120</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_aa0ab32abb821e98058c7df794ca8103d"><div class="ttname"><a href="classnnp_1_1Dataset.html#aa0ab32abb821e98058c7df794ca8103d">nnp::Dataset::structures</a></div><div class="ttdeci">std::vector&lt; Structure &gt; structures</div><div class="ttdoc">All structures in this dataset.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00192">Dataset.h:192</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a671f1f45d0b277daec4da583d0f9ce7b"><div class="ttname"><a href="classnnp_1_1Training.html#a671f1f45d0b277daec4da583d0f9ce7b">nnp::Training::writeTrainingLog</a></div><div class="ttdeci">bool writeTrainingLog</div><div class="ttdoc">Whether training log file is written.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00424">Training.h:424</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ac2e1f74df67860c5776bf811e5b6a518"><div class="ttname"><a href="classnnp_1_1Training.html#ac2e1f74df67860c5776bf811e5b6a518">nnp::Training::writeNeuronStatistics</a></div><div class="ttdeci">void writeNeuronStatistics(std::string const &amp;nnName, std::string const &amp;fileName) const</div><div class="ttdoc">Write neuron statistics collected since last invocation.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01662">Training.cpp:1662</a></div></div>
<div class="ttc" id="astructnnp_1_1Training_1_1PropertyMap_html_ab7019078f140f578655ebb1f8599e6d4"><div class="ttname"><a href="structnnp_1_1Training_1_1PropertyMap.html#ab7019078f140f578655ebb1f8599e6d4">nnp::Training::PropertyMap::exists</a></div><div class="ttdeci">bool exists(std::string const &amp;key)</div><div class="ttdoc">Check if property is present.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00399">Training.h:399</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a38f8bc8db576ad1762dd306b4d225383"><div class="ttname"><a href="classnnp_1_1Mode.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a></div><div class="ttdeci">double maxCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00520">Mode.h:520</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_aa38d991173328eb5c977dacf39347dca"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#aa38d991173328eb5c977dacf39347dca">nnp::NeuralNetwork::calculateDEdc</a></div><div class="ttdeci">void calculateDEdc(double *dEdc) const</div><div class="ttdoc">Calculate derivative of output neuron with respect to connections.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00442">NeuralNetwork.cpp:442</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575"><div class="ttname"><a href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa1ccf21386e53c6bde891425257092575">nnp::Training::JM_TASK</a></div><div class="ttdeci">@ JM_TASK</div><div class="ttdoc">Prepare one Jacobian entry for each task, sum up within tasks.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00089">Training.h:89</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a9e7a7553f60ebf30dbdfb8efc64b32c0"><div class="ttname"><a href="classnnp_1_1Training.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">nnp::Training::getWeights</a></div><div class="ttdeci">void getWeights()</div><div class="ttdoc">Get weights from neural network class.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02809">Training.cpp:2809</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a6665217897b26fa4fd01a07aa652cd2f"><div class="ttname"><a href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">nnp::Structure::sampleType</a></div><div class="ttdeci">SampleType sampleType</div><div class="ttdoc">Sample type (training or test set).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00086">Structure.h:86</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a88fb8800851f3d440fcf393cbc073308"><div class="ttname"><a href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy</a></div><div class="ttdeci">void calculateEnergy(Structure &amp;structure) const</div><div class="ttdoc">Calculate potential energy for a given structure.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01366">Mode.cpp:1366</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ab8e2ffef22c4331c2892ddbd01436ec6"><div class="ttname"><a href="classnnp_1_1Training.html#ab8e2ffef22c4331c2892ddbd01436ec6">nnp::Training::repeatedEnergyUpdates</a></div><div class="ttdeci">bool repeatedEnergyUpdates</div><div class="ttdoc">After force update perform energy update for corresponding structure.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00420">Training.h:420</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8"><div class="ttname"><a href="classnnp_1_1Training.html#a79df98867453f340a4cea8a9e432be98a804f840359bccb1411a2b11498b150b8">nnp::Training::SM_THRESHOLD</a></div><div class="ttdeci">@ SM_THRESHOLD</div><div class="ttdoc">Select candidates randomly with RMSE above threshold.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00111">Training.h:111</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="classnnp_1_1Mode.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00528">Mode.h:528</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html"><div class="ttname"><a href="classnnp_1_1GradientDescent.html">nnp::GradientDescent</a></div><div class="ttdoc">Weight updates based on simple gradient descent methods.</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8h_source.html#l00029">GradientDescent.h:29</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_acb7687f6863a18f901b4b13bdd88d225"><div class="ttname"><a href="classnnp_1_1Dataset.html#acb7687f6863a18f901b4b13bdd88d225">nnp::Dataset::combineFiles</a></div><div class="ttdeci">void combineFiles(std::string filePrefix) const</div><div class="ttdoc">Combine individual MPI proc files to one.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8cpp_source.html#l01661">Dataset.cpp:1661</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00096">Structure.h:96</a></div></div>
<div class="ttc" id="aclassnnp_1_1Settings_html_a6aaa131c802c7cdd0645a41ee12807b5"><div class="ttname"><a href="classnnp_1_1Settings.html#a6aaa131c802c7cdd0645a41ee12807b5">nnp::Settings::writeSettingsFile</a></div><div class="ttdeci">void writeSettingsFile(std::ofstream *const &amp;file, std::map&lt; std::size_t, std::string &gt; const &amp;replacements={}) const</div><div class="ttdoc">Write complete settings file.</div><div class="ttdef"><b>Definition:</b> <a href="Settings_8cpp_source.html#l00274">Settings.cpp:274</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a5f4d6996721dd95776b851d73ee77b7a"><div class="ttname"><a href="classnnp_1_1Training.html#a5f4d6996721dd95776b851d73ee77b7a">nnp::Training::updaters</a></div><div class="ttdeci">std::vector&lt; Updater * &gt; updaters</div><div class="ttdoc">Weight updater (combined or for each element).</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00470">Training.h:470</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a08b98e274dffce06459a1c29a05e90a7"><div class="ttname"><a href="classnnp_1_1Training.html#a08b98e274dffce06459a1c29a05e90a7">nnp::Training::epoch</a></div><div class="ttdeci">std::size_t epoch</div><div class="ttdoc">Current epoch.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00432">Training.h:432</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_aee02964b08a2acc442add33d96dbb1a2"><div class="ttname"><a href="classnnp_1_1Training.html#aee02964b08a2acc442add33d96dbb1a2">nnp::Training::setEpochSchedule</a></div><div class="ttdeci">void setEpochSchedule()</div><div class="ttdoc">Select energies/forces schedule for one epoch.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01887">Training.cpp:1887</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a5cbda69cd1b2ff7705263726577e79dd"><div class="ttname"><a href="classnnp_1_1Training.html#a5cbda69cd1b2ff7705263726577e79dd">nnp::Training::rngNew</a></div><div class="ttdeci">std::mt19937_64 rngNew</div><div class="ttdoc">Per-task random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00475">Training.h:475</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a494c9900a501676733155cca1b856be3"><div class="ttname"><a href="classnnp_1_1Mode.html#a494c9900a501676733155cca1b856be3">nnp::Mode::readNeuralNetworkWeights</a></div><div class="ttdeci">void readNeuralNetworkWeights(std::string const &amp;type, std::string const &amp;fileName)</div><div class="ttdoc">Read in weights for a specific type of neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01699">Mode.cpp:1699</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html_a54d38d540466c376ccd73014954de27e"><div class="ttname"><a href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27e">nnp::GradientDescent::DescentType</a></div><div class="ttdeci">DescentType</div><div class="ttdoc">Enumerate different gradient descent variants.</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8h_source.html#l00033">GradientDescent.h:33</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html">nnp::Atom::Neighbor</a></div><div class="ttdoc">Struct to store information on neighbor atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00034">Atom.h:34</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_abf46d0d0d2a4c068f67bb13ae445d725"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#abf46d0d0d2a4c068f67bb13ae445d725">nnp::NeuralNetwork::calculateDEdG</a></div><div class="ttdeci">void calculateDEdG(double *dEdG) const</div><div class="ttdoc">Calculate derivative of output neuron with respect to input neurons.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00394">NeuralNetwork.cpp:394</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="classnnp_1_1Mode.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8h_source.html#l00522">Mode.h:522</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_ab802ff670986203dab60c22f04b07f59"><div class="ttname"><a href="classnnp_1_1Training.html#ab802ff670986203dab60c22f04b07f59">nnp::Training::initializeWeightsMemory</a></div><div class="ttdeci">void initializeWeightsMemory(UpdateStrategy updateStrategy=US_COMBINED)</div><div class="ttdoc">Initialize weights vector according to update strategy.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l00304">Training.cpp:304</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_ae4b348e9b5e2ef89cb30c760bdb55153"><div class="ttname"><a href="classnnp_1_1Mode.html#ae4b348e9b5e2ef89cb30c760bdb55153">nnp::Mode::setupSymmetryFunctionStatistics</a></div><div class="ttdeci">void setupSymmetryFunctionStatistics(bool collectStatistics, bool collectExtrapolationWarnings, bool writeExtrapolationWarnings, bool stopOnExtrapolationWarnings)</div><div class="ttdoc">Set up symmetry function statistics collection.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00923">Mode.cpp:923</a></div></div>
<div class="ttc" id="aclassnnp_1_1NeuralNetwork_html_a0a5977b23676166a39fefbb0d232f050"><div class="ttname"><a href="classnnp_1_1NeuralNetwork.html#a0a5977b23676166a39fefbb0d232f050">nnp::NeuralNetwork::getNumConnections</a></div><div class="ttdeci">int getNumConnections() const</div><div class="ttdoc">Return total number of connections.</div><div class="ttdef"><b>Definition:</b> <a href="NeuralNetwork_8cpp_source.html#l00132">NeuralNetwork.cpp:132</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a369e6446df8b2b39db30b799c912afde"><div class="ttname"><a href="classnnp_1_1Training.html#a369e6446df8b2b39db30b799c912afde">nnp::Training::writeWeightsEpoch</a></div><div class="ttdeci">void writeWeightsEpoch() const</div><div class="ttdoc">Write weights to files during training loop.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01530">Training.cpp:1530</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_a1e39dc46c8015f4dbe34010b0d7a5648"><div class="ttname"><a href="classnnp_1_1Dataset.html#a1e39dc46c8015f4dbe34010b0d7a5648">nnp::Dataset::rng</a></div><div class="ttdeci">gsl_rng * rng</div><div class="ttdoc">GSL random number generator (different seed for each MPI process).</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00206">Dataset.h:206</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_adc4c6b8a47ec99fe2efc2e6851df83e5"><div class="ttname"><a href="classnnp_1_1Dataset.html#adc4c6b8a47ec99fe2efc2e6851df83e5">nnp::Dataset::myRank</a></div><div class="ttdeci">int myRank</div><div class="ttdoc">My process ID.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00196">Dataset.h:196</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a0d84a9ab4ad3b589c5f5bb89f2b2fa5b"><div class="ttname"><a href="classnnp_1_1Mode.html#a0d84a9ab4ad3b589c5f5bb89f2b2fa5b">nnp::Mode::setupNormalization</a></div><div class="ttdeci">void setupNormalization(bool standalone=true)</div><div class="ttdoc">Set up normalization.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00218">Mode.cpp:218</a></div></div>
<div class="ttc" id="ampi-extra_8h_html_aaae430420e25984e327a89b068e1582b"><div class="ttname"><a href="mpi-extra_8h.html#aaae430420e25984e327a89b068e1582b">MPI_SIZE_T</a></div><div class="ttdeci">#define MPI_SIZE_T</div><div class="ttdef"><b>Definition:</b> <a href="mpi-extra_8h_source.html#l00022">mpi-extra.h:22</a></div></div>
<div class="ttc" id="aclassnnp_1_1KalmanFilter_html_a0969a2748b485c3ca33c20c76fb4f5e2"><div class="ttname"><a href="classnnp_1_1KalmanFilter.html#a0969a2748b485c3ca33c20c76fb4f5e2">nnp::KalmanFilter::setParametersStandard</a></div><div class="ttdeci">void setParametersStandard(double const epsilon, double const q0, double const qtau, double const qmin, double const eta0, double const etatau, double const etamax)</div><div class="ttdoc">Set parameters for standard Kalman filter.</div><div class="ttdef"><b>Definition:</b> <a href="KalmanFilter_8cpp_source.html#l00196">KalmanFilter.cpp:196</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_aa26222b7b9dc3fd141f6e775690b5d2b"><div class="ttname"><a href="classnnp_1_1Mode.html#aa26222b7b9dc3fd141f6e775690b5d2b">nnp::Mode::setupSymmetryFunctionScaling</a></div><div class="ttdeci">virtual void setupSymmetryFunctionScaling(std::string const &amp;fileName=&quot;scaling.data&quot;)</div><div class="ttdoc">Set up symmetry function scaling from file.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00532">Mode.cpp:532</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html"><div class="ttname"><a href="structnnp_1_1Structure.html">nnp::Structure</a></div><div class="ttdoc">Storage for one atomic configuration.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00033">Structure.h:33</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2"><div class="ttname"><a href="classnnp_1_1Training.html#a45f426cc1948a782e161d0bd0072fbaaa672da672184b11db8b20c6044e228ad2">nnp::Training::JM_FULL</a></div><div class="ttdeci">@ JM_FULL</div><div class="ttdoc">Prepare full Jacobian matrix.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00091">Training.h:91</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_a8818ce2d15fcad4037b0db8057ad7f59"><div class="ttname"><a href="classnnp_1_1Dataset.html#a8818ce2d15fcad4037b0db8057ad7f59">nnp::Dataset::comm</a></div><div class="ttdeci">MPI_Comm comm</div><div class="ttdoc">Global MPI communicator.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00204">Dataset.h:204</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_adfd1869f65ece08e34f5ccea23c676f1"><div class="ttname"><a href="classnnp_1_1Training.html#adfd1869f65ece08e34f5ccea23c676f1">nnp::Training::resetNeuronStatistics</a></div><div class="ttdeci">void resetNeuronStatistics()</div><div class="ttdoc">Reset neuron statistics for all elements.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01801">Training.cpp:1801</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a807a4cf41842f8225d88f1848f1ef6ee"><div class="ttname"><a href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00104">Atom.h:104</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_a357dcaa8cac497e973ab9048f0aa00c2"><div class="ttname"><a href="classnnp_1_1Mode.html#a357dcaa8cac497e973ab9048f0aa00c2">nnp::Mode::setupSymmetryFunctionCache</a></div><div class="ttdeci">virtual void setupSymmetryFunctionCache(bool verbose=false)</div><div class="ttdoc">Set up symmetry function cache.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l00804">Mode.cpp:804</a></div></div>
<div class="ttc" id="aclassnnp_1_1GradientDescent_html_a54d38d540466c376ccd73014954de27ea64d014e31fc1b88e2f4fcec133340c6e"><div class="ttname"><a href="classnnp_1_1GradientDescent.html#a54d38d540466c376ccd73014954de27ea64d014e31fc1b88e2f4fcec133340c6e">nnp::GradientDescent::DT_ADAM</a></div><div class="ttdeci">@ DT_ADAM</div><div class="ttdoc">Adaptive moment estimation (Adam).</div><div class="ttdef"><b>Definition:</b> <a href="GradientDescent_8h_source.html#l00038">GradientDescent.h:38</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a639e7546c166a0b5530ad707e08f626e"><div class="ttname"><a href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626e">nnp::Training::UpdaterType</a></div><div class="ttdeci">UpdaterType</div><div class="ttdoc">Type of update routine.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00039">Training.h:39</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a7427bd5388a7c72eec65e8a2407cb7f7"><div class="ttname"><a href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates</a></div><div class="ttdeci">void sortUpdateCandidates(std::string const &amp;property)</div><div class="ttdoc">Sort update candidates with descending RMSE.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l01846">Training.cpp:1846</a></div></div>
<div class="ttc" id="aclassnnp_1_1Mode_html_add11e3c30eb86aba38d8239d1e5d8736"><div class="ttname"><a href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions</a></div><div class="ttdeci">void calculateSymmetryFunctions(Structure &amp;structure, bool const derivatives)</div><div class="ttdoc">Calculate all symmetry functions for all atoms in given structure.</div><div class="ttdef"><b>Definition:</b> <a href="Mode_8cpp_source.html#l01150">Mode.cpp:1150</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a9920793c17beef42f87017464599f464"><div class="ttname"><a href="classnnp_1_1Training.html#a9920793c17beef42f87017464599f464">nnp::Training::writeTimingData</a></div><div class="ttdeci">void writeTimingData(bool append, std::string const fileName=&quot;timing.out&quot;)</div><div class="ttdoc">Write timing data for all clocks.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l03318">Training.cpp:3318</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a></div><div class="ttdeci">@ ST_TEST</div><div class="ttdoc">Structure is part of the test set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00050">Structure.h:50</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a111011beb9eb1fb43550139a615b2b39"><div class="ttname"><a href="classnnp_1_1Training.html#a111011beb9eb1fb43550139a615b2b39">nnp::Training::randomizeNeuralNetworkWeights</a></div><div class="ttdeci">void randomizeNeuralNetworkWeights(std::string const &amp;type)</div><div class="ttdoc">Randomly initialize specificy neural network weights.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8cpp_source.html#l02941">Training.cpp:2941</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417"><div class="ttname"><a href="classnnp_1_1Training.html#a639e7546c166a0b5530ad707e08f626ea92b7166038c75081d932ec092d233417">nnp::Training::UT_KF</a></div><div class="ttdeci">@ UT_KF</div><div class="ttdoc">Kalman filter-based methods.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00044">Training.h:44</a></div></div>
<div class="ttc" id="aclassnnp_1_1Training_html_a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0"><div class="ttname"><a href="classnnp_1_1Training.html#a6671e3eb01b86af1162273218df0e5edad85fdfc89ea5507f703ce3f2eadee4e0">nnp::Training::PM_TRAIN_ALL</a></div><div class="ttdeci">@ PM_TRAIN_ALL</div><div class="ttdoc">Parallel gradient computation, update on each task.</div><div class="ttdef"><b>Definition:</b> <a href="Training_8h_source.html#l00080">Training.h:80</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_a2ef0a4a688a218d55ef061c6df659a4a"><div class="ttname"><a href="classnnp_1_1Dataset.html#a2ef0a4a688a218d55ef061c6df659a4a">nnp::Dataset::Dataset</a></div><div class="ttdeci">Dataset()</div><div class="ttdoc">Constructor, initialize members.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8cpp_source.html#l00036">Dataset.cpp:36</a></div></div>
<div class="ttc" id="aclassnnp_1_1Dataset_html_a0d03b673a86dbf7484f2da9e41872c2f"><div class="ttname"><a href="classnnp_1_1Dataset.html#a0d03b673a86dbf7484f2da9e41872c2f">nnp::Dataset::numStructures</a></div><div class="ttdeci">std::size_t numStructures</div><div class="ttdoc">Total number of structures in dataset.</div><div class="ttdef"><b>Definition:</b> <a href="Dataset_8h_source.html#l00200">Dataset.h:200</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacennp.html">nnp</a></li><li class="navelem"><a class="el" href="classnnp_1_1Training.html">Training</a></li>
    <li class="footer">Generated on Thu May 19 2022 21:58:10 for n2p2 - A neural network potential package by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
