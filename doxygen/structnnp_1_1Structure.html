<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>n2p2 - A neural network potential package: nnp::Structure Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">n2p2 - A neural network potential package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('structnnp_1_1Structure.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structnnp_1_1Structure-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nnp::Structure Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Storage for one atomic configuration.  
 <a href="structnnp_1_1Structure.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Structure_8h_source.html">Structure.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for nnp::Structure:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure__coll__graph.png" border="0" usemap="#nnp_1_1Structure_coll__map" alt="Collaboration graph"/></div>
<map name="nnp_1_1Structure_coll__map" id="nnp_1_1Structure_coll__map">
<area shape="rect" title="Storage for one atomic configuration." alt="" coords="711,399,824,425"/>
<area shape="rect" title=" " alt="" coords="250,149,437,176"/>
<area shape="rect" title=" " alt="" coords="19,105,79,132"/>
<area shape="rect" title=" " alt="" coords="15,291,82,317"/>
<area shape="rect" href="structnnp_1_1Vec3D.html" title="Vector in 3 dimensional real space." alt="" coords="296,321,391,348"/>
<area shape="rect" title=" " alt="" coords="324,372,363,399"/>
<area shape="rect" title="STL class." alt="" coords="5,441,92,468"/>
<area shape="rect" href="classnnp_1_1ElementMap.html" title="Contains element map." alt="" coords="275,485,411,512"/>
<area shape="rect" title=" " alt="" coords="318,556,369,583"/>
<area shape="rect" title=" " alt="" coords="293,607,394,633"/>
<area shape="rect" title=" " alt="" coords="249,657,437,684"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a118a744590977c2b258feace6dc6676e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a> { <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>, 
<a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>, 
<a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">ST_VALIDATION</a>, 
<a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a>
 }</td></tr>
<tr class="memdesc:a118a744590977c2b258feace6dc6676e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerates different sample types (e.g.  <a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">More...</a><br /></td></tr>
<tr class="separator:a118a744590977c2b258feace6dc6676e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac6c101b28efea5a150cce3bb8948f8d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure</a> ()</td></tr>
<tr class="memdesc:ac6c101b28efea5a150cce3bb8948f8d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, initializes to zero.  <a href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">More...</a><br /></td></tr>
<tr class="separator:ac6c101b28efea5a150cce3bb8948f8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57c375126ca37e8d390d406091e7dd5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap</a> (<a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> const &amp;<a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>)</td></tr>
<tr class="memdesc:a57c375126ca37e8d390d406091e7dd5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set element map of structure.  <a href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">More...</a><br /></td></tr>
<tr class="separator:a57c375126ca37e8d390d406091e7dd5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b676463d894c0988c645fed1ddf36b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom</a> (<a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;atom, std::string const &amp;element)</td></tr>
<tr class="memdesc:a7b676463d894c0988c645fed1ddf36b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a single atom to structure.  <a href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">More...</a><br /></td></tr>
<tr class="separator:a7b676463d894c0988c645fed1ddf36b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa794cf49a53d8e5db578ac303b700fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile</a> (std::string const fileName=&quot;input.data&quot;)</td></tr>
<tr class="memdesc:aaa794cf49a53d8e5db578ac303b700fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from file.  <a href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">More...</a><br /></td></tr>
<tr class="separator:aaa794cf49a53d8e5db578ac303b700fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8474b4633b73815022742af96b0a77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">readFromFile</a> (std::ifstream &amp;file)</td></tr>
<tr class="memdesc:a9d8474b4633b73815022742af96b0a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from file.  <a href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">More...</a><br /></td></tr>
<tr class="separator:a9d8474b4633b73815022742af96b0a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f4816f60d52e90cf213479ef443b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines</a> (std::vector&lt; std::string &gt; const &amp;lines)</td></tr>
<tr class="memdesc:ae3f4816f60d52e90cf213479ef443b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from lines.  <a href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">More...</a><br /></td></tr>
<tr class="separator:ae3f4816f60d52e90cf213479ef443b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6c70cf70dbbd3db3aa59497ca09f9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList</a> (double cutoffRadius)</td></tr>
<tr class="memdesc:ade6c70cf70dbbd3db3aa59497ca09f9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate neighbor list for all atoms.  <a href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">More...</a><br /></td></tr>
<tr class="separator:ade6c70cf70dbbd3db3aa59497ca09f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88970ff745896183b1029fb5719ff28a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">calculatePbcCopies</a> (double cutoffRadius)</td></tr>
<tr class="memdesc:a88970ff745896183b1029fb5719ff28a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate required PBC copies.  <a href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">More...</a><br /></td></tr>
<tr class="separator:a88970ff745896183b1029fb5719ff28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox</a> ()</td></tr>
<tr class="memdesc:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate inverse box.  <a href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">More...</a><br /></td></tr>
<tr class="separator:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f626682421d3690d8f1cb9ceba006f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume</a> ()</td></tr>
<tr class="memdesc:a10f626682421d3690d8f1cb9ceba006f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate volume from box vectors.  <a href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">More...</a><br /></td></tr>
<tr class="separator:a10f626682421d3690d8f1cb9ceba006f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3259977e4b66dbe020c2e827d10ab18c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap</a> (<a class="el" href="structnnp_1_1Atom.html">Atom</a> &amp;atom)</td></tr>
<tr class="memdesc:a3259977e4b66dbe020c2e827d10ab18c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate atom back into box if outside.  <a href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">More...</a><br /></td></tr>
<tr class="separator:a3259977e4b66dbe020c2e827d10ab18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd39fe39b2b0e86e676c7bd52dc2b835"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits</a> (double meanEnergy, double convEnergy, double convLength)</td></tr>
<tr class="memdesc:acd39fe39b2b0e86e676c7bd52dc2b835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize structure, shift energy and change energy and length unit.  <a href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">More...</a><br /></td></tr>
<tr class="separator:acd39fe39b2b0e86e676c7bd52dc2b835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041778a6c0a2f6d436852e2325c65d20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits</a> (double meanEnergy, double convEnergy, double convLength)</td></tr>
<tr class="memdesc:a041778a6c0a2f6d436852e2325c65d20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch to physical units, shift energy and change energy and length unit.  <a href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">More...</a><br /></td></tr>
<tr class="separator:a041778a6c0a2f6d436852e2325c65d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e79c2155e6dd905e7642c6cda008e6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">getMaxNumNeighbors</a> () const</td></tr>
<tr class="memdesc:a26e79c2155e6dd905e7642c6cda008e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find maximum number of neighbors.  <a href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">More...</a><br /></td></tr>
<tr class="separator:a26e79c2155e6dd905e7642c6cda008e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0f3518c376324d41786e29a7b5300d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms</a> (bool all)</td></tr>
<tr class="memdesc:a9a0f3518c376324d41786e29a7b5300d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free symmetry function memory for all atoms, see free() in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> class.  <a href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">More...</a><br /></td></tr>
<tr class="separator:a9a0f3518c376324d41786e29a7b5300d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6bf40715b7ffd70707baf5e95746ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset</a> ()</td></tr>
<tr class="memdesc:abf6bf40715b7ffd70707baf5e95746ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset everything but <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e" title="Copy of element map provided as constructor argument.">elementMap</a>.  <a href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">More...</a><br /></td></tr>
<tr class="separator:abf6bf40715b7ffd70707baf5e95746ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af289c389f76b4981aef3c92300aa668d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList</a> ()</td></tr>
<tr class="memdesc:af289c389f76b4981aef3c92300aa668d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear neighbor list of all atoms.  <a href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">More...</a><br /></td></tr>
<tr class="separator:af289c389f76b4981aef3c92300aa668d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add58b9575e3ae19f82991a445aec6b97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError</a> (std::string const &amp;property, std::map&lt; std::string, double &gt; &amp;error, std::size_t &amp;count) const</td></tr>
<tr class="memdesc:add58b9575e3ae19f82991a445aec6b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update property error metrics with this structure.  <a href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">More...</a><br /></td></tr>
<tr class="separator:add58b9575e3ae19f82991a445aec6b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b44fa434482a31e7453a739b84fc09"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine</a> () const</td></tr>
<tr class="memdesc:a96b44fa434482a31e7453a739b84fc09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN energy.  <a href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">More...</a><br /></td></tr>
<tr class="separator:a96b44fa434482a31e7453a739b84fc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a70e2e3f8368758300957a48ead3e2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">getForcesLines</a> () const</td></tr>
<tr class="memdesc:ac5a70e2e3f8368758300957a48ead3e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN forces for all atoms.  <a href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">More...</a><br /></td></tr>
<tr class="separator:ac5a70e2e3f8368758300957a48ead3e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">getChargesLines</a> () const</td></tr>
<tr class="memdesc:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN charges for all atoms.  <a href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">More...</a><br /></td></tr>
<tr class="separator:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b24f7e1e265a975b92a5895b09b77af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile</a> (std::string const fileName=&quot;output.data&quot;, bool const ref=true, bool const append=false) const</td></tr>
<tr class="memdesc:a4b24f7e1e265a975b92a5895b09b77af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to file.  <a href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">More...</a><br /></td></tr>
<tr class="separator:a4b24f7e1e265a975b92a5895b09b77af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ded940e3f99aa86b3fa75a37357a29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile</a> (std::ofstream *const &amp;file, bool const ref=true) const</td></tr>
<tr class="memdesc:a64ded940e3f99aa86b3fa75a37357a29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to file.  <a href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">More...</a><br /></td></tr>
<tr class="separator:a64ded940e3f99aa86b3fa75a37357a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8285382c3e2d908c8073a1fac315176b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:a8285382c3e2d908c8073a1fac315176b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to xyz file.  <a href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">More...</a><br /></td></tr>
<tr class="separator:a8285382c3e2d908c8073a1fac315176b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to POSCAR file.  <a href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">More...</a><br /></td></tr>
<tr class="separator:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar</a> (std::ofstream *const &amp;file, std::string const elements) const</td></tr>
<tr class="memdesc:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to POSCAR file.  <a href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">More...</a><br /></td></tr>
<tr class="separator:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d63337cd7d1a4e0058cd818543caef"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info</a> () const</td></tr>
<tr class="memdesc:af6d63337cd7d1a4e0058cd818543caef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get structure information as a vector of strings.  <a href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">More...</a><br /></td></tr>
<tr class="separator:af6d63337cd7d1a4e0058cd818543caef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a56766c6996fa1bf63e4616b7fd03c84e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a></td></tr>
<tr class="memdesc:a56766c6996fa1bf63e4616b7fd03c84e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy of element map provided as constructor argument.  <a href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">More...</a><br /></td></tr>
<tr class="separator:a56766c6996fa1bf63e4616b7fd03c84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a></td></tr>
<tr class="memdesc:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="mdescLeft">&#160;</td><td class="mdescRight">If periodic boundary conditions apply.  <a href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">More...</a><br /></td></tr>
<tr class="separator:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2627321edafea60f478b35e7387e0681"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a></td></tr>
<tr class="memdesc:a2627321edafea60f478b35e7387e0681"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the simulation box is triclinic.  <a href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">More...</a><br /></td></tr>
<tr class="separator:a2627321edafea60f478b35e7387e0681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21dfbdaf41e8332ee0f773a070f3f74"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a></td></tr>
<tr class="memdesc:af21dfbdaf41e8332ee0f773a070f3f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the neighbor list has been calculated.  <a href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">More...</a><br /></td></tr>
<tr class="separator:af21dfbdaf41e8332ee0f773a070f3f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a></td></tr>
<tr class="memdesc:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">If symmetry function values are saved for each atom.  <a href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">More...</a><br /></td></tr>
<tr class="separator:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f10399909e0f7fa8f6344c305781cc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a></td></tr>
<tr class="memdesc:a82f10399909e0f7fa8f6344c305781cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">If symmetry function derivatives are saved for each atom.  <a href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">More...</a><br /></td></tr>
<tr class="separator:a82f10399909e0f7fa8f6344c305781cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a></td></tr>
<tr class="memdesc:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index number of this structure.  <a href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">More...</a><br /></td></tr>
<tr class="separator:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c737c945e42ec42fa852e4dbacaf90"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a></td></tr>
<tr class="memdesc:ad2c737c945e42ec42fa852e4dbacaf90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of atoms present in this structure.  <a href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">More...</a><br /></td></tr>
<tr class="separator:ad2c737c945e42ec42fa852e4dbacaf90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a></td></tr>
<tr class="memdesc:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global number of elements (all structures).  <a href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">More...</a><br /></td></tr>
<tr class="separator:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fa28a5a6b564d3ec23a6905736730a"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a></td></tr>
<tr class="memdesc:ae2fa28a5a6b564d3ec23a6905736730a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements present in this structure.  <a href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">More...</a><br /></td></tr>
<tr class="separator:ae2fa28a5a6b564d3ec23a6905736730a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a> [3]</td></tr>
<tr class="memdesc:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of PBC images necessary in each direction.  <a href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">More...</a><br /></td></tr>
<tr class="separator:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a></td></tr>
<tr class="memdesc:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Potential energy determined by neural network.  <a href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">More...</a><br /></td></tr>
<tr class="separator:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee087b13af754a75198def4d12c8b61"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a></td></tr>
<tr class="memdesc:aaee087b13af754a75198def4d12c8b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference potential energy.  <a href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">More...</a><br /></td></tr>
<tr class="separator:aaee087b13af754a75198def4d12c8b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50427699538016623ef2331c9eb67f01"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a></td></tr>
<tr class="memdesc:a50427699538016623ef2331c9eb67f01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charge determined by neural network potential.  <a href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">More...</a><br /></td></tr>
<tr class="separator:a50427699538016623ef2331c9eb67f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65839bc1a3213a6d77e064b5edade786"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a></td></tr>
<tr class="memdesc:a65839bc1a3213a6d77e064b5edade786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference charge.  <a href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">More...</a><br /></td></tr>
<tr class="separator:a65839bc1a3213a6d77e064b5edade786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c6f2c95c4ca25893d2be192effff3d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a></td></tr>
<tr class="memdesc:ac8c6f2c95c4ca25893d2be192effff3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation box volume.  <a href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">More...</a><br /></td></tr>
<tr class="separator:ac8c6f2c95c4ca25893d2be192effff3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6665217897b26fa4fd01a07aa652cd2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a></td></tr>
<tr class="memdesc:a6665217897b26fa4fd01a07aa652cd2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample type (training or test set).  <a href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">More...</a><br /></td></tr>
<tr class="separator:a6665217897b26fa4fd01a07aa652cd2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d519c01388cad10212f64eda1fa6c8b"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a></td></tr>
<tr class="memdesc:a4d519c01388cad10212f64eda1fa6c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> comment.  <a href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">More...</a><br /></td></tr>
<tr class="separator:a4d519c01388cad10212f64eda1fa6c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e5cd213176fab9075b3f040dd6dee6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a> [3]</td></tr>
<tr class="memdesc:a21e5cd213176fab9075b3f040dd6dee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation box vectors.  <a href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">More...</a><br /></td></tr>
<tr class="separator:a21e5cd213176fab9075b3f040dd6dee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a177773f58df6da23d833e1cca0eb2cf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a> [3]</td></tr>
<tr class="memdesc:a177773f58df6da23d833e1cca0eb2cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverse simulation box vectors.  <a href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">More...</a><br /></td></tr>
<tr class="separator:a177773f58df6da23d833e1cca0eb2cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a></td></tr>
<tr class="memdesc:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of atoms of each element in this structure.  <a href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">More...</a><br /></td></tr>
<tr class="separator:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee965dec483f9479378a2ed4acd5544"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structnnp_1_1Atom.html">Atom</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a></td></tr>
<tr class="memdesc:adee965dec483f9479378a2ed4acd5544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of all atoms in this structure.  <a href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">More...</a><br /></td></tr>
<tr class="separator:adee965dec483f9479378a2ed4acd5544"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Storage for one atomic configuration. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00033">33</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a118a744590977c2b258feace6dc6676e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a118a744590977c2b258feace6dc6676e">&#9670;&nbsp;</a></span>SampleType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">nnp::Structure::SampleType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerates different sample types (e.g. </p>
<p>training or test set). </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381"></a>ST_UNKNOWN&#160;</td><td class="fielddoc"><p>Sample type not assigned yet. </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50"></a>ST_TRAINING&#160;</td><td class="fielddoc"><p><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of the training set. </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602"></a>ST_VALIDATION&#160;</td><td class="fielddoc"><p><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of validation set (currently unused). </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719"></a>ST_TEST&#160;</td><td class="fielddoc"><p><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of the test set. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00037">37</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">ST_VALIDATION</a>,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac6c101b28efea5a150cce3bb8948f8d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c101b28efea5a150cce3bb8948f8d1">&#9670;&nbsp;</a></span>Structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Structure::Structure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor, initializes to zero. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00030">30</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                     :</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>                    (<span class="keyword">false</span>     ),</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>                   (<span class="keyword">false</span>     ),</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>               (<span class="keyword">false</span>     ),</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>          (<span class="keyword">false</span>     ),</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>(<span class="keyword">false</span>     ),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>                         (0         ),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>                      (0         ),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>                   (0         ),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>            (0         ),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>                        (0.0       ),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>                     (0.0       ),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>                        (0.0       ),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>                     (0.0       ),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>                        (0.0       ),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>                    (<a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>                       (<span class="stringliteral">&quot;&quot;</span>        )</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[i] = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][0] = 0.0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][1] = 0.0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][2] = 0.0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][0] = 0.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][1] = 0.0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][2] = 0.0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, and <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a57c375126ca37e8d390d406091e7dd5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57c375126ca37e8d390d406091e7dd5a">&#9670;&nbsp;</a></span>setElementMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::setElementMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> const &amp;&#160;</td>
          <td class="paramname"><em>elementMap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set element map of structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">elementMap</td><td>Reference to a map containing all possible (symbol, index)-pairs (see <a class="el" href="classnnp_1_1ElementMap.html" title="Contains element map.">ElementMap</a>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00060">60</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    this-&gt;<a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a> = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a> = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.resize(<a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, and <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a78629b5a9034f2b06a4cd54a082e7ef0">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph" id="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph">
<area shape="rect" title="Set element map of structure." alt="" coords="5,5,228,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="276,5,447,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph" id="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph">
<area shape="rect" title="Set element map of structure." alt="" coords="375,137,597,163"/>
<area shape="rect" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd" title="Read data file and distribute structures among processors." alt="" coords="130,5,305,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a78629b5a9034f2b06a4cd54a082e7ef0" title="Initialize the LAMMPS interface." alt="" coords="133,71,301,112"/>
<area shape="rect" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,166,60,193"/>
<area shape="rect" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4" title="Prepare numeric force check for a single structure." alt="" coords="108,188,327,229"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="110,253,325,295"/>
</map>
</div>

</div>
</div>
<a id="a7b676463d894c0988c645fed1ddf36b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b676463d894c0988c645fed1ddf36b1">&#9670;&nbsp;</a></span>addAtom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::addAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>element</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a single atom to structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">atom</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> to insert. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">element</td><td><a class="el" href="classnnp_1_1Element.html" title="Contains element-specific data.">Element</a> string of new atom.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Be sure to set the element map properly before adding atoms. This function will only keep the atom's coordinates, energy, charge, tag and forces, all other members will be cleared or reset (in particular, the neighbor list and symmetry function data will be deleted). </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00069">69</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.push_back(<a class="code" href="structnnp_1_1Atom.html">Atom</a>());</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back() = atom;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// The number of elements may have changed.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numNeighborsPerElement.resize(<a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>(), 0);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().clearNeighborList();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().index                = <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().indexStructure       = <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().element              = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[element];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numSymmetryFunctions = 0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>++;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[<a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[element]]++;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, and <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph" id="structnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph">
<area shape="rect" title="Add a single atom to structure." alt="" coords="5,5,185,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="233,5,404,32"/>
</map>
</div>

</div>
</div>
<a id="aaa794cf49a53d8e5db578ac303b700fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa794cf49a53d8e5db578ac303b700fd">&#9670;&nbsp;</a></span>readFromFile() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromFile </td>
          <td>(</td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;input.data&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Input file name.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads the first configuration found in the input file. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00086">86</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ifstream file;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    file.open(fileName.c_str());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (!file.is_open())</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                            + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile</a>(file);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    file.close();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph.png" border="0" usemap="#structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph" id="structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph">
<area shape="rect" title="Read configuration from file." alt="" coords="268,71,475,98"/>
<area shape="rect" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd" title="Read data file and distribute structures among processors." alt="" coords="25,5,200,47"/>
<area shape="rect" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="85,71,140,98"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="5,123,220,164"/>
</map>
</div>

</div>
</div>
<a id="a9d8474b4633b73815022742af96b0a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8474b4633b73815022742af96b0a77">&#9670;&nbsp;</a></span>readFromFile() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromFile </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>Input file stream (already opened).</td></tr>
  </table>
  </dd>
</dl>
<p>Expects that a file with configurations is open, first keyword on first line should be <code>begin</code>. Reads until keyword is <code>end</code>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00102">102</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">string</span>         line;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    vector&lt;string&gt; lines;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    vector&lt;string&gt; splitLine;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// read first line, should be keyword &quot;begin&quot;.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    getline(file, line);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    lines.push_back(line);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    splitLine = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(line));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (splitLine.at(0) != <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected file content, expected&quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            <span class="stringliteral">&quot; \&quot;begin\&quot; keyword.\n&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">while</span> (getline(file, line))</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        lines.push_back(line);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        splitLine = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(line));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;end&quot;</span>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines</a>(lines);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce()</a>, and <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph" id="structnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph">
<area shape="rect" title="Read configuration from file." alt="" coords="5,32,212,59"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="260,25,443,66"/>
<area shape="rect" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93" title="Replace multiple whitespaces with fill." alt="" coords="491,5,589,32"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="499,60,581,87"/>
</map>
</div>

</div>
</div>
<a id="ae3f4816f60d52e90cf213479ef443b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f4816f60d52e90cf213479ef443b32">&#9670;&nbsp;</a></span>readFromLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromLines </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt; const &amp;&#160;</td>
          <td class="paramname"><em>lines</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from lines. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lines</td><td>One configuration in form of a vector of strings.</td></tr>
  </table>
  </dd>
</dl>
<p>Read the configuration from a vector of strings. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00131">131</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">size_t</span>         iBoxVector = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    vector&lt;string&gt; splitLine;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// read first line, should be keyword &quot;begin&quot;.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    splitLine = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(lines.at(0)));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (splitLine.at(0) != <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected line content, expected&quot;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                            <span class="stringliteral">&quot; \&quot;begin\&quot; keyword.\n&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">for</span> (vector&lt;string&gt;::const_iterator line = lines.begin();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         line != lines.end(); ++line)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        splitLine = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(*line));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;comment&quot;</span>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordtype">size_t</span> position = line-&gt;find(<span class="stringliteral">&quot;comment&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordtype">string</span> tmpLine = *line;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a> = tmpLine.erase(position, splitLine.at(0).length() + 1);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;lattice&quot;</span>)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">if</span> (iBoxVector &gt; 2)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Too many box vectors.\n&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][0] = atof(splitLine.at(1).c_str());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][1] = atof(splitLine.at(2).c_str());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][2] = atof(splitLine.at(3).c_str());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            iBoxVector++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">if</span> (iBoxVector == 3)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] &gt; numeric_limits&lt;double&gt;::min())</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <a class="code" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <a class="code" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox</a>();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <a class="code" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;atom&quot;</span>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.push_back(<a class="code" href="structnnp_1_1Atom.html">Atom</a>());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().index          = <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().indexStructure = <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().tag            = <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; <span class="comment">// Implicit conversion!</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[0]           = atof(splitLine.at(1).c_str());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[1]           = atof(splitLine.at(2).c_str());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[2]           = atof(splitLine.at(3).c_str());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().element        = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[splitLine.at(4)];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().chargeRef      = atof(splitLine.at(5).c_str());</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[0]        = atof(splitLine.at(7).c_str());</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[1]        = atof(splitLine.at(8).c_str());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[2]        = atof(splitLine.at(9).c_str());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numNeighborsPerElement.resize(<a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>++;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[<a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[splitLine.at(4)]]++;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = atof(splitLine[1].c_str());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a> = atof(splitLine[1].c_str());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;end&quot;</span>)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">if</span> (!(iBoxVector == 0 || iBoxVector == 3))</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Strange number of box vectors.\n&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected file content, &quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                <span class="stringliteral">&quot;unknown keyword \&quot;&quot;</span> + splitLine.at(0) +</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>; i++)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[i] &gt; 0)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>++;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;             it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap</a>((*it));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce()</a>, <a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap()</a>, and <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">readFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph.png" border="0" usemap="#structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph" id="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph">
<area shape="rect" title="Read configuration from lines." alt="" coords="5,129,188,171"/>
<area shape="rect" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3" title="Calculate inverse box." alt="" coords="236,5,416,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f" title="Calculate volume from box vectors." alt="" coords="236,71,416,112"/>
<area shape="rect" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93" title="Replace multiple whitespaces with fill." alt="" coords="277,137,375,163"/>
<area shape="rect" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c" title="Translate atom back into box if outside." alt="" coords="245,187,407,214"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="285,238,367,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph.png" border="0" usemap="#structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph" id="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph">
<area shape="rect" title="Read configuration from lines." alt="" coords="260,5,443,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77" title="Read configuration from file." alt="" coords="5,13,212,39"/>
</map>
</div>

</div>
</div>
<a id="ade6c70cf70dbbd3db3aa59497ca09f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6c70cf70dbbd3db3aa59497ca09f9c">&#9670;&nbsp;</a></span>calculateNeighborList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateNeighborList </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate neighbor list for all atoms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>Atoms are neighbors if there distance is smaller than the cutoff radius. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00245">245</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">calculatePbcCopies</a>(cutoffRadius);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">// Use square of cutoffRadius (faster).</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        cutoffRadius *= cutoffRadius;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">        #pragma omp parallel for private(i)</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">// Count atom i as unique neighbor.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(i);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; j++)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc0 = -<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]; bc0 &lt;= <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]; bc0++)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc1 = -<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]; bc1 &lt;= <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]; bc1++)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc2 = -<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]; bc2 &lt;= <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]; bc2++)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                            <span class="keywordflow">if</span> (!(i == j &amp;&amp; bc0 == 0 &amp;&amp; bc1 == 0 &amp;&amp; bc2 == 0))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                            {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> dr = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].r - <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].r</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                         + bc0 * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0]</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                         + bc1 * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                         + bc2 * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2];</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                <span class="keywordflow">if</span> (dr.<a class="code" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">norm2</a>() &lt;= cutoffRadius)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                        push_back(<a class="code" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a>());</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                        back().index = j;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                        back().tag = j; <span class="comment">// Implicit conversion!</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                        back().element = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                        back().d = dr.<a class="code" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">norm</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                        back().dr = dr;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsPerElement[</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element]++;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighbors++;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                    <span class="comment">// Count atom j only once as unique</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                    <span class="comment">// neighbor.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.back() != j &amp;&amp;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                        i != j)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                    {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(j);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                            }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].hasNeighborList = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Use square of cutoffRadius (faster).</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        cutoffRadius *= cutoffRadius;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">        #pragma omp parallel for private(i)</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">// Count atom i as unique neighbor.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(i);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; j++)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">if</span> (i != j)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> dr = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].r - <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].r;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">if</span> (dr.<a class="code" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">norm2</a>() &lt;= cutoffRadius)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.push_back(<a class="code" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a>());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().index   = j;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().tag     = j; <span class="comment">// Impl. conv.!</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().element = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().d       = dr.<a class="code" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">norm</a>();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().dr      = dr;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsPerElement[<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element]++;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighbors++;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(j);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].hasNeighborList = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">nnp::Vec3D::norm()</a>, <a class="el" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">nnp::Vec3D::norm2()</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_cgraph.png" border="0" usemap="#structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_cgraph" id="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_cgraph">
<area shape="rect" title="Calculate neighbor list for all atoms." alt="" coords="5,64,185,105"/>
<area shape="rect" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a" title="Calculate required PBC copies." alt="" coords="233,5,413,47"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399" title="Calculate norm of vector." alt="" coords="255,71,392,98"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251" title="Calculate square of norm of vector." alt="" coords="251,122,396,149"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_icgraph.png" border="0" usemap="#structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_icgraph" id="structnnp_1_1Structure_ade6c70cf70dbbd3db3aa59497ca09f9c_icgraph">
<area shape="rect" title="Calculate neighbor list for all atoms." alt="" coords="225,23,405,65"/>
<area shape="rect" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="64,5,119,32"/>
<area shape="rect" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858" title=" " alt="" coords="5,56,177,83"/>
</map>
</div>

</div>
</div>
<a id="a88970ff745896183b1029fb5719ff28a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88970ff745896183b1029fb5719ff28a">&#9670;&nbsp;</a></span>calculatePbcCopies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculatePbcCopies </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate required PBC copies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>Cutoff radius for neighbor list.</td></tr>
  </table>
  </dd>
</dl>
<p>Called by <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c" title="Calculate neighbor list for all atoms.">calculateNeighborList()</a>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00367">367</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> axb;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> axc;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> bxc;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    axb = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]).<a class="code" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    axc = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    bxc = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1].<a class="code" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">double</span> proja = fabs(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] * bxc);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">double</span> projb = fabs(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] * axc);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">double</span> projc = fabs(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] * axb);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0] = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1] = 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2] = 0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0] * proja &lt;= cutoffRadius)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]++;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1] * projb &lt;= cutoffRadius)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]++;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2] * projc &lt;= cutoffRadius)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]++;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">nnp::Vec3D::cross()</a>, <a class="el" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">nnp::Vec3D::normalize()</a>, and <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_cgraph" id="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_cgraph">
<area shape="rect" title="Calculate required PBC copies." alt="" coords="5,23,185,65"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc" title="Cross product, argument vector is second in product." alt="" coords="249,5,386,32"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741" title="Normalize vector, norm equals 1.0 afterwards." alt="" coords="233,56,401,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_icgraph" id="structnnp_1_1Structure_a88970ff745896183b1029fb5719ff28a_icgraph">
<area shape="rect" title="Calculate required PBC copies." alt="" coords="233,5,413,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c" title="Calculate neighbor list for all atoms." alt="" coords="5,5,185,47"/>
</map>
</div>

</div>
</div>
<a id="a7d4ec60f305ae52787eb7dc0995eaec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d4ec60f305ae52787eb7dc0995eaec3">&#9670;&nbsp;</a></span>calculateInverseBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateInverseBox </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate inverse box. </p>
<p>Simulation box looks like this:</p>
<p class="formulaDsp">
\[ h = \begin{pmatrix} \phantom{a_x} &amp; \phantom{b_x} &amp; \phantom{c_x} \\ \vec{\mathbf{a}} &amp; \vec{\mathbf{b}} &amp; \vec{\mathbf{c}} \\ \phantom{a_z} &amp; \phantom{b_z} &amp; \phantom{c_z} \\ \end{pmatrix} = \begin{pmatrix} a_x &amp; b_x &amp; c_x \\ a_y &amp; b_y &amp; c_y \\ a_z &amp; b_z &amp; c_z \\ \end{pmatrix}, \]
</p>
<p>where \(\vec{\mathbf{a}} = \) <code>box[0]</code>, \(\vec{\mathbf{b}} = \) <code>box[1]</code> and \(\vec{\mathbf{c}} = \) <code>box[2]</code>. Thus, indices are column first, row second:</p>
<p class="formulaDsp">
\[ h = \begin{pmatrix} \texttt{box[0][0]} &amp; \texttt{box[1][0]} &amp; \texttt{box[2][0]} \\ \texttt{box[0][1]} &amp; \texttt{box[1][1]} &amp; \texttt{box[2][1]} \\ \texttt{box[0][2]} &amp; \texttt{box[1][2]} &amp; \texttt{box[2][2]} \\ \end{pmatrix}. \]
</p>
<p>The inverse box matrix (same scheme as above but with <code>invbox</code>) can be used to calculate fractional coordinates:</p>
<p class="formulaDsp">
\[ \begin{pmatrix} f_0 \\ f_1 \\ f_2 \end{pmatrix} = h^{-1} \; \vec{\mathbf{r}}. \]
</p>
 
<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00400">400</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">double</span> invdet = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                  + <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  + <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                  - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                  - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                  - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    invdet = 1.0 / invdet;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][0] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][1] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][2] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] *= invdet;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][0] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][1] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2];</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][2] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] *= invdet;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][0] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][1] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][2] = <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] - <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] *= invdet;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, and <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph" id="structnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph">
<area shape="rect" title="Calculate inverse box." alt="" coords="236,5,416,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a10f626682421d3690d8f1cb9ceba006f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f626682421d3690d8f1cb9ceba006f">&#9670;&nbsp;</a></span>calculateVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateVolume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate volume from box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00428">428</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;{</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> = fabs(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] * (<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1].cross(<a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2])));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph" id="structnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph">
<area shape="rect" title="Calculate volume from box vectors." alt="" coords="236,5,416,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a3259977e4b66dbe020c2e827d10ab18c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3259977e4b66dbe020c2e827d10ab18c">&#9670;&nbsp;</a></span>remap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::remap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate atom back into box if outside. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atom</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> to be remapped. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00435">435</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="structnnp_1_1Vec3D.html">Vec3D</a> f = atom.<a class="code" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[0] * <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0]</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            + atom.<a class="code" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[1] * <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1]</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            + atom.<a class="code" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[2] * <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// Quick and dirty... there may be a more elegant way!</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (f[0] &gt; 1.0) f[0] -= (int)f[0];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (f[1] &gt; 1.0) f[1] -= (int)f[1];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (f[2] &gt; 1.0) f[2] -= (int)f[2];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (f[0] &lt; 0.0) f[0] += 1.0 - (int)f[0];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (f[1] &lt; 0.0) f[1] += 1.0 - (int)f[1];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (f[2] &lt; 0.0) f[2] += 1.0 - (int)f[2];</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (f[0] == 1.0) f[0] = 0.0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (f[1] == 1.0) f[1] = 0.0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (f[2] == 1.0) f[2] = 0.0;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    atom.<a class="code" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> = f[0] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0]</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;           + f[1] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;           + f[2] * <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, and <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, and <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a3259977e4b66dbe020c2e827d10ab18c_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a3259977e4b66dbe020c2e827d10ab18c_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a3259977e4b66dbe020c2e827d10ab18c_icgraph" id="structnnp_1_1Structure_a3259977e4b66dbe020c2e827d10ab18c_icgraph">
<area shape="rect" title="Translate atom back into box if outside." alt="" coords="272,46,435,73"/>
<area shape="rect" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4" title="Prepare numeric force check for a single structure." alt="" coords="5,5,224,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="23,71,206,112"/>
</map>
</div>

</div>
</div>
<a id="acd39fe39b2b0e86e676c7bd52dc2b835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd39fe39b2b0e86e676c7bd52dc2b835">&#9670;&nbsp;</a></span>toNormalizedUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::toNormalizedUnits </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>meanEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalize structure, shift energy and change energy and length unit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">meanEnergy</td><td>Mean energy per atom (in old units). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convEnergy</td><td>Multiplicative energy unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convLength</td><td>Multiplicative length unit conversion factor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00461">461</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] *= convLength;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] *= convLength;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] *= convLength;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] /= convLength;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] /= convLength;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] /= convLength;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = (<a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy) * convEnergy;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> = (<a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> - <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy) * convEnergy;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> *= convLength * convLength * convLength;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        it-&gt;toNormalizedUnits(convEnergy, convLength);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a">nnp::Mode::convertToNormalizedUnits()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_acd39fe39b2b0e86e676c7bd52dc2b835_icgraph.png" border="0" usemap="#structnnp_1_1Structure_acd39fe39b2b0e86e676c7bd52dc2b835_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_acd39fe39b2b0e86e676c7bd52dc2b835_icgraph" id="structnnp_1_1Structure_acd39fe39b2b0e86e676c7bd52dc2b835_icgraph">
<area shape="rect" title="Normalize structure, shift energy and change energy and length unit." alt="" coords="289,39,499,80"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a" title="Convert one structure to normalized units." alt="" coords="5,5,241,47"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="16,71,231,112"/>
</map>
</div>

</div>
</div>
<a id="a041778a6c0a2f6d436852e2325c65d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041778a6c0a2f6d436852e2325c65d20">&#9670;&nbsp;</a></span>toPhysicalUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::toPhysicalUnits </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>meanEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch to physical units, shift energy and change energy and length unit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">meanEnergy</td><td>Mean energy per atom (in old units). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convEnergy</td><td>Multiplicative energy unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convLength</td><td>Multiplicative length unit conversion factor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00487">487</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] /= convLength;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] /= convLength;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] /= convLength;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] *= convLength;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] *= convLength;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] *= convLength;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> / convEnergy + <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> = <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> / convEnergy + <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> /= convLength * convLength * convLength;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        it-&gt;toPhysicalUnits(convEnergy, convLength);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">nnp::Mode::convertToPhysicalUnits()</a>, and <a class="el" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a041778a6c0a2f6d436852e2325c65d20_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a041778a6c0a2f6d436852e2325c65d20_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a041778a6c0a2f6d436852e2325c65d20_icgraph" id="structnnp_1_1Structure_a041778a6c0a2f6d436852e2325c65d20_icgraph">
<area shape="rect" title="Switch to physical units, shift energy and change energy and length unit." alt="" coords="268,35,456,76"/>
<area shape="rect" href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6" title="Convert one structure to physical units." alt="" coords="5,5,220,47"/>
<area shape="rect" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858" title=" " alt="" coords="27,71,199,98"/>
</map>
</div>

</div>
</div>
<a id="a26e79c2155e6dd905e7642c6cda008e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e79c2155e6dd905e7642c6cda008e6">&#9670;&nbsp;</a></span>getMaxNumNeighbors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Structure::getMaxNumNeighbors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find maximum number of neighbors. </p>
<dl class="section return"><dt>Returns</dt><dd>Maximum numbor of neighbors of all atoms in this structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00354">354</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">size_t</span> maxNumNeighbors = 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span>(vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        maxNumNeighbors = max(maxNumNeighbors, it-&gt;numNeighbors);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> maxNumNeighbors;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a9a0f3518c376324d41786e29a7b5300d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0f3518c376324d41786e29a7b5300d">&#9670;&nbsp;</a></span>freeAtoms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::freeAtoms </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>all</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free symmetry function memory for all atoms, see free() in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">all</td><td>See description in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00513">513</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        it-&gt;free(all);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (all) <a class="code" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, and <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a9a0f3518c376324d41786e29a7b5300d_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a9a0f3518c376324d41786e29a7b5300d_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a9a0f3518c376324d41786e29a7b5300d_icgraph" id="structnnp_1_1Structure_a9a0f3518c376324d41786e29a7b5300d_icgraph">
<area shape="rect" title="Free symmetry function memory for all atoms, see free() in Atom class." alt="" coords="212,5,401,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,5,164,32"/>
</map>
</div>

</div>
</div>
<a id="abf6bf40715b7ffd70707baf5e95746ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf6bf40715b7ffd70707baf5e95746ce">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset everything but <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e" title="Copy of element map provided as constructor argument.">elementMap</a>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00525">525</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>                     = false     ;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>                    = false     ;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>                = false     ;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>           = false     ;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = false     ;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>                          = 0         ;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>                       = 0         ;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>             = 0         ;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>                         = 0.0       ;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>                      = 0.0       ;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>                         = 0.0       ;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>                      = 0.0       ;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>                         = 0.0       ;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>                     = <a class="code" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>                        = <span class="stringliteral">&quot;&quot;</span>        ;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[i] = 0;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 3; ++j)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][j] = 0.0;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][j] = 0.0;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a> = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.clear();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.resize(<a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.clear();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    vector&lt;Atom&gt;(<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>).swap(<a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>, <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph.png" border="0" usemap="#structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph" id="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph">
<area shape="rect" title="Reset everything but elementMap." alt="" coords="5,5,160,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="208,5,379,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph.png" border="0" usemap="#structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph" id="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph">
<area shape="rect" title="Reset everything but elementMap." alt="" coords="268,35,423,61"/>
<area shape="rect" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="85,5,140,32"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="5,57,220,98"/>
</map>
</div>

</div>
</div>
<a id="af289c389f76b4981aef3c92300aa668d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af289c389f76b4981aef3c92300aa668d">&#9670;&nbsp;</a></span>clearNeighborList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::clearNeighborList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear neighbor list of all atoms. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00562">562</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;{</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="structnnp_1_1Atom.html">Atom</a>&amp; a = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">// This may have changed if atoms are added via addAtoms().</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        a.<a class="code" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">numNeighborsPerElement</a>.resize(<a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        a.<a class="code" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">clearNeighborList</a>();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">nnp::Atom::clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, and <a class="el" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph.png" border="0" usemap="#structnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph" id="structnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph">
<area shape="rect" title="Clear neighbor list of all atoms." alt="" coords="5,5,240,32"/>
<area shape="rect" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d" title="Clear neighbor list." alt="" coords="288,5,499,32"/>
</map>
</div>

</div>
</div>
<a id="add58b9575e3ae19f82991a445aec6b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add58b9575e3ae19f82991a445aec6b97">&#9670;&nbsp;</a></span>updateError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::updateError </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update property error metrics with this structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td>One of "energy", "force" or "charge". </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">error</td><td>Input error metric map to be updated. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">count</td><td>Input counter to be updated.</td></tr>
  </table>
  </dd>
</dl>
<p>The "energy" error metric map stores temporary sums for the following metrics:</p>
<p>key "RMSEpa": RMSE of energy per atom key "RMSE" : RMSE of energy key "MAEpa" : MAE of energy per atom key "MAE" : MAE of energy</p>
<p>The "force" error metric map stores temporary sums for the following metrics:</p>
<p>key "RMSE" : RMSE of forces key "MAE" : MAE of forces</p>
<p>The "charge" error metric map stores temporary sums for the following metrics:</p>
<p>key "RMSE" : RMSE of charges key "MAE" : MAE of charges </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00578">578</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;{</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        count++;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordtype">double</span> diff = <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        error.at(<span class="stringliteral">&quot;RMSEpa&quot;</span>) += diff * diff / (<a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        error.at(<span class="stringliteral">&quot;RMSE&quot;</span>) += diff * diff;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        diff = fabs(diff);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        error.at(<span class="stringliteral">&quot;MAEpa&quot;</span>) += diff / <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        error.at(<span class="stringliteral">&quot;MAE&quot;</span>) += diff;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;force&quot;</span> || property == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;             it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            it-&gt;updateError(property, error, count);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown property for error update.\n&quot;</span>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

</div>
</div>
<a id="a96b44fa434482a31e7453a739b84fc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b44fa434482a31e7453a739b84fc09">&#9670;&nbsp;</a></span>getEnergyLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Structure::getEnergyLine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN energy. </p>
<dl class="section return"><dt>Returns</dt><dd>String with <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6" title="Index number of this structure.">index</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61" title="Reference potential energy.">energyRef</a> and <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5" title="Potential energy determined by neural network.">energy</a> values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00608">608</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;{</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%10zu %16.8E %16.8E\n&quot;</span>,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                 <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                 <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> / <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                 <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> / <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph" id="structnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph">
<area shape="rect" title="Get reference and NN energy." alt="" coords="5,5,220,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="268,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="ac5a70e2e3f8368758300957a48ead3e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a70e2e3f8368758300957a48ead3e2">&#9670;&nbsp;</a></span>getForcesLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::getForcesLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN forces for all atoms. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector of strings with force comparison. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00616">616</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    vector&lt;string&gt; v;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;         it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        vector&lt;string&gt; va = it-&gt;getForcesLines();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        v.insert(v.end(), va.begin(), va.end());</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a6477ccc1b4338e4e2e44a5da7ab49741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6477ccc1b4338e4e2e44a5da7ab49741">&#9670;&nbsp;</a></span>getChargesLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::getChargesLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN charges for all atoms. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector of strings with charge comparison. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00629">629</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;{</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    vector&lt;string&gt; v;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        v.push_back(it-&gt;getChargeLine());</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a4b24f7e1e265a975b92a5895b09b77af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b24f7e1e265a975b92a5895b09b77af">&#9670;&nbsp;</a></span>writeToFile() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFile </td>
          <td>(</td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;output.data&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>append</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fileName</td><td>Ouptut file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, write reference energy and forces, if false, write NNP results instead. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>If true, append to existing file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00641">641</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;{</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    ofstream file;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> (append)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        file.open(fileName.c_str(), ofstream::app);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        file.open(fileName.c_str());</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span> (!file.is_open())</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                            + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile</a>(&amp;file, ref );</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    file.close();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph" id="structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph">
<area shape="rect" title="Write configuration to file." alt="" coords="108,5,299,32"/>
<area shape="rect" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a64ded940e3f99aa86b3fa75a37357a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64ded940e3f99aa86b3fa75a37357a29">&#9670;&nbsp;</a></span>writeToFile() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFile </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>Ouptut file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, write reference energy and forces, if false, write NNP results instead. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00666">666</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;{</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        runtime_error(<span class="stringliteral">&quot;ERROR: Cannot write to file, file is not open.\n&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    (*file) &lt;&lt; <span class="stringliteral">&quot;begin\n&quot;</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;comment %s\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str());</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;lattice %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                             <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][2]);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> (ref)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atom %24.16E %24.16E %24.16E %2s %24.16E %24.16E&quot;</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                             <span class="stringliteral">&quot; %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                             it-&gt;r[0],</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                             it-&gt;r[1],</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                             it-&gt;r[2],</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                             <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                             it-&gt;chargeRef,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                             0.0,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                             it-&gt;fRef[0],</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                             it-&gt;fRef[1],</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                             it-&gt;fRef[2]);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atom %24.16E %24.16E %24.16E %2s %24.16E %24.16E&quot;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                             <span class="stringliteral">&quot; %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                             it-&gt;r[0],</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                             it-&gt;r[1],</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                             it-&gt;r[2],</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                             <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                             it-&gt;charge,</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                             0.0,</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                             it-&gt;f[0],</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                             it-&gt;f[1],</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                             it-&gt;f[2]);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">if</span> (ref) (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy %24.16E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">else</span>     (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy %24.16E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (ref) (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge %24.16E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">else</span>     (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge %24.16E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;end\n&quot;</span>);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph" id="structnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph">
<area shape="rect" title="Write configuration to file." alt="" coords="5,5,196,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="244,5,328,32"/>
</map>
</div>

</div>
</div>
<a id="a8285382c3e2d908c8073a1fac315176b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8285382c3e2d908c8073a1fac315176b">&#9670;&nbsp;</a></span>writeToFileXyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFileXyz </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to xyz file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>xyz output file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00725">725</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        runtime_error(<span class="stringliteral">&quot;ERROR: Could not write to file.\n&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        (*file) &lt;&lt; <span class="stringliteral">&quot;Lattice=\&quot;&quot;</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E &quot;</span>   ,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E &quot;</span>   ,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\&quot;\n&quot;</span>,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;         it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-2s %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                         it-&gt;r[0],</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                         it-&gt;r[1],</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                         it-&gt;r[2]);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph" id="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph">
<area shape="rect" title="Write configuration to xyz file." alt="" coords="5,5,220,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="268,5,352,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph" id="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph">
<area shape="rect" title="Write configuration to xyz file." alt="" coords="108,5,323,32"/>
<area shape="rect" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a7eaa3ccba6309f828c2444ee627d7ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eaa3ccba6309f828c2444ee627d7ee5">&#9670;&nbsp;</a></span>writeToFilePoscar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFilePoscar </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to POSCAR file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>POSCAR output file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements in POTCAR file must be ordered according to periodic table. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00760">760</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar</a>(file, <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">getElementsString</a>());</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, and <a class="el" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">nnp::ElementMap::getElementsString()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph" id="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="5,5,196,47"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a" title="Get sorted list of elements in one string (space separated)." alt="" coords="244,5,471,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph.png" border="0" usemap="#structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph" id="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="108,5,299,47"/>
<area shape="rect" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,13,60,39"/>
</map>
</div>

</div>
</div>
<a id="a5e1f59c24c85703e6e78c7f85d47a2d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1f59c24c85703e6e78c7f85d47a2d8">&#9670;&nbsp;</a></span>writeToFilePoscar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFilePoscar </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to POSCAR file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>POSCAR output file. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">elements</td><td>User-defined order of elements, e.g. "Zn O Cu". </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00767">767</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        runtime_error(<span class="stringliteral">&quot;ERROR: Could not write to file.\n&quot;</span>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    vector&lt;string&gt; ve = <a class="code" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(elements);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    vector&lt;size_t&gt; elementOrder;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ve.size(); ++i)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        elementOrder.push_back(<a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[ve.at(i)]);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (elementOrder.size() != <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>())</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        runtime_error(<span class="stringliteral">&quot;ERROR: Inconsistent element declaration.\n&quot;</span>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%s, &quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str());</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;ATOM=%s&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[elementOrder.at(0)].c_str());</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; elementOrder.size(); ++i)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %s&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[elementOrder.at(i)].c_str());</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    (*file) &lt;&lt; <span class="stringliteral">&quot;1.0\n&quot;</span>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                         <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        runtime_error(<span class="stringliteral">&quot;ERROR: Writing non-periodic structure to POSCAR file &quot;</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                      <span class="stringliteral">&quot;is not implemented.\n&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%d&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(elementOrder.at(0)));</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size(); ++i)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %d&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(elementOrder.at(i)));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    (*file) &lt;&lt; <span class="stringliteral">&quot;Cartesian\n&quot;</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; elementOrder.size(); ++i)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;             it != <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">if</span> (it-&gt;element == elementOrder.at(i))</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                (*file) &lt;&lt; <a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                 it-&gt;r[0],</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                 it-&gt;r[1],</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                 it-&gt;r[2]);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph.png" border="0" usemap="#structnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph" id="structnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="5,49,196,90"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="244,5,415,32"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="288,56,371,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="287,107,371,133"/>
</map>
</div>

</div>
</div>
<a id="af6d63337cd7d1a4e0058cd818543caef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6d63337cd7d1a4e0058cd818543caef">&#9670;&nbsp;</a></span>info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get structure information as a vector of strings. </p>
<dl class="section return"><dt>Returns</dt><dd>Lines with structure information. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00833">833</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;{</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    vector&lt;string&gt; v;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;STRUCTURE                       \n&quot;</span>));</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    vector&lt;string&gt; vm = <a class="code" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">info</a>();</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    v.insert(v.end(), vm.begin(), vm.end());</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;index                          : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>));</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;isPeriodic                     : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>        ));</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;isTriclinic                    : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>       ));</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasNeighborList                : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>   ));</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasSymmetryFunctions           : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>));</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasSymmetryFunctionDerivatives : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>));</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numAtoms                       : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>          ));</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numElements                    : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>       ));</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numElementsPresent             : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>));</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;pbc                            : %d %d %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0], <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1], <a class="code" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]));</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy                         : %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>        ));</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energyRef                      : %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>     ));</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge                         : %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>        ));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;chargeRef                      : %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>     ));</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;volume                         : %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>        ));</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;sampleType                     : %d\n&quot;</span>, (<span class="keywordtype">int</span>)<a class="code" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>));</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;comment                        : %s\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str()   ));</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[0]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]));</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[1]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]));</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[2]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[0]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][0], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][1], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][2]));</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[1]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][0], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][1], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][2]));</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[2]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][0], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][1], <a class="code" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][2]));</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numAtomsPerElement         [*] : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size()));</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size(); ++i)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%29d  : %d\n&quot;</span>, i, <a class="code" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atoms                      [*] : %d\n&quot;</span>, <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size()));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%29d  :\n&quot;</span>, i));</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        vector&lt;string&gt; va = <a class="code" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].info();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        v.insert(v.end(), va.begin(), va.end());</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    v.push_back(<a class="code" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">nnp::ElementMap::info()</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph.png" border="0" usemap="#structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph" alt=""/></div>
<map name="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph" id="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph">
<area shape="rect" title="Get structure information as a vector of strings." alt="" coords="5,31,152,57"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b" title="Get map information as a vector of strings." alt="" coords="200,5,369,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="417,31,501,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph.png" border="0" usemap="#structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph" alt=""/></div>
<map name="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph" id="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph">
<area shape="rect" title="Get structure information as a vector of strings." alt="" coords="108,5,255,32"/>
<area shape="rect" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a56766c6996fa1bf63e4616b7fd03c84e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56766c6996fa1bf63e4616b7fd03c84e">&#9670;&nbsp;</a></span>elementMap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> nnp::Structure::elementMap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy of element map provided as constructor argument. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00054">54</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a4d8ebcacb8fc434178c7c90cb2f70110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8ebcacb8fc434178c7c90cb2f70110">&#9670;&nbsp;</a></span>isPeriodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::isPeriodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If periodic boundary conditions apply. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00056">56</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a2627321edafea60f478b35e7387e0681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2627321edafea60f478b35e7387e0681">&#9670;&nbsp;</a></span>isTriclinic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::isTriclinic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the simulation box is triclinic. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00058">58</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, and <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>.</p>

</div>
</div>
<a id="af21dfbdaf41e8332ee0f773a070f3f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af21dfbdaf41e8332ee0f773a070f3f74">&#9670;&nbsp;</a></span>hasNeighborList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasNeighborList</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the neighbor list has been calculated. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00060">60</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="aff934fe32fb46e93dd9551d50ed4b0b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff934fe32fb46e93dd9551d50ed4b0b6">&#9670;&nbsp;</a></span>hasSymmetryFunctions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasSymmetryFunctions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If symmetry function values are saved for each atom. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00062">62</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="a82f10399909e0f7fa8f6344c305781cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82f10399909e0f7fa8f6344c305781cc">&#9670;&nbsp;</a></span>hasSymmetryFunctionDerivatives</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasSymmetryFunctionDerivatives</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If symmetry function derivatives are saved for each atom. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00064">64</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="a5af7b5cd0a2154c2e34a3b8a73a51ca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af7b5cd0a2154c2e34a3b8a73a51ca6">&#9670;&nbsp;</a></span>index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::index</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index number of this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00066">66</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="ad2c737c945e42ec42fa852e4dbacaf90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c737c945e42ec42fa852e4dbacaf90">&#9670;&nbsp;</a></span>numAtoms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numAtoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total number of atoms present in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00068">68</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="ad47f8d1a1742f5430418fcd1b8919eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47f8d1a1742f5430418fcd1b8919eb6">&#9670;&nbsp;</a></span>numElements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numElements</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global number of elements (all structures). </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00070">70</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>.</p>

</div>
</div>
<a id="ae2fa28a5a6b564d3ec23a6905736730a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2fa28a5a6b564d3ec23a6905736730a">&#9670;&nbsp;</a></span>numElementsPresent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numElementsPresent</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of elements present in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00072">72</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, and <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>.</p>

</div>
</div>
<a id="ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">&#9670;&nbsp;</a></span>pbc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nnp::Structure::pbc[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of PBC images necessary in each direction. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00074">74</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>.</p>

</div>
</div>
<a id="aa9fd0fd0f8a23b6bf96247589feceeb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fd0fd0f8a23b6bf96247589feceeb5">&#9670;&nbsp;</a></span>energy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Potential energy determined by neural network. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00076">76</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a5efd42ba997e4cefca70ae3445f60f3f">nnp::InterfaceLammps::getEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="aaee087b13af754a75198def4d12c8b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee087b13af754a75198def4d12c8b61">&#9670;&nbsp;</a></span>energyRef</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energyRef</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference potential energy. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00078">78</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="a50427699538016623ef2331c9eb67f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50427699538016623ef2331c9eb67f01">&#9670;&nbsp;</a></span>charge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::charge</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Charge determined by neural network potential. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00080">80</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">nnp::Mode::calculateCharge()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="a65839bc1a3213a6d77e064b5edade786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65839bc1a3213a6d77e064b5edade786">&#9670;&nbsp;</a></span>chargeRef</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::chargeRef</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference charge. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00082">82</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="ac8c6f2c95c4ca25893d2be192effff3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c6f2c95c4ca25893d2be192effff3d">&#9670;&nbsp;</a></span>volume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::volume</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation box volume. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00084">84</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a6665217897b26fa4fd01a07aa652cd2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6665217897b26fa4fd01a07aa652cd2f">&#9670;&nbsp;</a></span>sampleType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a> nnp::Structure::sampleType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sample type (training or test set). </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00086">86</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, and <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>.</p>

</div>
</div>
<a id="a4d519c01388cad10212f64eda1fa6c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d519c01388cad10212f64eda1fa6c8b">&#9670;&nbsp;</a></span>comment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string nnp::Structure::comment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> comment. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00088">88</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, and <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>.</p>

</div>
</div>
<a id="a21e5cd213176fab9075b3f040dd6dee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e5cd213176fab9075b3f040dd6dee6">&#9670;&nbsp;</a></span>box</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> nnp::Structure::box[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00090">90</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a177773f58df6da23d833e1cca0eb2cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a177773f58df6da23d833e1cca0eb2cf8">&#9670;&nbsp;</a></span>invbox</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> nnp::Structure::invbox[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inverse simulation box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00092">92</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a3427c9bd877e3bf72ad71f30dfb76ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3427c9bd877e3bf72ad71f30dfb76ac2">&#9670;&nbsp;</a></span>numAtomsPerElement</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::size_t&gt; nnp::Structure::numAtomsPerElement</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of atoms of each element in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00094">94</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="classnnp_1_1Mode.html#af05a24414c9b595a8ccb95b05b5030de">nnp::Mode::getEnergyOffset()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, and <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>.</p>

</div>
</div>
<a id="adee965dec483f9479378a2ed4acd5544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee965dec483f9479378a2ed4acd5544">&#9670;&nbsp;</a></span>atoms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structnnp_1_1Atom.html">Atom</a>&gt; nnp::Structure::atoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vector of all atoms in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00096">96</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#af5aab023a5bf8f326a6f5a7e4515e09c">nnp::InterfaceLammps::addNeighbor()</a>, <a class="el" href="classnnp_1_1Mode.html#a778e3d7087b98c31effaa4129d23c6d7">nnp::Mode::calculateAtomicNeuralNetworks()</a>, <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">nnp::Mode::calculateCharge()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ade6c70cf70dbbd3db3aa59497ca09f9c">calculateNeighborList()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Training.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a9a0f3518c376324d41786e29a7b5300d">freeAtoms()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a680dca82d8c1670ac2effe7ba7df60fc">nnp::InterfaceLammps::getAtomicEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">getChargesLines()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">getForcesLines()</a>, <a class="el" href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">getMaxNumNeighbors()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a1c2c6944f8458c58a174d0e058649139">nnp::InterfaceLammps::setLocalTags()</a>, <a class="el" href="structnnp_1_1Structure.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>/home/runner/work/n2p2/n2p2/src/libnnp/<a class="el" href="Structure_8h_source.html">Structure.h</a></li>
<li>/home/runner/work/n2p2/n2p2/src/libnnp/<a class="el" href="Structure_8cpp_source.html">Structure.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructnnp_1_1Structure_html_ae3f4816f60d52e90cf213479ef443b32"><div class="ttname"><a href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">nnp::Structure::readFromLines</a></div><div class="ttdeci">void readFromLines(std::vector&lt; std::string &gt; const &amp;lines)</div><div class="ttdoc">Read configuration from lines.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00131">Structure.cpp:131</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a50427699538016623ef2331c9eb67f01"><div class="ttname"><a href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">nnp::Structure::charge</a></div><div class="ttdeci">double charge</div><div class="ttdoc">Charge determined by neural network potential.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00080">Structure.h:80</a></div></div>
<div class="ttc" id="anamespacennp_html_aaa30280456ea59152f9e6c240f41ea93"><div class="ttname"><a href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00060">utility.cpp:60</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a7eaa3ccba6309f828c2444ee627d7ee5"><div class="ttname"><a href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">nnp::Structure::writeToFilePoscar</a></div><div class="ttdeci">void writeToFilePoscar(std::ofstream *const &amp;file) const</div><div class="ttdoc">Write configuration to POSCAR file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00760">Structure.cpp:760</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a65839bc1a3213a6d77e064b5edade786"><div class="ttname"><a href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">nnp::Structure::chargeRef</a></div><div class="ttdeci">double chargeRef</div><div class="ttdoc">Reference charge.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00082">Structure.h:82</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">nnp::Structure::ST_VALIDATION</a></div><div class="ttdeci">@ ST_VALIDATION</div><div class="ttdoc">Structure is part of validation set (currently unused).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00047">Structure.h:47</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a></div><div class="ttdeci">@ ST_TRAINING</div><div class="ttdoc">Structure is part of the training set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00044">Structure.h:44</a></div></div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_a502ccfa87ec2982d1be854c4fa3fa46b"><div class="ttname"><a href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">nnp::ElementMap::info</a></div><div class="ttdeci">std::vector&lt; std::string &gt; info() const</div><div class="ttdoc">Get map information as a vector of strings.</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8cpp_source.html#l00125">ElementMap.cpp:125</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a3259977e4b66dbe020c2e827d10ab18c"><div class="ttname"><a href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">nnp::Structure::remap</a></div><div class="ttdeci">void remap(Atom &amp;atom)</div><div class="ttdoc">Translate atom back into box if outside.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00435">Structure.cpp:435</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a56766c6996fa1bf63e4616b7fd03c84e"><div class="ttname"><a href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">nnp::Structure::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Copy of element map provided as constructor argument.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00054">Structure.h:54</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aff934fe32fb46e93dd9551d50ed4b0b6"><div class="ttname"><a href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for each atom.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00062">Structure.h:62</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4b24f7e1e265a975b92a5895b09b77af"><div class="ttname"><a href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">nnp::Structure::writeToFile</a></div><div class="ttdeci">void writeToFile(std::string const fileName=&quot;output.data&quot;, bool const ref=true, bool const append=false) const</div><div class="ttdoc">Write configuration to file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00641">Structure.cpp:641</a></div></div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_ab3c6fd52cc1fa5f0c1a1c8bc50c4542a"><div class="ttname"><a href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">nnp::ElementMap::getElementsString</a></div><div class="ttdeci">std::string getElementsString() const</div><div class="ttdoc">Get sorted list of elements in one string (space separated).</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8cpp_source.html#l00056">ElementMap.cpp:56</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ac8c6f2c95c4ca25893d2be192effff3d"><div class="ttname"><a href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">nnp::Structure::volume</a></div><div class="ttdeci">double volume</div><div class="ttdoc">Simulation box volume.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00084">Structure.h:84</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aaee087b13af754a75198def4d12c8b61"><div class="ttname"><a href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a></div><div class="ttdeci">double energyRef</div><div class="ttdoc">Reference potential energy.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00078">Structure.h:78</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">nnp::Structure::ST_UNKNOWN</a></div><div class="ttdeci">@ ST_UNKNOWN</div><div class="ttdoc">Sample type not assigned yet.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00041">Structure.h:41</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_ad53c703ea0d760ad25b5f6ebb7bdbf4c"><div class="ttname"><a href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numNeighborsPerElement</div><div class="ttdoc">Number of neighbors per element.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00126">Atom.h:126</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4d8ebcacb8fc434178c7c90cb2f70110"><div class="ttname"><a href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">nnp::Structure::isPeriodic</a></div><div class="ttdeci">bool isPeriodic</div><div class="ttdoc">If periodic boundary conditions apply.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00056">Structure.h:56</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a7d4ec60f305ae52787eb7dc0995eaec3"><div class="ttname"><a href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">nnp::Structure::calculateInverseBox</a></div><div class="ttdeci">void calculateInverseBox()</div><div class="ttdoc">Calculate inverse box.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00400">Structure.cpp:400</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a82f10399909e0f7fa8f6344c305781cc"><div class="ttname"><a href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for each atom.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00064">Structure.h:64</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><div class="ttname"><a href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">nnp::Structure::pbc</a></div><div class="ttdeci">int pbc[3]</div><div class="ttdoc">Number of PBC images necessary in each direction.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00074">Structure.h:74</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html"><div class="ttname"><a href="structnnp_1_1Atom.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00031">Atom.h:31</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a10f626682421d3690d8f1cb9ceba006f"><div class="ttname"><a href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">nnp::Structure::calculateVolume</a></div><div class="ttdeci">void calculateVolume()</div><div class="ttdoc">Calculate volume from box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00428">Structure.cpp:428</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aaa794cf49a53d8e5db578ac303b700fd"><div class="ttname"><a href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">nnp::Structure::readFromFile</a></div><div class="ttdeci">void readFromFile(std::string const fileName=&quot;input.data&quot;)</div><div class="ttdoc">Read configuration from file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00086">Structure.cpp:86</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ad2c737c945e42ec42fa852e4dbacaf90"><div class="ttname"><a href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a></div><div class="ttdeci">std::size_t numAtoms</div><div class="ttdoc">Total number of atoms present in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00068">Structure.h:68</a></div></div>
<div class="ttc" id="anamespacennp_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00090">utility.cpp:90</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_a4dd2e5fef207b1bd2021142bf678f251"><div class="ttname"><a href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">nnp::Vec3D::norm2</a></div><div class="ttdeci">double norm2() const</div><div class="ttdoc">Calculate square of norm of vector.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00261">Vec3D.h:261</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a5af7b5cd0a2154c2e34a3b8a73a51ca6"><div class="ttname"><a href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">nnp::Structure::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdoc">Index number of this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00066">Structure.h:66</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00076">Structure.h:76</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a2627321edafea60f478b35e7387e0681"><div class="ttname"><a href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">nnp::Structure::isTriclinic</a></div><div class="ttdeci">bool isTriclinic</div><div class="ttdoc">If the simulation box is triclinic.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00058">Structure.h:58</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ae2fa28a5a6b564d3ec23a6905736730a"><div class="ttname"><a href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">nnp::Structure::numElementsPresent</a></div><div class="ttdeci">std::size_t numElementsPresent</div><div class="ttdoc">Number of elements present in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00072">Structure.h:72</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ad47f8d1a1742f5430418fcd1b8919eb6"><div class="ttname"><a href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">nnp::Structure::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdoc">Global number of elements (all structures).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00070">Structure.h:70</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a88970ff745896183b1029fb5719ff28a"><div class="ttname"><a href="structnnp_1_1Structure.html#a88970ff745896183b1029fb5719ff28a">nnp::Structure::calculatePbcCopies</a></div><div class="ttdeci">void calculatePbcCopies(double cutoffRadius)</div><div class="ttdoc">Calculate required PBC copies.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00367">Structure.cpp:367</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a3427c9bd877e3bf72ad71f30dfb76ac2"><div class="ttname"><a href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numAtomsPerElement</div><div class="ttdoc">Number of atoms of each element in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00094">Structure.h:94</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a0e8397ecd8e60cf9db1f4dfe7378d447"><div class="ttname"><a href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a></div><div class="ttdeci">Vec3D r</div><div class="ttdoc">Cartesian coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00118">Atom.h:118</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a177773f58df6da23d833e1cca0eb2cf8"><div class="ttname"><a href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">nnp::Structure::invbox</a></div><div class="ttdeci">Vec3D invbox[3]</div><div class="ttdoc">Inverse simulation box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00092">Structure.h:92</a></div></div>
<div class="ttc" id="anamespacennp_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00033">utility.cpp:33</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a6665217897b26fa4fd01a07aa652cd2f"><div class="ttname"><a href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">nnp::Structure::sampleType</a></div><div class="ttdeci">SampleType sampleType</div><div class="ttdoc">Sample type (training or test set).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00086">Structure.h:86</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00096">Structure.h:96</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4d519c01388cad10212f64eda1fa6c8b"><div class="ttname"><a href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">nnp::Structure::comment</a></div><div class="ttdeci">std::string comment</div><div class="ttdoc">Structure comment.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00088">Structure.h:88</a></div></div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_a94031b84fe2b38bbdb62ba700d5481a4"><div class="ttname"><a href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Get element map size.</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8h_source.html#l00140">ElementMap.h:140</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html">nnp::Atom::Neighbor</a></div><div class="ttdoc">Struct to store information on neighbor atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00034">Atom.h:34</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a21e5cd213176fab9075b3f040dd6dee6"><div class="ttname"><a href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">nnp::Structure::box</a></div><div class="ttdeci">Vec3D box[3]</div><div class="ttdoc">Simulation box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00090">Structure.h:90</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html"><div class="ttname"><a href="structnnp_1_1Vec3D.html">nnp::Vec3D</a></div><div class="ttdoc">Vector in 3 dimensional real space.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00028">Vec3D.h:28</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_aeb7a761001a28045ccb6cfb175f5d399"><div class="ttname"><a href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">nnp::Vec3D::norm</a></div><div class="ttdeci">double norm() const</div><div class="ttdoc">Calculate norm of vector.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00256">Vec3D.h:256</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_af21dfbdaf41e8332ee0f773a070f3f74"><div class="ttname"><a href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">nnp::Structure::hasNeighborList</a></div><div class="ttdeci">bool hasNeighborList</div><div class="ttdoc">If the neighbor list has been calculated.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00060">Structure.h:60</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_a6a59afd117951d8bc98391da9d894741"><div class="ttname"><a href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">nnp::Vec3D::normalize</a></div><div class="ttdeci">Vec3D &amp; normalize()</div><div class="ttdoc">Normalize vector, norm equals 1.0 afterwards.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00271">Vec3D.h:271</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a></div><div class="ttdeci">@ ST_TEST</div><div class="ttdoc">Structure is part of the test set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00050">Structure.h:50</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_acb8ab5515d194a43e10c2fa43636dffc"><div class="ttname"><a href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">nnp::Vec3D::cross</a></div><div class="ttdeci">Vec3D cross(Vec3D const &amp;v) const</div><div class="ttdoc">Cross product, argument vector is second in product.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00281">Vec3D.h:281</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a53667a4b6cad924e3c15aeda65c2223d"><div class="ttname"><a href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">nnp::Atom::clearNeighborList</a></div><div class="ttdeci">void clearNeighborList()</div><div class="ttdoc">Clear neighbor list.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8cpp_source.html#l00259">Atom.cpp:259</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacennp.html">nnp</a></li><li class="navelem"><a class="el" href="structnnp_1_1Structure.html">Structure</a></li>
    <li class="footer">Generated on Thu May 19 2022 21:58:09 for n2p2 - A neural network potential package by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
