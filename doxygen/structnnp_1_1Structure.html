<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>n2p2 - A neural network potential package: nnp::Structure Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">n2p2 - A neural network potential package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structnnp_1_1Structure.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structnnp_1_1Structure-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nnp::Structure Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Storage for one atomic configuration.  
 <a href="structnnp_1_1Structure.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Structure_8h_source.html">Structure.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for nnp::Structure:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure__coll__graph.png" border="0" usemap="#annp_1_1Structure_coll__map" alt="Collaboration graph"/></div>
<map name="annp_1_1Structure_coll__map" id="annp_1_1Structure_coll__map">
<area shape="rect" title="Storage for one atomic configuration." alt="" coords="707,408,820,435"/>
<area shape="rect" href="classnnp_1_1ElementMap.html" title="Contains element map." alt="" coords="275,117,411,144"/>
<area shape="rect" title=" " alt="" coords="5,73,92,100"/>
<area shape="rect" title=" " alt="" coords="318,200,369,227"/>
<area shape="rect" title=" " alt="" coords="19,327,79,353"/>
<area shape="rect" title=" " alt="" coords="250,357,437,384"/>
<area shape="rect" title=" " alt="" coords="324,408,363,435"/>
<area shape="rect" title=" " alt="" coords="15,609,82,636"/>
<area shape="rect" href="structnnp_1_1Vec3D.html" title="Vector in 3 dimensional real space." alt="" coords="296,653,391,680"/>
<area shape="rect" title=" " alt="" coords="293,704,394,731"/>
<area shape="rect" title=" " alt="" coords="303,755,384,781"/>
<area shape="rect" title=" " alt="" coords="249,805,437,832"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a118a744590977c2b258feace6dc6676e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a> { <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>
, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>
, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">ST_VALIDATION</a>
, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a>
 }</td></tr>
<tr class="memdesc:a118a744590977c2b258feace6dc6676e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerates different sample types (e.g.  <a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">More...</a><br /></td></tr>
<tr class="separator:a118a744590977c2b258feace6dc6676e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac6c101b28efea5a150cce3bb8948f8d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure</a> ()</td></tr>
<tr class="memdesc:ac6c101b28efea5a150cce3bb8948f8d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, initializes to zero.  <a href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">More...</a><br /></td></tr>
<tr class="separator:ac6c101b28efea5a150cce3bb8948f8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57c375126ca37e8d390d406091e7dd5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap</a> (<a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> const &amp;<a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>)</td></tr>
<tr class="memdesc:a57c375126ca37e8d390d406091e7dd5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set element map of structure.  <a href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">More...</a><br /></td></tr>
<tr class="separator:a57c375126ca37e8d390d406091e7dd5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b676463d894c0988c645fed1ddf36b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom</a> (<a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;atom, std::string const &amp;element)</td></tr>
<tr class="memdesc:a7b676463d894c0988c645fed1ddf36b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a single atom to structure.  <a href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">More...</a><br /></td></tr>
<tr class="separator:a7b676463d894c0988c645fed1ddf36b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa794cf49a53d8e5db578ac303b700fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile</a> (std::string const fileName=&quot;input.data&quot;)</td></tr>
<tr class="memdesc:aaa794cf49a53d8e5db578ac303b700fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from file.  <a href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">More...</a><br /></td></tr>
<tr class="separator:aaa794cf49a53d8e5db578ac303b700fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8474b4633b73815022742af96b0a77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">readFromFile</a> (std::ifstream &amp;file)</td></tr>
<tr class="memdesc:a9d8474b4633b73815022742af96b0a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from file.  <a href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">More...</a><br /></td></tr>
<tr class="separator:a9d8474b4633b73815022742af96b0a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f4816f60d52e90cf213479ef443b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines</a> (std::vector&lt; std::string &gt; const &amp;lines)</td></tr>
<tr class="memdesc:ae3f4816f60d52e90cf213479ef443b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from lines.  <a href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">More...</a><br /></td></tr>
<tr class="separator:ae3f4816f60d52e90cf213479ef443b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46770abdefe49a0ab488049caa99905c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">calculateMaxCutoffRadiusOverall</a> (<a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;ewaldSetup, double rcutScreen, double maxCutoffRadius)</td></tr>
<tr class="memdesc:a46770abdefe49a0ab488049caa99905c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate maximal cut-off if cut-off of screening and real part Ewald summation are also considered.  <a href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">More...</a><br /></td></tr>
<tr class="separator:a46770abdefe49a0ab488049caa99905c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd8b8ea17cc7579a3618a49623303483"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList</a> (double cutoffRadius, bool sortByDistance=false)</td></tr>
<tr class="memdesc:acd8b8ea17cc7579a3618a49623303483"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate neighbor list for all atoms.  <a href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">More...</a><br /></td></tr>
<tr class="separator:acd8b8ea17cc7579a3618a49623303483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16cce5a0b0a379f4432c2cacb1d83931"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931">calculateNeighborList</a> (double cutoffRadius, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;cutoffs)</td></tr>
<tr class="memdesc:a16cce5a0b0a379f4432c2cacb1d83931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate neighbor list for all atoms and setup neighbor cut-off map.  <a href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931">More...</a><br /></td></tr>
<tr class="separator:a16cce5a0b0a379f4432c2cacb1d83931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fd80c1c4534a68182f88016fc1ea284"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList</a> ()</td></tr>
<tr class="memdesc:a2fd80c1c4534a68182f88016fc1ea284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort all neighbor lists of this structure with respect to the distance.  <a href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">More...</a><br /></td></tr>
<tr class="separator:a2fd80c1c4534a68182f88016fc1ea284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281cb20de35ca8ecbfab2a196be3c107"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap</a> (std::vector&lt; std::vector&lt; double &gt; &gt; cutoffs)</td></tr>
<tr class="memdesc:a281cb20de35ca8ecbfab2a196be3c107"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a neighbor cut-off map which gives the index (value) of the last needed neighbor corresponding to a specific cut-off (key).  <a href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">More...</a><br /></td></tr>
<tr class="separator:a281cb20de35ca8ecbfab2a196be3c107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924f2222a9df39041690d23f2d5963fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">calculatePbcCopies</a> (double cutoffRadius, int(&amp;<a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>)[3])</td></tr>
<tr class="memdesc:a924f2222a9df39041690d23f2d5963fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate required PBC copies.  <a href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">More...</a><br /></td></tr>
<tr class="separator:a924f2222a9df39041690d23f2d5963fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox</a> ()</td></tr>
<tr class="memdesc:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate inverse box.  <a href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">More...</a><br /></td></tr>
<tr class="separator:a7d4ec60f305ae52787eb7dc0995eaec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a593b477540ad63365bfa292d0f54f1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4a593b477540ad63365bfa292d0f54f1">canMinimumImageConventionBeApplied</a> (double cutoffRadius)</td></tr>
<tr class="memdesc:a4a593b477540ad63365bfa292d0f54f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if cut-off radius is small enough to apply minimum image convention.  <a href="structnnp_1_1Structure.html#a4a593b477540ad63365bfa292d0f54f1">More...</a><br /></td></tr>
<tr class="separator:a4a593b477540ad63365bfa292d0f54f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3edbae28ee8196bc67bac988a83d93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#acd3edbae28ee8196bc67bac988a83d93">applyMinimumImageConvention</a> (<a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> const &amp;dr)</td></tr>
<tr class="memdesc:acd3edbae28ee8196bc67bac988a83d93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate distance between two atoms in the minimum image convention.  <a href="structnnp_1_1Structure.html#acd3edbae28ee8196bc67bac988a83d93">More...</a><br /></td></tr>
<tr class="separator:acd3edbae28ee8196bc67bac988a83d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f626682421d3690d8f1cb9ceba006f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume</a> ()</td></tr>
<tr class="memdesc:a10f626682421d3690d8f1cb9ceba006f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate volume from box vectors.  <a href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">More...</a><br /></td></tr>
<tr class="separator:a10f626682421d3690d8f1cb9ceba006f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ffe252cff725aa5bb952bb1d8cbf5a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy</a> (<a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;ewaldSetup, Eigen::VectorXd hardness, Eigen::MatrixXd gammaSqrt2, Eigen::VectorXd sigmaSqrtPi, <a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;fs, double const fourPiEps, <a class="el" href="structnnp_1_1ErfcBuf.html">ErfcBuf</a> &amp;erfcBuf)</td></tr>
<tr class="memdesc:a50ffe252cff725aa5bb952bb1d8cbf5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute electrostatic energy with global charge equilibration.  <a href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">More...</a><br /></td></tr>
<tr class="separator:a50ffe252cff725aa5bb952bb1d8cbf5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae462f93091a1ab2767a5ca395ab0a6e2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy</a> (Eigen::MatrixXd gammaSqrt2, Eigen::VectorXd sigmaSqrtPi, <a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;fs, double const fourPiEps)</td></tr>
<tr class="memdesc:ae462f93091a1ab2767a5ca395ab0a6e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove contributions in the short range domain.  <a href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">More...</a><br /></td></tr>
<tr class="separator:ae462f93091a1ab2767a5ca395ab0a6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addf3a61f5cb0fa8daeb5737d28758740"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">calculateDAdrQ</a> (<a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;ewaldSetup, Eigen::MatrixXd gammaSqrt2, double const fourPiEps, <a class="el" href="structnnp_1_1ErfcBuf.html">ErfcBuf</a> &amp;erfcBuf)</td></tr>
<tr class="memdesc:addf3a61f5cb0fa8daeb5737d28758740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates derivative of A-matrix with respect to the atoms positions and contract it with Q.  <a href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">More...</a><br /></td></tr>
<tr class="separator:addf3a61f5cb0fa8daeb5737d28758740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cd07a8b746a55aea0f0b6181a9f645f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4cd07a8b746a55aea0f0b6181a9f645f">calculateDQdChi</a> (std::vector&lt; Eigen::VectorXd &gt; &amp;dQdChi)</td></tr>
<tr class="memdesc:a4cd07a8b746a55aea0f0b6181a9f645f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates derivative of the charges with respect to electronegativities.  <a href="structnnp_1_1Structure.html#a4cd07a8b746a55aea0f0b6181a9f645f">More...</a><br /></td></tr>
<tr class="separator:a4cd07a8b746a55aea0f0b6181a9f645f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7204a6979274b69a358f73af50187d85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">calculateDQdJ</a> (std::vector&lt; Eigen::VectorXd &gt; &amp;dQdJ)</td></tr>
<tr class="memdesc:a7204a6979274b69a358f73af50187d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates derivative of the charges with respect to atomic hardness.  <a href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">More...</a><br /></td></tr>
<tr class="separator:a7204a6979274b69a358f73af50187d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f0706e5971387076a3257b149534679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a8f0706e5971387076a3257b149534679">calculateDQdr</a> (std::vector&lt; size_t &gt; const &amp;atomsIndices, std::vector&lt; size_t &gt; const &amp;compIndices, double const maxCutoffRadius, std::vector&lt; <a class="el" href="classnnp_1_1Element.html">Element</a> &gt; const &amp;elements)</td></tr>
<tr class="memdesc:a8f0706e5971387076a3257b149534679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates derivative of the charges with respect to the atom's position.  <a href="structnnp_1_1Structure.html#a8f0706e5971387076a3257b149534679">More...</a><br /></td></tr>
<tr class="separator:a8f0706e5971387076a3257b149534679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91c699d5b568d865f43ab30fe42f250"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">calculateElectrostaticEnergyDerivatives</a> (Eigen::VectorXd hardness, Eigen::MatrixXd gammaSqrt2, Eigen::VectorXd sigmaSqrtPi, <a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;fs, double const fourPiEps)</td></tr>
<tr class="memdesc:ac91c699d5b568d865f43ab30fe42f250"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates partial derivatives of electrostatic Energy with respect to atom's coordinates and charges.  <a href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">More...</a><br /></td></tr>
<tr class="separator:ac91c699d5b568d865f43ab30fe42f250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9373df62476af32ec7c479bbc3fcb063"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a9373df62476af32ec7c479bbc3fcb063">calculateForceLambdaTotal</a> () const</td></tr>
<tr class="memdesc:a9373df62476af32ec7c479bbc3fcb063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate lambda_total vector which is needed for the total force calculation in 4G NN.  <a href="structnnp_1_1Structure.html#a9373df62476af32ec7c479bbc3fcb063">More...</a><br /></td></tr>
<tr class="separator:a9373df62476af32ec7c479bbc3fcb063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3237e0cda2706b6930880c9c7f4885c4"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a3237e0cda2706b6930880c9c7f4885c4">calculateForceLambdaElec</a> () const</td></tr>
<tr class="memdesc:a3237e0cda2706b6930880c9c7f4885c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate lambda_elec vector which is needed for the electrostatic force calculation in 4G NN.  <a href="structnnp_1_1Structure.html#a3237e0cda2706b6930880c9c7f4885c4">More...</a><br /></td></tr>
<tr class="separator:a3237e0cda2706b6930880c9c7f4885c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c37b89d8e32f6785168f6a6c201859"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap</a> ()</td></tr>
<tr class="memdesc:a60c37b89d8e32f6785168f6a6c201859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate all atoms back into box if outside.  <a href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">More...</a><br /></td></tr>
<tr class="separator:a60c37b89d8e32f6785168f6a6c201859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3259977e4b66dbe020c2e827d10ab18c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap</a> (<a class="el" href="structnnp_1_1Atom.html">Atom</a> &amp;atom)</td></tr>
<tr class="memdesc:a3259977e4b66dbe020c2e827d10ab18c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate atom back into box if outside.  <a href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">More...</a><br /></td></tr>
<tr class="separator:a3259977e4b66dbe020c2e827d10ab18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd33241d3bdecf5f1a7eee012118cea3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits</a> (double meanEnergy, double convEnergy, double convLength, double convCharge)</td></tr>
<tr class="memdesc:abd33241d3bdecf5f1a7eee012118cea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize structure, shift energy and change energy, length and charge unit.  <a href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">More...</a><br /></td></tr>
<tr class="separator:abd33241d3bdecf5f1a7eee012118cea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1858d3c06446ad91b0876f8ca30b2686"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits</a> (double meanEnergy, double convEnergy, double convLength, double convCharge)</td></tr>
<tr class="memdesc:a1858d3c06446ad91b0876f8ca30b2686"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch to physical units, shift energy and change energy, length and charge unit.  <a href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">More...</a><br /></td></tr>
<tr class="separator:a1858d3c06446ad91b0876f8ca30b2686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e79c2155e6dd905e7642c6cda008e6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">getMaxNumNeighbors</a> () const</td></tr>
<tr class="memdesc:a26e79c2155e6dd905e7642c6cda008e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find maximum number of neighbors.  <a href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">More...</a><br /></td></tr>
<tr class="separator:a26e79c2155e6dd905e7642c6cda008e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1cbaed161ba008d03a654d5ea04c6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a0c1cbaed161ba008d03a654d5ea04c6a">freeAtoms</a> (bool all, double const maxCutoffRadius=0.0)</td></tr>
<tr class="memdesc:a0c1cbaed161ba008d03a654d5ea04c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free symmetry function memory for all atoms, see free() in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> class.  <a href="structnnp_1_1Structure.html#a0c1cbaed161ba008d03a654d5ea04c6a">More...</a><br /></td></tr>
<tr class="separator:a0c1cbaed161ba008d03a654d5ea04c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6bf40715b7ffd70707baf5e95746ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset</a> ()</td></tr>
<tr class="memdesc:abf6bf40715b7ffd70707baf5e95746ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset everything but <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e" title="Copy of element map provided as constructor argument.">elementMap</a>.  <a href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">More...</a><br /></td></tr>
<tr class="separator:abf6bf40715b7ffd70707baf5e95746ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af289c389f76b4981aef3c92300aa668d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList</a> ()</td></tr>
<tr class="memdesc:af289c389f76b4981aef3c92300aa668d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear neighbor list of all atoms.  <a href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">More...</a><br /></td></tr>
<tr class="separator:af289c389f76b4981aef3c92300aa668d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa595df3985c11f039308dcca5fae828c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aa595df3985c11f039308dcca5fae828c">clearElectrostatics</a> (bool clearDQdr=false)</td></tr>
<tr class="memdesc:aa595df3985c11f039308dcca5fae828c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear A-matrix, dAdrQ and optionally dQdr.  <a href="structnnp_1_1Structure.html#aa595df3985c11f039308dcca5fae828c">More...</a><br /></td></tr>
<tr class="separator:aa595df3985c11f039308dcca5fae828c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add58b9575e3ae19f82991a445aec6b97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError</a> (std::string const &amp;property, std::map&lt; std::string, double &gt; &amp;error, std::size_t &amp;count) const</td></tr>
<tr class="memdesc:add58b9575e3ae19f82991a445aec6b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update property error metrics with this structure.  <a href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">More...</a><br /></td></tr>
<tr class="separator:add58b9575e3ae19f82991a445aec6b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b44fa434482a31e7453a739b84fc09"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine</a> () const</td></tr>
<tr class="memdesc:a96b44fa434482a31e7453a739b84fc09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN energy.  <a href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">More...</a><br /></td></tr>
<tr class="separator:a96b44fa434482a31e7453a739b84fc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a70e2e3f8368758300957a48ead3e2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">getForcesLines</a> () const</td></tr>
<tr class="memdesc:ac5a70e2e3f8368758300957a48ead3e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN forces for all atoms.  <a href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">More...</a><br /></td></tr>
<tr class="separator:ac5a70e2e3f8368758300957a48ead3e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">getChargesLines</a> () const</td></tr>
<tr class="memdesc:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference and NN charges for all atoms.  <a href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">More...</a><br /></td></tr>
<tr class="separator:a6477ccc1b4338e4e2e44a5da7ab49741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b24f7e1e265a975b92a5895b09b77af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile</a> (std::string const fileName=&quot;output.data&quot;, bool const ref=true, bool const append=false) const</td></tr>
<tr class="memdesc:a4b24f7e1e265a975b92a5895b09b77af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to file.  <a href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">More...</a><br /></td></tr>
<tr class="separator:a4b24f7e1e265a975b92a5895b09b77af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ded940e3f99aa86b3fa75a37357a29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile</a> (std::ofstream *const &amp;file, bool const ref=true) const</td></tr>
<tr class="memdesc:a64ded940e3f99aa86b3fa75a37357a29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to file.  <a href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">More...</a><br /></td></tr>
<tr class="separator:a64ded940e3f99aa86b3fa75a37357a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8285382c3e2d908c8073a1fac315176b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:a8285382c3e2d908c8073a1fac315176b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to xyz file.  <a href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">More...</a><br /></td></tr>
<tr class="separator:a8285382c3e2d908c8073a1fac315176b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to POSCAR file.  <a href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">More...</a><br /></td></tr>
<tr class="separator:a7eaa3ccba6309f828c2444ee627d7ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar</a> (std::ofstream *const &amp;file, std::string const elements) const</td></tr>
<tr class="memdesc:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write configuration to POSCAR file.  <a href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">More...</a><br /></td></tr>
<tr class="separator:a5e1f59c24c85703e6e78c7f85d47a2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d63337cd7d1a4e0058cd818543caef"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info</a> () const</td></tr>
<tr class="memdesc:af6d63337cd7d1a4e0058cd818543caef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get structure information as a vector of strings.  <a href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">More...</a><br /></td></tr>
<tr class="separator:af6d63337cd7d1a4e0058cd818543caef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a56766c6996fa1bf63e4616b7fd03c84e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a></td></tr>
<tr class="memdesc:a56766c6996fa1bf63e4616b7fd03c84e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy of element map provided as constructor argument.  <a href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">More...</a><br /></td></tr>
<tr class="separator:a56766c6996fa1bf63e4616b7fd03c84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a></td></tr>
<tr class="memdesc:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="mdescLeft">&#160;</td><td class="mdescRight">If periodic boundary conditions apply.  <a href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">More...</a><br /></td></tr>
<tr class="separator:a4d8ebcacb8fc434178c7c90cb2f70110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2627321edafea60f478b35e7387e0681"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a></td></tr>
<tr class="memdesc:a2627321edafea60f478b35e7387e0681"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the simulation box is triclinic.  <a href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">More...</a><br /></td></tr>
<tr class="separator:a2627321edafea60f478b35e7387e0681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21dfbdaf41e8332ee0f773a070f3f74"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a></td></tr>
<tr class="memdesc:af21dfbdaf41e8332ee0f773a070f3f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the neighbor list has been calculated.  <a href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">More...</a><br /></td></tr>
<tr class="separator:af21dfbdaf41e8332ee0f773a070f3f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5142f63d6a9301709e67197438ef77d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a></td></tr>
<tr class="memdesc:a5142f63d6a9301709e67197438ef77d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the neighbor list has been sorted by distance.  <a href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">More...</a><br /></td></tr>
<tr class="separator:a5142f63d6a9301709e67197438ef77d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a></td></tr>
<tr class="memdesc:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">If symmetry function values are saved for each atom.  <a href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">More...</a><br /></td></tr>
<tr class="separator:aff934fe32fb46e93dd9551d50ed4b0b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f10399909e0f7fa8f6344c305781cc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a></td></tr>
<tr class="memdesc:a82f10399909e0f7fa8f6344c305781cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">If symmetry function derivatives are saved for each atom.  <a href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">More...</a><br /></td></tr>
<tr class="separator:a82f10399909e0f7fa8f6344c305781cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a></td></tr>
<tr class="memdesc:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index number of this structure.  <a href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">More...</a><br /></td></tr>
<tr class="separator:a5af7b5cd0a2154c2e34a3b8a73a51ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c737c945e42ec42fa852e4dbacaf90"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a></td></tr>
<tr class="memdesc:ad2c737c945e42ec42fa852e4dbacaf90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of atoms present in this structure.  <a href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">More...</a><br /></td></tr>
<tr class="separator:ad2c737c945e42ec42fa852e4dbacaf90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a></td></tr>
<tr class="memdesc:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global number of elements (all structures).  <a href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">More...</a><br /></td></tr>
<tr class="separator:ad47f8d1a1742f5430418fcd1b8919eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fa28a5a6b564d3ec23a6905736730a"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a></td></tr>
<tr class="memdesc:ae2fa28a5a6b564d3ec23a6905736730a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements present in this structure.  <a href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">More...</a><br /></td></tr>
<tr class="separator:ae2fa28a5a6b564d3ec23a6905736730a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a> [3]</td></tr>
<tr class="memdesc:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of PBC images necessary in each direction for max cut-off.  <a href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">More...</a><br /></td></tr>
<tr class="separator:ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a></td></tr>
<tr class="memdesc:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Potential energy determined by neural network.  <a href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">More...</a><br /></td></tr>
<tr class="separator:aa9fd0fd0f8a23b6bf96247589feceeb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee087b13af754a75198def4d12c8b61"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a></td></tr>
<tr class="memdesc:aaee087b13af754a75198def4d12c8b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference potential energy.  <a href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">More...</a><br /></td></tr>
<tr class="separator:aaee087b13af754a75198def4d12c8b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2903270f6db9ebf27d59dab9bd2914"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a6c2903270f6db9ebf27d59dab9bd2914">energyShort</a></td></tr>
<tr class="memdesc:a6c2903270f6db9ebf27d59dab9bd2914"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short-range part of the potential energy predicted by NNP.  <a href="structnnp_1_1Structure.html#a6c2903270f6db9ebf27d59dab9bd2914">More...</a><br /></td></tr>
<tr class="separator:a6c2903270f6db9ebf27d59dab9bd2914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d5c1fa9994b603c38e25250da743df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">energyElec</a></td></tr>
<tr class="memdesc:aa8d5c1fa9994b603c38e25250da743df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Electrostatics part of the potential energy predicted by NNP.  <a href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">More...</a><br /></td></tr>
<tr class="separator:aa8d5c1fa9994b603c38e25250da743df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9eaacc767607b846ddf9b30109c570e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">hasCharges</a></td></tr>
<tr class="memdesc:af9eaacc767607b846ddf9b30109c570e"><td class="mdescLeft">&#160;</td><td class="mdescRight">If all charges of this structure have been calculated (and stay the same, e.g.  <a href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">More...</a><br /></td></tr>
<tr class="separator:af9eaacc767607b846ddf9b30109c570e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50427699538016623ef2331c9eb67f01"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a></td></tr>
<tr class="memdesc:a50427699538016623ef2331c9eb67f01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charge determined by neural network potential.  <a href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">More...</a><br /></td></tr>
<tr class="separator:a50427699538016623ef2331c9eb67f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65839bc1a3213a6d77e064b5edade786"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a></td></tr>
<tr class="memdesc:a65839bc1a3213a6d77e064b5edade786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference charge.  <a href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">More...</a><br /></td></tr>
<tr class="separator:a65839bc1a3213a6d77e064b5edade786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c6f2c95c4ca25893d2be192effff3d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a></td></tr>
<tr class="memdesc:ac8c6f2c95c4ca25893d2be192effff3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation box volume.  <a href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">More...</a><br /></td></tr>
<tr class="separator:ac8c6f2c95c4ca25893d2be192effff3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2cb7342755dc1305b5105a5512c129"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a></td></tr>
<tr class="memdesc:a4f2cb7342755dc1305b5105a5512c129"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum cut-off radius with respect to symmetry functions, screening function and Ewald summation.  <a href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">More...</a><br /></td></tr>
<tr class="separator:a4f2cb7342755dc1305b5105a5512c129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f49b6c8dc038aab8ee34ba92b1b785"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a39f49b6c8dc038aab8ee34ba92b1b785">lambda</a></td></tr>
<tr class="memdesc:a39f49b6c8dc038aab8ee34ba92b1b785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lagrange multiplier used for charge equilibration.  <a href="structnnp_1_1Structure.html#a39f49b6c8dc038aab8ee34ba92b1b785">More...</a><br /></td></tr>
<tr class="separator:a39f49b6c8dc038aab8ee34ba92b1b785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6665217897b26fa4fd01a07aa652cd2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a></td></tr>
<tr class="memdesc:a6665217897b26fa4fd01a07aa652cd2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample type (training or test set).  <a href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">More...</a><br /></td></tr>
<tr class="separator:a6665217897b26fa4fd01a07aa652cd2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d519c01388cad10212f64eda1fa6c8b"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a></td></tr>
<tr class="memdesc:a4d519c01388cad10212f64eda1fa6c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> comment.  <a href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">More...</a><br /></td></tr>
<tr class="separator:a4d519c01388cad10212f64eda1fa6c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e5cd213176fab9075b3f040dd6dee6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a> [3]</td></tr>
<tr class="memdesc:a21e5cd213176fab9075b3f040dd6dee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulation box vectors.  <a href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">More...</a><br /></td></tr>
<tr class="separator:a21e5cd213176fab9075b3f040dd6dee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a177773f58df6da23d833e1cca0eb2cf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a> [3]</td></tr>
<tr class="memdesc:a177773f58df6da23d833e1cca0eb2cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverse simulation box vectors.  <a href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">More...</a><br /></td></tr>
<tr class="separator:a177773f58df6da23d833e1cca0eb2cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90bd1326da5bb05f04689a06660a2c9c"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a></td></tr>
<tr class="memdesc:a90bd1326da5bb05f04689a06660a2c9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global charge equilibration matrix A'.  <a href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">More...</a><br /></td></tr>
<tr class="separator:a90bd1326da5bb05f04689a06660a2c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b8f1a7b53aebd41dab2838084b5618"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a></td></tr>
<tr class="memdesc:a79b8f1a7b53aebd41dab2838084b5618"><td class="mdescLeft">&#160;</td><td class="mdescRight">If A matrix of this structure is currently stored.  <a href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">More...</a><br /></td></tr>
<tr class="separator:a79b8f1a7b53aebd41dab2838084b5618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a></td></tr>
<tr class="memdesc:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of atoms of each element in this structure.  <a href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">More...</a><br /></td></tr>
<tr class="separator:a3427c9bd877e3bf72ad71f30dfb76ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee965dec483f9479378a2ed4acd5544"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structnnp_1_1Atom.html">Atom</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a></td></tr>
<tr class="memdesc:adee965dec483f9479378a2ed4acd5544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of all atoms in this structure.  <a href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">More...</a><br /></td></tr>
<tr class="separator:adee965dec483f9479378a2ed4acd5544"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Storage for one atomic configuration. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00038">38</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a118a744590977c2b258feace6dc6676e" name="a118a744590977c2b258feace6dc6676e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a118a744590977c2b258feace6dc6676e">&#9670;&nbsp;</a></span>SampleType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">nnp::Structure::SampleType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerates different sample types (e.g. </p>
<p >training or test set). </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381" name="a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381"></a>ST_UNKNOWN&#160;</td><td class="fielddoc"><p >Sample type not assigned yet. </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50" name="a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50"></a>ST_TRAINING&#160;</td><td class="fielddoc"><p ><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of the training set. </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602" name="a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602"></a>ST_VALIDATION&#160;</td><td class="fielddoc"><p ><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of validation set (currently unused). </p>
</td></tr>
<tr><td class="fieldname"><a id="a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719" name="a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719"></a>ST_TEST&#160;</td><td class="fielddoc"><p ><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> is part of the test set. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00042">42</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>    {</div>
<div class="line"><span class="lineno">   46</span>        <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>,</div>
<div class="line"><span class="lineno">   49</span>        <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>,</div>
<div class="line"><span class="lineno">   52</span>        <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">ST_VALIDATION</a>,</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a></div>
<div class="line"><span class="lineno">   56</span>    };</div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea458bbb3ade8e97db0a7479a8c240a602">nnp::Structure::ST_VALIDATION</a></div><div class="ttdeci">@ ST_VALIDATION</div><div class="ttdoc">Structure is part of validation set (currently unused).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00052">Structure.h:52</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">nnp::Structure::ST_TRAINING</a></div><div class="ttdeci">@ ST_TRAINING</div><div class="ttdoc">Structure is part of the training set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00049">Structure.h:49</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">nnp::Structure::ST_UNKNOWN</a></div><div class="ttdeci">@ ST_UNKNOWN</div><div class="ttdoc">Sample type not assigned yet.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00046">Structure.h:46</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719"><div class="ttname"><a href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">nnp::Structure::ST_TEST</a></div><div class="ttdeci">@ ST_TEST</div><div class="ttdoc">Structure is part of the test set.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00056">Structure.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac6c101b28efea5a150cce3bb8948f8d1" name="ac6c101b28efea5a150cce3bb8948f8d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c101b28efea5a150cce3bb8948f8d1">&#9670;&nbsp;</a></span>Structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Structure::Structure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor, initializes to zero. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00035">35</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>                     :</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>                    (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>                   (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>               (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a>          (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>          (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>(<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>                         (0         ),</div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>                      (0         ),</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>                   (0         ),</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>            (0         ),</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>                        (0.0       ),</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>                     (0.0       ),</div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a6c2903270f6db9ebf27d59dab9bd2914">energyShort</a>                   (0.0       ),</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">energyElec</a>                    (0.0       ),</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">hasCharges</a>                    (<span class="keyword">false</span>     ),</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>                        (0.0       ),</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>                     (0.0       ),</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>                        (0.0       ),</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>        (0.0       ),</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>                    (<a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>),</div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>                       (<span class="stringliteral">&quot;&quot;</span>        ),</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a>                    (<span class="keyword">false</span>     )</div>
<div class="line"><span class="lineno">   58</span>{</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><span class="lineno">   60</span>    {</div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[i] = 0;</div>
<div class="line"><span class="lineno">   62</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][0] = 0.0;</div>
<div class="line"><span class="lineno">   63</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][1] = 0.0;</div>
<div class="line"><span class="lineno">   64</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][2] = 0.0;</div>
<div class="line"><span class="lineno">   65</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][0] = 0.0;</div>
<div class="line"><span class="lineno">   66</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][1] = 0.0;</div>
<div class="line"><span class="lineno">   67</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][2] = 0.0;</div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="astructnnp_1_1Structure_html_a177773f58df6da23d833e1cca0eb2cf8"><div class="ttname"><a href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">nnp::Structure::invbox</a></div><div class="ttdeci">Vec3D invbox[3]</div><div class="ttdoc">Inverse simulation box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00114">Structure.h:114</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a21e5cd213176fab9075b3f040dd6dee6"><div class="ttname"><a href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">nnp::Structure::box</a></div><div class="ttdeci">Vec3D box[3]</div><div class="ttdoc">Simulation box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00112">Structure.h:112</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a2627321edafea60f478b35e7387e0681"><div class="ttname"><a href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">nnp::Structure::isTriclinic</a></div><div class="ttdeci">bool isTriclinic</div><div class="ttdoc">If the simulation box is triclinic.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00063">Structure.h:63</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4d519c01388cad10212f64eda1fa6c8b"><div class="ttname"><a href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">nnp::Structure::comment</a></div><div class="ttdeci">std::string comment</div><div class="ttdoc">Structure comment.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00110">Structure.h:110</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4d8ebcacb8fc434178c7c90cb2f70110"><div class="ttname"><a href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">nnp::Structure::isPeriodic</a></div><div class="ttdeci">bool isPeriodic</div><div class="ttdoc">If periodic boundary conditions apply.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00061">Structure.h:61</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4f2cb7342755dc1305b5105a5512c129"><div class="ttname"><a href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">nnp::Structure::maxCutoffRadiusOverall</a></div><div class="ttdeci">double maxCutoffRadiusOverall</div><div class="ttdoc">Maximum cut-off radius with respect to symmetry functions, screening function and Ewald summation.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00103">Structure.h:103</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a50427699538016623ef2331c9eb67f01"><div class="ttname"><a href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">nnp::Structure::charge</a></div><div class="ttdeci">double charge</div><div class="ttdoc">Charge determined by neural network potential.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00096">Structure.h:96</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a5142f63d6a9301709e67197438ef77d1"><div class="ttname"><a href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">nnp::Structure::NeighborListIsSorted</a></div><div class="ttdeci">bool NeighborListIsSorted</div><div class="ttdoc">If the neighbor list has been sorted by distance.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00067">Structure.h:67</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a5af7b5cd0a2154c2e34a3b8a73a51ca6"><div class="ttname"><a href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">nnp::Structure::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdoc">Index number of this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00073">Structure.h:73</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a65839bc1a3213a6d77e064b5edade786"><div class="ttname"><a href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">nnp::Structure::chargeRef</a></div><div class="ttdeci">double chargeRef</div><div class="ttdoc">Reference charge.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00098">Structure.h:98</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a6665217897b26fa4fd01a07aa652cd2f"><div class="ttname"><a href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">nnp::Structure::sampleType</a></div><div class="ttdeci">SampleType sampleType</div><div class="ttdoc">Sample type (training or test set).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00108">Structure.h:108</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a6c2903270f6db9ebf27d59dab9bd2914"><div class="ttname"><a href="structnnp_1_1Structure.html#a6c2903270f6db9ebf27d59dab9bd2914">nnp::Structure::energyShort</a></div><div class="ttdeci">double energyShort</div><div class="ttdoc">Short-range part of the potential energy predicted by NNP.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00088">Structure.h:88</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a79b8f1a7b53aebd41dab2838084b5618"><div class="ttname"><a href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">nnp::Structure::hasAMatrix</a></div><div class="ttdeci">bool hasAMatrix</div><div class="ttdoc">If A matrix of this structure is currently stored.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00118">Structure.h:118</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a82f10399909e0f7fa8f6344c305781cc"><div class="ttname"><a href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for each atom.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00071">Structure.h:71</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aa8d5c1fa9994b603c38e25250da743df"><div class="ttname"><a href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">nnp::Structure::energyElec</a></div><div class="ttdeci">double energyElec</div><div class="ttdoc">Electrostatics part of the potential energy predicted by NNP.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00091">Structure.h:91</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00083">Structure.h:83</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aaee087b13af754a75198def4d12c8b61"><div class="ttname"><a href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a></div><div class="ttdeci">double energyRef</div><div class="ttdoc">Reference potential energy.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00085">Structure.h:85</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"><div class="ttname"><a href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">nnp::Structure::pbc</a></div><div class="ttdeci">int pbc[3]</div><div class="ttdoc">Number of PBC images necessary in each direction for max cut-off.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00081">Structure.h:81</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ac8c6f2c95c4ca25893d2be192effff3d"><div class="ttname"><a href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">nnp::Structure::volume</a></div><div class="ttdeci">double volume</div><div class="ttdoc">Simulation box volume.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00100">Structure.h:100</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ad2c737c945e42ec42fa852e4dbacaf90"><div class="ttname"><a href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a></div><div class="ttdeci">std::size_t numAtoms</div><div class="ttdoc">Total number of atoms present in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00075">Structure.h:75</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ad47f8d1a1742f5430418fcd1b8919eb6"><div class="ttname"><a href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">nnp::Structure::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdoc">Global number of elements (all structures).</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00077">Structure.h:77</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ae2fa28a5a6b564d3ec23a6905736730a"><div class="ttname"><a href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">nnp::Structure::numElementsPresent</a></div><div class="ttdeci">std::size_t numElementsPresent</div><div class="ttdoc">Number of elements present in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00079">Structure.h:79</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_af21dfbdaf41e8332ee0f773a070f3f74"><div class="ttname"><a href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">nnp::Structure::hasNeighborList</a></div><div class="ttdeci">bool hasNeighborList</div><div class="ttdoc">If the neighbor list has been calculated.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00065">Structure.h:65</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_af9eaacc767607b846ddf9b30109c570e"><div class="ttname"><a href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">nnp::Structure::hasCharges</a></div><div class="ttdeci">bool hasCharges</div><div class="ttdoc">If all charges of this structure have been calculated (and stay the same, e.g.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00094">Structure.h:94</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_aff934fe32fb46e93dd9551d50ed4b0b6"><div class="ttname"><a href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for each atom.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00069">Structure.h:69</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, and <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a57c375126ca37e8d390d406091e7dd5a" name="a57c375126ca37e8d390d406091e7dd5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57c375126ca37e8d390d406091e7dd5a">&#9670;&nbsp;</a></span>setElementMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::setElementMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> const &amp;&#160;</td>
          <td class="paramname"><em>elementMap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set element map of structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">elementMap</td><td>Reference to a map containing all possible (symbol, index)-pairs (see <a class="el" href="classnnp_1_1ElementMap.html" title="Contains element map.">ElementMap</a>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00071">71</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span>{</div>
<div class="line"><span class="lineno">   73</span>    this-&gt;<a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a> = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>;</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a> = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>();</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_a94031b84fe2b38bbdb62ba700d5481a4"><div class="ttname"><a href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Get element map size.</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8h_source.html#l00140">ElementMap.h:140</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a3427c9bd877e3bf72ad71f30dfb76ac2"><div class="ttname"><a href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numAtomsPerElement</div><div class="ttdoc">Number of atoms of each element in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00120">Structure.h:120</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a56766c6996fa1bf63e4616b7fd03c84e"><div class="ttname"><a href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">nnp::Structure::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Copy of element map provided as constructor argument.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00059">Structure.h:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, and <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a78629b5a9034f2b06a4cd54a082e7ef0">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, and <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a70609e0f2ee4740e959d9b4462f3283d">LAMMPS_NS::PairHDNNPExternal::settings()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph" id="astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_cgraph">
<area shape="rect" title="Set element map of structure." alt="" coords="5,5,228,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="276,5,447,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph" id="astructnnp_1_1Structure_a57c375126ca37e8d390d406091e7dd5a_icgraph">
<area shape="rect" title="Set element map of structure." alt="" coords="395,166,617,193"/>
<area shape="rect" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd" title="Read data file and distribute structures among processors." alt="" coords="140,5,315,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a78629b5a9034f2b06a4cd54a082e7ef0" title="Initialize the LAMMPS interface." alt="" coords="143,71,311,112"/>
<area shape="rect" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,166,60,193"/>
<area shape="rect" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4" title="Prepare numeric force check for a single structure." alt="" coords="118,188,337,229"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="120,253,335,295"/>
<area shape="rect" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a70609e0f2ee4740e959d9b4462f3283d" title=" " alt="" coords="108,319,347,360"/>
</map>
</div>

</div>
</div>
<a id="a7b676463d894c0988c645fed1ddf36b1" name="a7b676463d894c0988c645fed1ddf36b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b676463d894c0988c645fed1ddf36b1">&#9670;&nbsp;</a></span>addAtom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::addAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Atom.html">Atom</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>element</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a single atom to structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">atom</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> to insert. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">element</td><td><a class="el" href="classnnp_1_1Element.html" title="Contains element-specific data.">Element</a> string of new atom.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Be sure to set the element map properly before adding atoms. This function will only keep the atom's coordinates, energy, charge, tag and forces, all other members will be cleared or reset (in particular, the neighbor list and symmetry function data will be deleted). </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00080">80</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>{</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.push_back(<a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>());</div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back() = atom;</div>
<div class="line"><span class="lineno">   84</span>    <span class="comment">// The number of elements may have changed.</span></div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numNeighborsPerElement.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>(), 0);</div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().clearNeighborList();</div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().index                = <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><span class="lineno">   88</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().indexStructure       = <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>;</div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().element              = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[element];</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numSymmetryFunctions = 0;</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>++;</div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[<a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[element]]++;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   95</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html"><div class="ttname"><a href="structnnp_1_1Atom.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00032">Atom.h:33</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00122">Structure.h:122</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, and <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph" id="astructnnp_1_1Structure_a7b676463d894c0988c645fed1ddf36b1_cgraph">
<area shape="rect" title="Add a single atom to structure." alt="" coords="5,5,185,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="233,5,404,32"/>
</map>
</div>

</div>
</div>
<a id="aaa794cf49a53d8e5db578ac303b700fd" name="aaa794cf49a53d8e5db578ac303b700fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa794cf49a53d8e5db578ac303b700fd">&#9670;&nbsp;</a></span>readFromFile() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromFile </td>
          <td>(</td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;input.data&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Input file name.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads the first configuration found in the input file. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00097">97</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>{</div>
<div class="line"><span class="lineno">   99</span>    ifstream file;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    file.open(fileName.c_str());</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span> (!file.is_open())</div>
<div class="line"><span class="lineno">  103</span>    {</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div>
<div class="line"><span class="lineno">  105</span>                            + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile</a>(file);</div>
<div class="line"><span class="lineno">  108</span>    file.close();</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="astructnnp_1_1Structure_html_aaa794cf49a53d8e5db578ac303b700fd"><div class="ttname"><a href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">nnp::Structure::readFromFile</a></div><div class="ttdeci">void readFromFile(std::string const fileName=&quot;input.data&quot;)</div><div class="ttdoc">Read configuration from file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00097">Structure.cpp:97</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#aaa794cf49a53d8e5db578ac303b700fd">readFromFile()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_cgraph" id="astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_cgraph">
<area shape="rect" title="Read configuration from file." alt="" coords="5,29,212,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph" id="astructnnp_1_1Structure_aaa794cf49a53d8e5db578ac303b700fd_icgraph">
<area shape="rect" title="Read configuration from file." alt="" coords="268,71,475,98"/>
<area shape="rect" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd" title="Read data file and distribute structures among processors." alt="" coords="25,5,200,47"/>
<area shape="rect" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="85,71,140,98"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="5,123,220,164"/>
</map>
</div>

</div>
</div>
<a id="a9d8474b4633b73815022742af96b0a77" name="a9d8474b4633b73815022742af96b0a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8474b4633b73815022742af96b0a77">&#9670;&nbsp;</a></span>readFromFile() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromFile </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>Input file stream (already opened).</td></tr>
  </table>
  </dd>
</dl>
<p>Expects that a file with configurations is open, first keyword on first line should be <code>begin</code>. Reads until keyword is <code>end</code>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00113">113</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span>{</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">string</span>         line;</div>
<div class="line"><span class="lineno">  116</span>    vector&lt;string&gt; lines;</div>
<div class="line"><span class="lineno">  117</span>    vector&lt;string&gt; splitLine;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="comment">// read first line, should be keyword &quot;begin&quot;.</span></div>
<div class="line"><span class="lineno">  120</span>    getline(file, line);</div>
<div class="line"><span class="lineno">  121</span>    lines.push_back(line);</div>
<div class="line"><span class="lineno">  122</span>    splitLine = <a class="code hl_function" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code hl_function" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(line));</div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">if</span> (splitLine.at(0) != <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><span class="lineno">  124</span>    {</div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected file content, expected&quot;</span></div>
<div class="line"><span class="lineno">  126</span>                            <span class="stringliteral">&quot; \&quot;begin\&quot; keyword.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">while</span> (getline(file, line))</div>
<div class="line"><span class="lineno">  130</span>    {</div>
<div class="line"><span class="lineno">  131</span>        lines.push_back(line);</div>
<div class="line"><span class="lineno">  132</span>        splitLine = <a class="code hl_function" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code hl_function" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(line));</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;end&quot;</span>) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines</a>(lines);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  139</span>}</div>
<div class="ttc" id="anamespacennp_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00033">utility.cpp:33</a></div></div>
<div class="ttc" id="anamespacennp_html_aaa30280456ea59152f9e6c240f41ea93"><div class="ttname"><a href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00060">utility.cpp:60</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ae3f4816f60d52e90cf213479ef443b32"><div class="ttname"><a href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">nnp::Structure::readFromLines</a></div><div class="ttdeci">void readFromLines(std::vector&lt; std::string &gt; const &amp;lines)</div><div class="ttdoc">Read configuration from lines.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00142">Structure.cpp:142</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce()</a>, and <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph" id="astructnnp_1_1Structure_a9d8474b4633b73815022742af96b0a77_cgraph">
<area shape="rect" title="Read configuration from file." alt="" coords="5,32,212,59"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="260,25,443,66"/>
<area shape="rect" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93" title="Replace multiple whitespaces with fill." alt="" coords="491,5,589,32"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="499,60,581,87"/>
</map>
</div>

</div>
</div>
<a id="ae3f4816f60d52e90cf213479ef443b32" name="ae3f4816f60d52e90cf213479ef443b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f4816f60d52e90cf213479ef443b32">&#9670;&nbsp;</a></span>readFromLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::readFromLines </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt; const &amp;&#160;</td>
          <td class="paramname"><em>lines</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read configuration from lines. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lines</td><td>One configuration in form of a vector of strings.</td></tr>
  </table>
  </dd>
</dl>
<p>Read the configuration from a vector of strings. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00142">142</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  143</span>{</div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordtype">size_t</span>         iBoxVector = 0;</div>
<div class="line"><span class="lineno">  145</span>    vector&lt;string&gt; splitLine;</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// read first line, should be keyword &quot;begin&quot;.</span></div>
<div class="line"><span class="lineno">  148</span>    splitLine = <a class="code hl_function" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code hl_function" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(lines.at(0)));</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">if</span> (splitLine.at(0) != <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><span class="lineno">  150</span>    {</div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected line content, expected&quot;</span></div>
<div class="line"><span class="lineno">  152</span>                            <span class="stringliteral">&quot; \&quot;begin\&quot; keyword.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  153</span>    }</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">for</span> (vector&lt;string&gt;::const_iterator line = lines.begin();</div>
<div class="line"><span class="lineno">  156</span>         line != lines.end(); ++line)</div>
<div class="line"><span class="lineno">  157</span>    {</div>
<div class="line"><span class="lineno">  158</span>        splitLine = <a class="code hl_function" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code hl_function" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">reduce</a>(*line));</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><span class="lineno">  160</span>        {</div>
<div class="line"><span class="lineno">  161</span>            <span class="keywordflow">if</span> (splitLine.size() &gt; 1)</div>
<div class="line"><span class="lineno">  162</span>            {</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">for</span> (vector&lt;string&gt;::const_iterator word =</div>
<div class="line"><span class="lineno">  164</span>                     splitLine.begin() + 1; word != splitLine.end(); ++word)</div>
<div class="line"><span class="lineno">  165</span>                {</div>
<div class="line"><span class="lineno">  166</span>                    <span class="keywordflow">if</span>      (*word == <span class="stringliteral">&quot;set=train&quot;</span>) <a class="code hl_variable" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a> = <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>;</div>
<div class="line"><span class="lineno">  167</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*word == <span class="stringliteral">&quot;set=test&quot;</span>) <a class="code hl_variable" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a> = <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a>;</div>
<div class="line"><span class="lineno">  168</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  169</span>                    {</div>
<div class="line"><span class="lineno">  170</span>                        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown keyword in &quot;</span></div>
<div class="line"><span class="lineno">  171</span>                                            <span class="stringliteral">&quot;structure specification, check &quot;</span></div>
<div class="line"><span class="lineno">  172</span>                                            <span class="stringliteral">&quot;\&quot;begin\&quot; arguments.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  173</span>                    }</div>
<div class="line"><span class="lineno">  174</span>                }</div>
<div class="line"><span class="lineno">  175</span>            }</div>
<div class="line"><span class="lineno">  176</span>        }</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;comment&quot;</span>)</div>
<div class="line"><span class="lineno">  178</span>        {</div>
<div class="line"><span class="lineno">  179</span>            <span class="keywordtype">size_t</span> position = line-&gt;find(<span class="stringliteral">&quot;comment&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordtype">string</span> tmpLine = *line;</div>
<div class="line"><span class="lineno">  181</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a> = tmpLine.erase(position, splitLine.at(0).length() + 1);</div>
<div class="line"><span class="lineno">  182</span>        }</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;lattice&quot;</span>)</div>
<div class="line"><span class="lineno">  184</span>        {</div>
<div class="line"><span class="lineno">  185</span>            <span class="keywordflow">if</span> (iBoxVector &gt; 2)</div>
<div class="line"><span class="lineno">  186</span>            {</div>
<div class="line"><span class="lineno">  187</span>                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Too many box vectors.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  188</span>            }</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][0] = atof(splitLine.at(1).c_str());</div>
<div class="line"><span class="lineno">  190</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][1] = atof(splitLine.at(2).c_str());</div>
<div class="line"><span class="lineno">  191</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[iBoxVector][2] = atof(splitLine.at(3).c_str());</div>
<div class="line"><span class="lineno">  192</span>            iBoxVector++;</div>
<div class="line"><span class="lineno">  193</span>            <span class="keywordflow">if</span> (iBoxVector == 3)</div>
<div class="line"><span class="lineno">  194</span>            {</div>
<div class="line"><span class="lineno">  195</span>                <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  196</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><span class="lineno">  197</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><span class="lineno">  198</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><span class="lineno">  199</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><span class="lineno">  200</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] &gt; numeric_limits&lt;double&gt;::min() ||</div>
<div class="line"><span class="lineno">  201</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] &gt; numeric_limits&lt;double&gt;::min())</div>
<div class="line"><span class="lineno">  202</span>                {</div>
<div class="line"><span class="lineno">  203</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  204</span>                }</div>
<div class="line"><span class="lineno">  205</span>                <a class="code hl_function" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox</a>();</div>
<div class="line"><span class="lineno">  206</span>                <a class="code hl_function" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume</a>();</div>
<div class="line"><span class="lineno">  207</span>            }</div>
<div class="line"><span class="lineno">  208</span>        }</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;atom&quot;</span>)</div>
<div class="line"><span class="lineno">  210</span>        {</div>
<div class="line"><span class="lineno">  211</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.push_back(<a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>());</div>
<div class="line"><span class="lineno">  212</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().index          = <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><span class="lineno">  213</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().indexStructure = <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>;</div>
<div class="line"><span class="lineno">  214</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().tag            = <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; <span class="comment">// Implicit conversion!</span></div>
<div class="line"><span class="lineno">  215</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[0]           = atof(splitLine.at(1).c_str());</div>
<div class="line"><span class="lineno">  216</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[1]           = atof(splitLine.at(2).c_str());</div>
<div class="line"><span class="lineno">  217</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().r[2]           = atof(splitLine.at(3).c_str());</div>
<div class="line"><span class="lineno">  218</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().element        = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[splitLine.at(4)];</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().chargeRef      = atof(splitLine.at(5).c_str());</div>
<div class="line"><span class="lineno">  220</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[0]        = atof(splitLine.at(7).c_str());</div>
<div class="line"><span class="lineno">  221</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[1]        = atof(splitLine.at(8).c_str());</div>
<div class="line"><span class="lineno">  222</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().fRef[2]        = atof(splitLine.at(9).c_str());</div>
<div class="line"><span class="lineno">  223</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.back().numNeighborsPerElement.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><span class="lineno">  224</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>++;</div>
<div class="line"><span class="lineno">  225</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[<a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[splitLine.at(4)]]++;</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><span class="lineno">  228</span>        {</div>
<div class="line"><span class="lineno">  229</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = atof(splitLine[1].c_str());</div>
<div class="line"><span class="lineno">  230</span>        }</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><span class="lineno">  232</span>        {</div>
<div class="line"><span class="lineno">  233</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a> = atof(splitLine[1].c_str());</div>
<div class="line"><span class="lineno">  234</span>        }</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitLine.at(0) == <span class="stringliteral">&quot;end&quot;</span>)</div>
<div class="line"><span class="lineno">  236</span>        {</div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordflow">if</span> (!(iBoxVector == 0 || iBoxVector == 3))</div>
<div class="line"><span class="lineno">  238</span>            {</div>
<div class="line"><span class="lineno">  239</span>                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Strange number of box vectors.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  240</span>            }</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  242</span>                abs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>) &gt; 10*std::numeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><span class="lineno">  243</span>            {</div>
<div class="line"><span class="lineno">  244</span>                <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: In structure with index &quot;</span></div>
<div class="line"><span class="lineno">  245</span>                                    + to_string(<a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>)</div>
<div class="line"><span class="lineno">  246</span>                                    + <span class="stringliteral">&quot;; if PBCs are applied, the\n&quot;</span></div>
<div class="line"><span class="lineno">  247</span>                                    <span class="stringliteral">&quot;simulation cell has to be neutrally &quot;</span></div>
<div class="line"><span class="lineno">  248</span>                                    <span class="stringliteral">&quot;charged.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  249</span>            }</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  251</span>        }</div>
<div class="line"><span class="lineno">  252</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  253</span>        {</div>
<div class="line"><span class="lineno">  254</span>            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unexpected file content, &quot;</span></div>
<div class="line"><span class="lineno">  255</span>                                <span class="stringliteral">&quot;unknown keyword \&quot;&quot;</span> + splitLine.at(0) +</div>
<div class="line"><span class="lineno">  256</span>                                <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>        }</div>
<div class="line"><span class="lineno">  258</span>    }</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>; i++)</div>
<div class="line"><span class="lineno">  261</span>    {</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>[i] &gt; 0)</div>
<div class="line"><span class="lineno">  263</span>        {</div>
<div class="line"><span class="lineno">  264</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>++;</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>) <a class="code hl_function" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap</a>();</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  271</span>}</div>
<div class="ttc" id="astructnnp_1_1Structure_html_a10f626682421d3690d8f1cb9ceba006f"><div class="ttname"><a href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">nnp::Structure::calculateVolume</a></div><div class="ttdeci">void calculateVolume()</div><div class="ttdoc">Calculate volume from box vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00581">Structure.cpp:581</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a60c37b89d8e32f6785168f6a6c201859"><div class="ttname"><a href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">nnp::Structure::remap</a></div><div class="ttdeci">void remap()</div><div class="ttdoc">Translate all atoms back into box if outside.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l01214">Structure.cpp:1214</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a7d4ec60f305ae52787eb7dc0995eaec3"><div class="ttname"><a href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">nnp::Structure::calculateInverseBox</a></div><div class="ttdeci">void calculateInverseBox()</div><div class="ttdoc">Calculate inverse box.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00519">Structure.cpp:519</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93">nnp::reduce()</a>, <a class="el" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ead9a235ef8a8768016b5e7192ba619719">ST_TEST</a>, and <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea5fcad5340deda6f39ae1f68aeb252c50">ST_TRAINING</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77">readFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph" id="astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_cgraph">
<area shape="rect" title="Read configuration from lines." alt="" coords="5,129,188,171"/>
<area shape="rect" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3" title="Calculate inverse box." alt="" coords="236,5,416,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f" title="Calculate volume from box vectors." alt="" coords="236,71,416,112"/>
<area shape="rect" href="namespacennp.html#aaa30280456ea59152f9e6c240f41ea93" title="Replace multiple whitespaces with fill." alt="" coords="277,137,375,163"/>
<area shape="rect" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859" title="Translate all atoms back into box if outside." alt="" coords="245,211,407,238"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="285,262,367,289"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph" id="astructnnp_1_1Structure_ae3f4816f60d52e90cf213479ef443b32_icgraph">
<area shape="rect" title="Read configuration from lines." alt="" coords="260,5,443,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a9d8474b4633b73815022742af96b0a77" title="Read configuration from file." alt="" coords="5,13,212,39"/>
</map>
</div>

</div>
</div>
<a id="a46770abdefe49a0ab488049caa99905c" name="a46770abdefe49a0ab488049caa99905c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46770abdefe49a0ab488049caa99905c">&#9670;&nbsp;</a></span>calculateMaxCutoffRadiusOverall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateMaxCutoffRadiusOverall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;&#160;</td>
          <td class="paramname"><em>ewaldSetup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rcutScreen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxCutoffRadius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate maximal cut-off if cut-off of screening and real part Ewald summation are also considered. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ewaldSetup</td><td>Settings of Ewald summation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rcutScreen</td><td>Cut-off for Screening of the electrostatic interaction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxCutoffRadius</td><td>maximal cut-off of symmetry functions. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00273">273</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  277</span>{</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a> = max(rcutScreen, maxCutoffRadius);</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno">  280</span>    {</div>
<div class="line"><span class="lineno">  281</span>        ewaldSetup.<a class="code hl_function" href="classnnp_1_1EwaldSetup.html#a8949052d94e44b945a7deae8ad711db4">calculateParameters</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno">  282</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a> = max(<a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>,</div>
<div class="line"><span class="lineno">  283</span>                                     ewaldSetup.<a class="code hl_variable" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">params</a>.<a class="code hl_variable" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">rCut</a>);</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>}</div>
<div class="ttc" id="aclassnnp_1_1EwaldSetup_html_a137aa52c200ce7a4e4e0308526c19713"><div class="ttname"><a href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">nnp::EwaldSetup::params</a></div><div class="ttdeci">EwaldParameters params</div><div class="ttdef"><b>Definition:</b> <a href="EwaldSetup_8h_source.html#l00039">EwaldSetup.h:39</a></div></div>
<div class="ttc" id="aclassnnp_1_1EwaldSetup_html_a8949052d94e44b945a7deae8ad711db4"><div class="ttname"><a href="classnnp_1_1EwaldSetup.html#a8949052d94e44b945a7deae8ad711db4">nnp::EwaldSetup::calculateParameters</a></div><div class="ttdeci">void calculateParameters(double const newVolume, size_t const newNumAtoms)</div><div class="ttdoc">Compute eta, rCut and kCut.</div><div class="ttdef"><b>Definition:</b> <a href="EwaldSetup_8cpp_source.html#l00088">EwaldSetup.cpp:88</a></div></div>
<div class="ttc" id="astructnnp_1_1EwaldParameters_html_a4268c84c7743d37564cc5f7bdfff3848"><div class="ttname"><a href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">nnp::EwaldParameters::rCut</a></div><div class="ttdeci">double rCut</div><div class="ttdoc">Cutoff in real space.</div><div class="ttdef"><b>Definition:</b> <a href="IEwaldTrunc_8h_source.html#l00042">IEwaldTrunc.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classnnp_1_1EwaldSetup.html#a8949052d94e44b945a7deae8ad711db4">nnp::EwaldSetup::calculateParameters()</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">nnp::EwaldSetup::params</a>, <a class="el" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">nnp::EwaldParameters::rCut</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#adea10435a61aeda3d486184932e9ff3a">nnp::Mode::evaluateNNP()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627">nnp::InterfaceLammps::finalizeNeighborList()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#a424a1a3da552a795a7b1e945303905b6">nnp::InterfaceLammps::getMaxCutoffRadiusOverall()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_cgraph" id="astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_cgraph">
<area shape="rect" title="Calculate maximal cut&#45;off if cut&#45;off of screening and real part Ewald summation are also considered." alt="" coords="5,5,185,47"/>
<area shape="rect" href="classnnp_1_1EwaldSetup.html#a8949052d94e44b945a7deae8ad711db4" title="Compute eta, rCut and kCut." alt="" coords="233,5,431,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_icgraph" id="astructnnp_1_1Structure_a46770abdefe49a0ab488049caa99905c_icgraph">
<area shape="rect" title="Calculate maximal cut&#45;off if cut&#45;off of screening and real part Ewald summation are also considered." alt="" coords="263,57,443,98"/>
<area shape="rect" href="classnnp_1_1Mode.html#adea10435a61aeda3d486184932e9ff3a" title="Evaluate neural network potential (includes total energy, optionally forces and in some cases charges..." alt="" coords="19,5,201,32"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627" title="Sorts neighbor list and creates cutoff map if necessary." alt="" coords="26,57,194,98"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a424a1a3da552a795a7b1e945303905b6" title="Get largest cutoff including structure specific cutoff and screening cutoff." alt="" coords="5,122,215,163"/>
</map>
</div>

</div>
</div>
<a id="acd8b8ea17cc7579a3618a49623303483" name="acd8b8ea17cc7579a3618a49623303483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8b8ea17cc7579a3618a49623303483">&#9670;&nbsp;</a></span>calculateNeighborList() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateNeighborList </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sortByDistance</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate neighbor list for all atoms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>Atoms are neighbors if there distance is smaller than the cutoff radius. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sortByDistance</td><td>Sort neighborlist from nearest to farthest neighbor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00287">287</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>{</div>
<div class="line"><span class="lineno">  291</span>    cutoffRadius = max( cutoffRadius, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a> );</div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">//cout &lt;&lt; &quot;CUTOFF: &quot; &lt;&lt; cutoffRadius &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno">  295</span>    {</div>
<div class="line"><span class="lineno">  296</span>        <a class="code hl_function" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">calculatePbcCopies</a>(cutoffRadius, <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>);</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        <span class="comment">// Use square of cutoffRadius (faster).</span></div>
<div class="line"><span class="lineno">  299</span>        cutoffRadius *= cutoffRadius;</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  302</span><span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  303</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><span class="lineno">  305</span>        {</div>
<div class="line"><span class="lineno">  306</span>            <span class="comment">// Count atom i as unique neighbor.</span></div>
<div class="line"><span class="lineno">  307</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(i);</div>
<div class="line"><span class="lineno">  308</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><span class="lineno">  309</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; j++)</div>
<div class="line"><span class="lineno">  310</span>            {</div>
<div class="line"><span class="lineno">  311</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc0 = -<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]; bc0 &lt;= <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]; bc0++)</div>
<div class="line"><span class="lineno">  312</span>                {</div>
<div class="line"><span class="lineno">  313</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc1 = -<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]; bc1 &lt;= <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]; bc1++)</div>
<div class="line"><span class="lineno">  314</span>                    {</div>
<div class="line"><span class="lineno">  315</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bc2 = -<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]; bc2 &lt;= <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]; bc2++)</div>
<div class="line"><span class="lineno">  316</span>                        {</div>
<div class="line"><span class="lineno">  317</span>                            <span class="keywordflow">if</span> (!(i == j &amp;&amp; bc0 == 0 &amp;&amp; bc1 == 0 &amp;&amp; bc2 == 0))</div>
<div class="line"><span class="lineno">  318</span>                            {</div>
<div class="line"><span class="lineno">  319</span>                                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dr = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].r - <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].r</div>
<div class="line"><span class="lineno">  320</span>                                         + bc0 * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0]</div>
<div class="line"><span class="lineno">  321</span>                                         + bc1 * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]</div>
<div class="line"><span class="lineno">  322</span>                                         + bc2 * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2];</div>
<div class="line"><span class="lineno">  323</span>                                <span class="keywordflow">if</span> (dr.<a class="code hl_function" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">norm2</a>() &lt;= cutoffRadius)</div>
<div class="line"><span class="lineno">  324</span>                                {</div>
<div class="line"><span class="lineno">  325</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  326</span>                                        push_back(<a class="code hl_struct" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a>());</div>
<div class="line"><span class="lineno">  327</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  328</span>                                        back().index = j;</div>
<div class="line"><span class="lineno">  329</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  330</span>                                        back().tag = j; <span class="comment">// Implicit conversion!</span></div>
<div class="line"><span class="lineno">  331</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  332</span>                                        back().element = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element;</div>
<div class="line"><span class="lineno">  333</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  334</span>                                        back().d = dr.<a class="code hl_function" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">norm</a>();</div>
<div class="line"><span class="lineno">  335</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.</div>
<div class="line"><span class="lineno">  336</span>                                        back().dr = dr;</div>
<div class="line"><span class="lineno">  337</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsPerElement[</div>
<div class="line"><span class="lineno">  338</span>                                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element]++;</div>
<div class="line"><span class="lineno">  339</span>                                    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighbors++;</div>
<div class="line"><span class="lineno">  340</span>                                    <span class="comment">// Count atom j only once as unique</span></div>
<div class="line"><span class="lineno">  341</span>                                    <span class="comment">// neighbor.</span></div>
<div class="line"><span class="lineno">  342</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.back() != j &amp;&amp;</div>
<div class="line"><span class="lineno">  343</span>                                        i != j)</div>
<div class="line"><span class="lineno">  344</span>                                    {</div>
<div class="line"><span class="lineno">  345</span>                                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(j);</div>
<div class="line"><span class="lineno">  346</span>                                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><span class="lineno">  347</span>                                    }</div>
<div class="line"><span class="lineno">  348</span>                                }</div>
<div class="line"><span class="lineno">  349</span>                            }</div>
<div class="line"><span class="lineno">  350</span>                        }</div>
<div class="line"><span class="lineno">  351</span>                    }</div>
<div class="line"><span class="lineno">  352</span>                }</div>
<div class="line"><span class="lineno">  353</span>            }</div>
<div class="line"><span class="lineno">  354</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].hasNeighborList = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  355</span>        }</div>
<div class="line"><span class="lineno">  356</span>    }</div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  358</span>    {</div>
<div class="line"><span class="lineno">  359</span>        <span class="comment">// Use square of cutoffRadius (faster).</span></div>
<div class="line"><span class="lineno">  360</span>        cutoffRadius *= cutoffRadius;</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  363</span><span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  364</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><span class="lineno">  366</span>        {</div>
<div class="line"><span class="lineno">  367</span>            <span class="comment">// Count atom i as unique neighbor.</span></div>
<div class="line"><span class="lineno">  368</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(i);</div>
<div class="line"><span class="lineno">  369</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; j++)</div>
<div class="line"><span class="lineno">  371</span>            {</div>
<div class="line"><span class="lineno">  372</span>                <span class="keywordflow">if</span> (i != j)</div>
<div class="line"><span class="lineno">  373</span>                {</div>
<div class="line"><span class="lineno">  374</span>                    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dr = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].r - <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].r;</div>
<div class="line"><span class="lineno">  375</span>                    <span class="keywordflow">if</span> (dr.<a class="code hl_function" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">norm2</a>() &lt;= cutoffRadius)</div>
<div class="line"><span class="lineno">  376</span>                    {</div>
<div class="line"><span class="lineno">  377</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.push_back(<a class="code hl_struct" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a>());</div>
<div class="line"><span class="lineno">  378</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().index   = j;</div>
<div class="line"><span class="lineno">  379</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().tag     = j; <span class="comment">// Impl. conv.!</span></div>
<div class="line"><span class="lineno">  380</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().element = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element;</div>
<div class="line"><span class="lineno">  381</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().d       = dr.<a class="code hl_function" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">norm</a>();</div>
<div class="line"><span class="lineno">  382</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.back().dr      = dr;</div>
<div class="line"><span class="lineno">  383</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsPerElement[<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[j].element]++;</div>
<div class="line"><span class="lineno">  384</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighbors++;</div>
<div class="line"><span class="lineno">  385</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighborsUnique.push_back(j);</div>
<div class="line"><span class="lineno">  386</span>                        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].numNeighborsUnique++;</div>
<div class="line"><span class="lineno">  387</span>                    }</div>
<div class="line"><span class="lineno">  388</span>                }</div>
<div class="line"><span class="lineno">  389</span>            }</div>
<div class="line"><span class="lineno">  390</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].hasNeighborList = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  391</span>        }</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">if</span> (sortByDistance) <a class="code hl_function" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList</a>();</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  399</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html">nnp::Atom::Neighbor</a></div><div class="ttdoc">Struct to store information on neighbor atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00035">Atom.h:36</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a2fd80c1c4534a68182f88016fc1ea284"><div class="ttname"><a href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">nnp::Structure::sortNeighborList</a></div><div class="ttdeci">void sortNeighborList()</div><div class="ttdoc">Sort all neighbor lists of this structure with respect to the distance.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00409">Structure.cpp:409</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a924f2222a9df39041690d23f2d5963fd"><div class="ttname"><a href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">nnp::Structure::calculatePbcCopies</a></div><div class="ttdeci">void calculatePbcCopies(double cutoffRadius, int(&amp;pbc)[3])</div><div class="ttdoc">Calculate required PBC copies.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00486">Structure.cpp:486</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html"><div class="ttname"><a href="structnnp_1_1Vec3D.html">nnp::Vec3D</a></div><div class="ttdoc">Vector in 3 dimensional real space.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00029">Vec3D.h:30</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_a4dd2e5fef207b1bd2021142bf678f251"><div class="ttname"><a href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">nnp::Vec3D::norm2</a></div><div class="ttdeci">double norm2() const</div><div class="ttdoc">Calculate square of norm of vector.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00299">Vec3D.h:299</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_aeb7a761001a28045ccb6cfb175f5d399"><div class="ttname"><a href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">nnp::Vec3D::norm</a></div><div class="ttdeci">double norm() const</div><div class="ttdoc">Calculate norm of vector.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00294">Vec3D.h:294</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>, <a class="el" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399">nnp::Vec3D::norm()</a>, <a class="el" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251">nnp::Vec3D::norm2()</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>, and <a class="el" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931">calculateNeighborList()</a>, <a class="el" href="classnnp_1_1Mode.html#adea10435a61aeda3d486184932e9ff3a">nnp::Mode::evaluateNNP()</a>, and <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_cgraph" id="astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_cgraph">
<area shape="rect" title="Calculate neighbor list for all atoms." alt="" coords="5,89,185,131"/>
<area shape="rect" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd" title="Calculate required PBC copies." alt="" coords="257,5,437,47"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#aeb7a761001a28045ccb6cfb175f5d399" title="Calculate norm of vector." alt="" coords="279,71,416,98"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#a4dd2e5fef207b1bd2021142bf678f251" title="Calculate square of norm of vector." alt="" coords="275,122,420,149"/>
<area shape="rect" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284" title="Sort all neighbor lists of this structure with respect to the distance." alt="" coords="233,173,461,199"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_icgraph" id="astructnnp_1_1Structure_acd8b8ea17cc7579a3618a49623303483_icgraph">
<area shape="rect" title="Calculate neighbor list for all atoms." alt="" coords="236,64,416,105"/>
<area shape="rect" href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931" title="Calculate neighbor list for all atoms and setup neighbor cut&#45;off map." alt="" coords="7,5,187,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#adea10435a61aeda3d486184932e9ff3a" title="Evaluate neural network potential (includes total energy, optionally forces and in some cases charges..." alt="" coords="5,71,188,98"/>
<area shape="rect" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="69,122,124,149"/>
</map>
</div>

</div>
</div>
<a id="a16cce5a0b0a379f4432c2cacb1d83931" name="a16cce5a0b0a379f4432c2cacb1d83931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16cce5a0b0a379f4432c2cacb1d83931">&#9670;&nbsp;</a></span>calculateNeighborList() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateNeighborList </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>cutoffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate neighbor list for all atoms and setup neighbor cut-off map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>Atoms are neighbors if there distance is smaller than the cutoff radius. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffs</td><td>Vector of all needed cutoffs (needed for cut-off map construction). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum of {maxCutoffRadius, rcutScreen, rCut}. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00401">401</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  404</span>{</div>
<div class="line"><span class="lineno">  405</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList</a>(cutoffRadius, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap</a>(cutoffs);</div>
<div class="line"><span class="lineno">  407</span>}</div>
<div class="ttc" id="astructnnp_1_1Structure_html_a281cb20de35ca8ecbfab2a196be3c107"><div class="ttname"><a href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">nnp::Structure::setupNeighborCutoffMap</a></div><div class="ttdeci">void setupNeighborCutoffMap(std::vector&lt; std::vector&lt; double &gt; &gt; cutoffs)</div><div class="ttdoc">Set up a neighbor cut-off map which gives the index (value) of the last needed neighbor corresponding...</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00423">Structure.cpp:423</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_acd8b8ea17cc7579a3618a49623303483"><div class="ttname"><a href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">nnp::Structure::calculateNeighborList</a></div><div class="ttdeci">void calculateNeighborList(double cutoffRadius, bool sortByDistance=false)</div><div class="ttdoc">Calculate neighbor list for all atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00287">Structure.cpp:287</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, and <a class="el" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a16cce5a0b0a379f4432c2cacb1d83931_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a16cce5a0b0a379f4432c2cacb1d83931_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a16cce5a0b0a379f4432c2cacb1d83931_cgraph" id="astructnnp_1_1Structure_a16cce5a0b0a379f4432c2cacb1d83931_cgraph">
<area shape="rect" title="Calculate neighbor list for all atoms and setup neighbor cut&#45;off map." alt="" coords="5,39,185,80"/>
<area shape="rect" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483" title="Calculate neighbor list for all atoms." alt="" coords="251,5,431,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107" title="Set up a neighbor cut&#45;off map which gives the index (value) of the last needed neighbor corresponding..." alt="" coords="233,71,449,112"/>
</map>
</div>

</div>
</div>
<a id="a2fd80c1c4534a68182f88016fc1ea284" name="a2fd80c1c4534a68182f88016fc1ea284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fd80c1c4534a68182f88016fc1ea284">&#9670;&nbsp;</a></span>sortNeighborList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::sortNeighborList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort all neighbor lists of this structure with respect to the distance. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00409">409</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  410</span>{</div>
<div class="line"><span class="lineno">  411</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  412</span><span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  413</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  415</span>    {</div>
<div class="line"><span class="lineno">  416</span>        sort(<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.begin(), <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].neighbors.end());</div>
<div class="line"><span class="lineno">  417</span>        <span class="comment">//TODO: maybe sort neighborsUnique too?</span></div>
<div class="line"><span class="lineno">  418</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].NeighborListIsSorted = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  421</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627">nnp::InterfaceLammps::finalizeNeighborList()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a2fd80c1c4534a68182f88016fc1ea284_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a2fd80c1c4534a68182f88016fc1ea284_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a2fd80c1c4534a68182f88016fc1ea284_icgraph" id="astructnnp_1_1Structure_a2fd80c1c4534a68182f88016fc1ea284_icgraph">
<area shape="rect" title="Sort all neighbor lists of this structure with respect to the distance." alt="" coords="233,46,461,73"/>
<area shape="rect" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483" title="Calculate neighbor list for all atoms." alt="" coords="5,5,185,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627" title="Sorts neighbor list and creates cutoff map if necessary." alt="" coords="11,71,179,112"/>
</map>
</div>

</div>
</div>
<a id="a281cb20de35ca8ecbfab2a196be3c107" name="a281cb20de35ca8ecbfab2a196be3c107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281cb20de35ca8ecbfab2a196be3c107">&#9670;&nbsp;</a></span>setupNeighborCutoffMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::setupNeighborCutoffMap </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td>
          <td class="paramname"><em>cutoffs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a neighbor cut-off map which gives the index (value) of the last needed neighbor corresponding to a specific cut-off (key). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffs</td><td>Vector of all needed symmetry function cutoffs. Note that a local copy gets extended with maxCutoffRadiusOverall. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00423">423</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>{</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">if</span> ( !<a class="code hl_variable" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a> )</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;NeighborCutoffs map needs a sorted neighbor list&quot;</span>);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">for</span> ( <span class="keyword">auto</span>&amp; elementCutoffs : cutoffs )</div>
<div class="line"><span class="lineno">  430</span>    {</div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a> &gt; 0 &amp;&amp;</div>
<div class="line"><span class="lineno">  432</span>             !<a class="code hl_function" href="namespacennp.html#a431f556c745c1ee81a32e80d0def6c0a">vectorContains</a>(elementCutoffs, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>))</div>
<div class="line"><span class="lineno">  433</span>        {</div>
<div class="line"><span class="lineno">  434</span>            elementCutoffs.push_back(<a class="code hl_variable" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>);</div>
<div class="line"><span class="lineno">  435</span>        }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">if</span> ( !is_sorted(elementCutoffs.begin(), elementCutoffs.end()) )</div>
<div class="line"><span class="lineno">  438</span>        {</div>
<div class="line"><span class="lineno">  439</span>            sort(elementCutoffs.begin(), elementCutoffs.end());</div>
<div class="line"><span class="lineno">  440</span>        }</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="comment">// Loop over all atoms in this structure and create its neighborCutoffs map</span></div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp; a : <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a> )</div>
<div class="line"><span class="lineno">  445</span>    {</div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordtype">size_t</span> <span class="keyword">const</span> eIndex = a.element;</div>
<div class="line"><span class="lineno">  447</span>        vector&lt;double&gt; <span class="keyword">const</span>&amp; elementCutoffs = cutoffs.at(eIndex);</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordtype">size_t</span> in = 0;</div>
<div class="line"><span class="lineno">  449</span>        <span class="keywordtype">size_t</span> ic = 0;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">while</span>( in &lt; a.numNeighbors &amp;&amp; ic &lt; elementCutoffs.size() )</div>
<div class="line"><span class="lineno">  452</span>        {</div>
<div class="line"><span class="lineno">  453</span>            <a class="code hl_struct" href="structnnp_1_1Atom_1_1Neighbor.html">Atom::Neighbor</a> <span class="keyword">const</span>&amp; n = a.neighbors[in];</div>
<div class="line"><span class="lineno">  454</span>            <span class="comment">// If neighbor distance is higher than current &quot;desired cutoff&quot;</span></div>
<div class="line"><span class="lineno">  455</span>            <span class="comment">// then add neighbor cutoff.</span></div>
<div class="line"><span class="lineno">  456</span>            <span class="comment">// Attention: a step in the neighbor list could jump over multiple</span></div>
<div class="line"><span class="lineno">  457</span>            <span class="comment">// params -&gt; don&#39;t increment neighbor index</span></div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">if</span>( n.<a class="code hl_variable" href="structnnp_1_1Atom_1_1Neighbor.html#a46922b548b9819bbdeafaa0d9db9aa05">d</a> &gt; elementCutoffs[ic] )</div>
<div class="line"><span class="lineno">  459</span>            {</div>
<div class="line"><span class="lineno">  460</span>                a.neighborCutoffs.emplace( elementCutoffs.at(ic), in );</div>
<div class="line"><span class="lineno">  461</span>                ++ic;</div>
<div class="line"><span class="lineno">  462</span>            }</div>
<div class="line"><span class="lineno">  463</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( in == a.numNeighbors - 1 )</div>
<div class="line"><span class="lineno">  464</span>            {</div>
<div class="line"><span class="lineno">  465</span>                a.neighborCutoffs.emplace( elementCutoffs.at(ic), a.numNeighbors );</div>
<div class="line"><span class="lineno">  466</span>                ++ic;</div>
<div class="line"><span class="lineno">  467</span>            }</div>
<div class="line"><span class="lineno">  468</span>            <span class="keywordflow">else</span> ++in;</div>
<div class="line"><span class="lineno">  469</span>        }</div>
<div class="line"><span class="lineno">  470</span>    }</div>
<div class="line"><span class="lineno">  471</span>}</div>
<div class="ttc" id="anamespacennp_html_a431f556c745c1ee81a32e80d0def6c0a"><div class="ttname"><a href="namespacennp.html#a431f556c745c1ee81a32e80d0def6c0a">nnp::vectorContains</a></div><div class="ttdeci">bool vectorContains(std::vector&lt; T &gt; const &amp;stdVec, T value)</div><div class="ttdoc">Test if vector contains specified value.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00166">utility.h:166</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_1_1Neighbor_html_a46922b548b9819bbdeafaa0d9db9aa05"><div class="ttname"><a href="structnnp_1_1Atom_1_1Neighbor.html#a46922b548b9819bbdeafaa0d9db9aa05">nnp::Atom::Neighbor::d</a></div><div class="ttdeci">double d</div><div class="ttdoc">Distance to neighbor atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00044">Atom.h:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom_1_1Neighbor.html#a46922b548b9819bbdeafaa0d9db9aa05">nnp::Atom::Neighbor::d</a>, <a class="el" href="structnnp_1_1Structure.html#a4f2cb7342755dc1305b5105a5512c129">maxCutoffRadiusOverall</a>, <a class="el" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a>, and <a class="el" href="namespacennp.html#a431f556c745c1ee81a32e80d0def6c0a">nnp::vectorContains()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931">calculateNeighborList()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627">nnp::InterfaceLammps::finalizeNeighborList()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_cgraph" id="astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_cgraph">
<area shape="rect" title="Set up a neighbor cut&#45;off map which gives the index (value) of the last needed neighbor corresponding..." alt="" coords="5,5,221,47"/>
<area shape="rect" href="namespacennp.html#a431f556c745c1ee81a32e80d0def6c0a" title="Test if vector contains specified value." alt="" coords="269,13,421,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_icgraph" id="astructnnp_1_1Structure_a281cb20de35ca8ecbfab2a196be3c107_icgraph">
<area shape="rect" title="Set up a neighbor cut&#45;off map which gives the index (value) of the last needed neighbor corresponding..." alt="" coords="233,39,449,80"/>
<area shape="rect" href="structnnp_1_1Structure.html#a16cce5a0b0a379f4432c2cacb1d83931" title="Calculate neighbor list for all atoms and setup neighbor cut&#45;off map." alt="" coords="5,5,185,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627" title="Sorts neighbor list and creates cutoff map if necessary." alt="" coords="11,71,179,112"/>
</map>
</div>

</div>
</div>
<a id="a924f2222a9df39041690d23f2d5963fd" name="a924f2222a9df39041690d23f2d5963fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a924f2222a9df39041690d23f2d5963fd">&#9670;&nbsp;</a></span>calculatePbcCopies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculatePbcCopies </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(&amp;)&#160;</td>
          <td class="paramname"><em>pbc</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate required PBC copies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>Cutoff radius for neighbor list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pbc</td><td>Array for storing the result.</td></tr>
  </table>
  </dd>
</dl>
<p>Called by <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483" title="Calculate neighbor list for all atoms.">calculateNeighborList()</a>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00486">486</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  487</span>{</div>
<div class="line"><span class="lineno">  488</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> axb;</div>
<div class="line"><span class="lineno">  489</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> axc;</div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> bxc;</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    axb = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  493</span>    axc = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  494</span>    bxc = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordtype">double</span> proja = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] * bxc);</div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordtype">double</span> projb = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] * axc);</div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordtype">double</span> projc = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] * axb);</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0] = 0;</div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1] = 0;</div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2] = 0;</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0] * proja &lt;= cutoffRadius)</div>
<div class="line"><span class="lineno">  504</span>    {</div>
<div class="line"><span class="lineno">  505</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0]++;</div>
<div class="line"><span class="lineno">  506</span>    }</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1] * projb &lt;= cutoffRadius)</div>
<div class="line"><span class="lineno">  508</span>    {</div>
<div class="line"><span class="lineno">  509</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1]++;</div>
<div class="line"><span class="lineno">  510</span>    }</div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2] * projc &lt;= cutoffRadius)</div>
<div class="line"><span class="lineno">  512</span>    {</div>
<div class="line"><span class="lineno">  513</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]++;</div>
<div class="line"><span class="lineno">  514</span>    }</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  517</span>}</div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_a6a59afd117951d8bc98391da9d894741"><div class="ttname"><a href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">nnp::Vec3D::normalize</a></div><div class="ttdeci">Vec3D &amp; normalize()</div><div class="ttdoc">Normalize vector, norm equals 1.0 afterwards.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00309">Vec3D.h:309</a></div></div>
<div class="ttc" id="astructnnp_1_1Vec3D_html_acb8ab5515d194a43e10c2fa43636dffc"><div class="ttname"><a href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">nnp::Vec3D::cross</a></div><div class="ttdeci">Vec3D cross(Vec3D const &amp;v) const</div><div class="ttdoc">Cross product, argument vector is second in product.</div><div class="ttdef"><b>Definition:</b> <a href="Vec3D_8h_source.html#l00319">Vec3D.h:319</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">nnp::Vec3D::cross()</a>, <a class="el" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">nnp::Vec3D::normalize()</a>, and <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_cgraph" id="astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_cgraph">
<area shape="rect" title="Calculate required PBC copies." alt="" coords="5,23,185,65"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc" title="Cross product, argument vector is second in product." alt="" coords="249,5,386,32"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741" title="Normalize vector, norm equals 1.0 afterwards." alt="" coords="233,56,401,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_icgraph" id="astructnnp_1_1Structure_a924f2222a9df39041690d23f2d5963fd_icgraph">
<area shape="rect" title="Calculate required PBC copies." alt="" coords="233,5,413,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483" title="Calculate neighbor list for all atoms." alt="" coords="5,5,185,47"/>
</map>
</div>

</div>
</div>
<a id="a7d4ec60f305ae52787eb7dc0995eaec3" name="a7d4ec60f305ae52787eb7dc0995eaec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d4ec60f305ae52787eb7dc0995eaec3">&#9670;&nbsp;</a></span>calculateInverseBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateInverseBox </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate inverse box. </p>
<p >Simulation box looks like this:</p>
<p class="formulaDsp">
\[
h =
\begin{pmatrix}
\phantom{a_x} &amp; \phantom{b_x} &amp; \phantom{c_x} \\
\vec{\mathbf{a}} &amp; \vec{\mathbf{b}} &amp; \vec{\mathbf{c}} \\
\phantom{a_z} &amp; \phantom{b_z} &amp; \phantom{c_z} \\
\end{pmatrix} =
\begin{pmatrix}
a_x &amp; b_x &amp; c_x \\
a_y &amp; b_y &amp; c_y \\
a_z &amp; b_z &amp; c_z \\
\end{pmatrix},
\]
</p>
<p >where \(\vec{\mathbf{a}} = \) <code>box[0]</code>, \(\vec{\mathbf{b}} = \) <code>box[1]</code> and \(\vec{\mathbf{c}} = \) <code>box[2]</code>. Thus, indices are column first, row second:</p>
<p class="formulaDsp">
\[
h =
\begin{pmatrix}
\texttt{box[0][0]} &amp; \texttt{box[1][0]} &amp; \texttt{box[2][0]} \\
\texttt{box[0][1]} &amp; \texttt{box[1][1]} &amp; \texttt{box[2][1]} \\
\texttt{box[0][2]} &amp; \texttt{box[1][2]} &amp; \texttt{box[2][2]} \\
\end{pmatrix}.
\]
</p>
<p >The inverse box matrix (same scheme as above but with <code>invbox</code>) can be used to calculate fractional coordinates:</p>
<p class="formulaDsp">
\[
\begin{pmatrix}
f_0 \\ f_1 \\ f_2
\end{pmatrix} = h^{-1} \; \vec{\mathbf{r}}.
\]
</p>
 
<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00519">519</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  520</span>{</div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordtype">double</span> invdet = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]</div>
<div class="line"><span class="lineno">  522</span>                  + <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]</div>
<div class="line"><span class="lineno">  523</span>                  + <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]</div>
<div class="line"><span class="lineno">  524</span>                  - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]</div>
<div class="line"><span class="lineno">  525</span>                  - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]</div>
<div class="line"><span class="lineno">  526</span>                  - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><span class="lineno">  527</span>    invdet = 1.0 / invdet;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][0] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2];</div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][1] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][2] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2];</div>
<div class="line"><span class="lineno">  532</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] *= invdet;</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][0] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2];</div>
<div class="line"><span class="lineno">  535</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][1] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2];</div>
<div class="line"><span class="lineno">  536</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][2] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2];</div>
<div class="line"><span class="lineno">  537</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] *= invdet;</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][0] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1];</div>
<div class="line"><span class="lineno">  540</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][1] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1];</div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][2] = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1] - <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1];</div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] *= invdet;</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  545</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, and <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96">nnp::InterfaceLammps::setBoxVectors()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph" id="astructnnp_1_1Structure_a7d4ec60f305ae52787eb7dc0995eaec3_icgraph">
<area shape="rect" title="Calculate inverse box." alt="" coords="236,39,416,80"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="5,5,188,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96" title="Set box vectors of structure stored in LAMMPS (nnp/develop only)." alt="" coords="13,71,181,112"/>
</map>
</div>

</div>
</div>
<a id="a4a593b477540ad63365bfa292d0f54f1" name="a4a593b477540ad63365bfa292d0f54f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a593b477540ad63365bfa292d0f54f1">&#9670;&nbsp;</a></span>canMinimumImageConventionBeApplied()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Structure::canMinimumImageConventionBeApplied </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoffRadius</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if cut-off radius is small enough to apply minimum image convention. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cutoffRadius</td><td>cut-off radius for which condition should be checked. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00548">548</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  549</span>{</div>
<div class="line"><span class="lineno">  550</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> axb;</div>
<div class="line"><span class="lineno">  551</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> axc;</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> bxc;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    axb = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  555</span>    axc = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  556</span>    bxc = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1].<a class="code hl_function" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">cross</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2]).<a class="code hl_function" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">normalize</a>();</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordtype">double</span> proj[3];</div>
<div class="line"><span class="lineno">  559</span>    proj[0] = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] * bxc);</div>
<div class="line"><span class="lineno">  560</span>    proj[1] = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] * axc);</div>
<div class="line"><span class="lineno">  561</span>    proj[2] = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] * axb);</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordtype">double</span> minProj = *min_element(proj, proj+3);</div>
<div class="line"><span class="lineno">  564</span>    <span class="keywordflow">return</span> (cutoffRadius &lt; minProj / 2.0);</div>
<div class="line"><span class="lineno">  565</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc">nnp::Vec3D::cross()</a>, and <a class="el" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741">nnp::Vec3D::normalize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a4a593b477540ad63365bfa292d0f54f1_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a4a593b477540ad63365bfa292d0f54f1_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a4a593b477540ad63365bfa292d0f54f1_cgraph" id="astructnnp_1_1Structure_a4a593b477540ad63365bfa292d0f54f1_cgraph">
<area shape="rect" title="Check if cut&#45;off radius is small enough to apply minimum image convention." alt="" coords="5,23,212,65"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#acb8ab5515d194a43e10c2fa43636dffc" title="Cross product, argument vector is second in product." alt="" coords="275,5,413,32"/>
<area shape="rect" href="structnnp_1_1Vec3D.html#a6a59afd117951d8bc98391da9d894741" title="Normalize vector, norm equals 1.0 afterwards." alt="" coords="260,56,428,83"/>
</map>
</div>

</div>
</div>
<a id="acd3edbae28ee8196bc67bac988a83d93" name="acd3edbae28ee8196bc67bac988a83d93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd3edbae28ee8196bc67bac988a83d93">&#9670;&nbsp;</a></span>applyMinimumImageConvention()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> Structure::applyMinimumImageConvention </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> const &amp;&#160;</td>
          <td class="paramname"><em>dr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate distance between two atoms in the minimum image convention. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dr</td><td>Distance vector between two atoms of the same box. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00567">567</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  568</span>{</div>
<div class="line"><span class="lineno">  569</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> ds = <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a> * dr;</div>
<div class="line"><span class="lineno">  570</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dsNINT;</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;3; ++i)</div>
<div class="line"><span class="lineno">  573</span>    {</div>
<div class="line"><span class="lineno">  574</span>        dsNINT[i] = round(ds[i]);</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> drMin = <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a> * (ds - dsNINT);</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">return</span> drMin;</div>
<div class="line"><span class="lineno">  579</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, and <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>.</p>

</div>
</div>
<a id="a10f626682421d3690d8f1cb9ceba006f" name="a10f626682421d3690d8f1cb9ceba006f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f626682421d3690d8f1cb9ceba006f">&#9670;&nbsp;</a></span>calculateVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateVolume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate volume from box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00581">581</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  582</span>{</div>
<div class="line"><span class="lineno">  583</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> = fabs(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] * (<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1].cross(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2])));</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  586</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96">nnp::InterfaceLammps::setBoxVectors()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph" id="astructnnp_1_1Structure_a10f626682421d3690d8f1cb9ceba006f_icgraph">
<area shape="rect" title="Calculate volume from box vectors." alt="" coords="236,39,416,80"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="5,5,188,47"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96" title="Set box vectors of structure stored in LAMMPS (nnp/develop only)." alt="" coords="13,71,181,112"/>
</map>
</div>

</div>
</div>
<a id="a50ffe252cff725aa5bb952bb1d8cbf5a" name="a50ffe252cff725aa5bb952bb1d8cbf5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ffe252cff725aa5bb952bb1d8cbf5a">&#9670;&nbsp;</a></span>calculateElectrostaticEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Structure::calculateElectrostaticEnergy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;&#160;</td>
          <td class="paramname"><em>ewaldSetup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd&#160;</td>
          <td class="paramname"><em>hardness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd&#160;</td>
          <td class="paramname"><em>gammaSqrt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd&#160;</td>
          <td class="paramname"><em>sigmaSqrtPi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>fourPiEps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnnp_1_1ErfcBuf.html">ErfcBuf</a> &amp;&#160;</td>
          <td class="paramname"><em>erfcBuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute electrostatic energy with global charge equilibration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ewaldSetup</td><td>Settings of Ewald summation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hardness</td><td>Vector containing the hardness of all elements. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gammaSqrt2</td><td>Matrix combining gamma with prefactor. \( \text{gammaSqrt2}_{ij} = \sqrt{2} \gamma_{ij} 
                         = \sqrt{2} \sqrt{(\sigma_i^2 + \sigma_j^2)} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigmaSqrtPi</td><td>Vector combining sigma with prefactor, \( \text{sigmaSqrtPi}_i = \sqrt{\pi} \sigma_i \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>Screening function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fourPiEps</td><td>\( \text{fourPiEps} = 4 \pi \varepsilon_0 \). Value depends on unit system (e.g. normalization). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">erfcBuf</td><td>helper object to avoid repeated calculation of erfc(). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00588">588</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  596</span>{</div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> + 1, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> + 1);</div>
<div class="line"><span class="lineno">  598</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.setZero();</div>
<div class="line"><span class="lineno">  599</span>    VectorXd b(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> + 1);</div>
<div class="line"><span class="lineno">  600</span>    VectorXd hardnessJ(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno">  601</span>    VectorXd Q;</div>
<div class="line"><span class="lineno">  602</span>    erfcBuf.<a class="code hl_function" href="structnnp_1_1ErfcBuf.html#a90f60368ebcda5bdfbb17ff6b92b7717">reset</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, 2);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  605</span><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="lineno">  606</span>    {</div>
<div class="line"><span class="lineno">  607</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno">  609</span>    {</div>
<div class="line"><span class="lineno">  610</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  611</span><span class="preprocessor">#pragma omp single</span></div>
<div class="line"><span class="lineno">  612</span>        {</div>
<div class="line"><span class="lineno">  613</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a>)</div>
<div class="line"><span class="lineno">  615</span>        {</div>
<div class="line"><span class="lineno">  616</span>            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Neighbor list needs to &quot;</span></div>
<div class="line"><span class="lineno">  617</span>                                <span class="stringliteral">&quot;be sorted for Ewald summation!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  618</span>        }</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>        <span class="comment">// Should always happen already before neighborlist construction.</span></div>
<div class="line"><span class="lineno">  621</span>        <span class="comment">//ewaldSetup.calculateParameters(volume, numAtoms);</span></div>
<div class="line"><span class="lineno">  622</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  623</span>        }</div>
<div class="line"><span class="lineno">  624</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  625</span>        <a class="code hl_class" href="classnnp_1_1KspaceGrid.html">KspaceGrid</a> grid;</div>
<div class="line"><span class="lineno">  626</span>        grid.<a class="code hl_function" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f">setup</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, ewaldSetup);</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordtype">double</span> <span class="keyword">const</span> rcutReal = ewaldSetup.<a class="code hl_variable" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">params</a>.<a class="code hl_variable" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">rCut</a>;</div>
<div class="line"><span class="lineno">  628</span>        <span class="keywordtype">double</span> <span class="keyword">const</span> sqrt2eta = sqrt(2.0) * ewaldSetup.<a class="code hl_variable" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">params</a>.<a class="code hl_variable" href="structnnp_1_1EwaldParameters.html#a6ff2fd0c587e07eeb49972739052e1af">eta</a>;</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  631</span><span class="preprocessor">        #pragma omp for schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  632</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  634</span>        {</div>
<div class="line"><span class="lineno">  635</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span> &amp;ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  636</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            <span class="comment">// diagonal including self interaction</span></div>
<div class="line"><span class="lineno">  639</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, i) += hardness(ei)</div>
<div class="line"><span class="lineno">  640</span>                       + (1.0 / sigmaSqrtPi(ei) - 2 / (sqrt2eta * sqrt(M_PI)))</div>
<div class="line"><span class="lineno">  641</span>                         / fourPiEps;</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>            hardnessJ(i) = hardness(ei);</div>
<div class="line"><span class="lineno">  644</span>            b(i) = -ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a4febf97a3d373050fe640ee9c2ed6757">chi</a>;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>            <span class="comment">// real part</span></div>
<div class="line"><span class="lineno">  647</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> numNeighbors = ai.<a class="code hl_function" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">getStoredMinNumNeighbors</a>(rcutReal);</div>
<div class="line"><span class="lineno">  648</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; numNeighbors; ++k)</div>
<div class="line"><span class="lineno">  649</span>            {</div>
<div class="line"><span class="lineno">  650</span>                <span class="keyword">auto</span> <span class="keyword">const</span> &amp;n = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>[k];</div>
<div class="line"><span class="lineno">  651</span>                <span class="keywordtype">size_t</span> j = n.tag;</div>
<div class="line"><span class="lineno">  652</span>                <span class="keywordflow">if</span> (j &lt; i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> rij = n.d;</div>
<div class="line"><span class="lineno">  655</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = n.element;</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>                <span class="keywordtype">double</span> erfcSqrt2Eta = erfcBuf.<a class="code hl_function" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">getf</a>(i, k, 0, rij / sqrt2eta);</div>
<div class="line"><span class="lineno">  658</span>                <span class="keywordtype">double</span> erfcGammaSqrt2 =</div>
<div class="line"><span class="lineno">  659</span>                            erfcBuf.<a class="code hl_function" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">getf</a>(i, k, 1, rij / gammaSqrt2(ei, ej));</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>                <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j) += (erfcSqrt2Eta - erfcGammaSqrt2) / (rij * fourPiEps);</div>
<div class="line"><span class="lineno">  662</span>            }</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>            <span class="comment">// reciprocal part</span></div>
<div class="line"><span class="lineno">  665</span>            <span class="comment">//for (size_t j = i + 1; j &lt; numAtoms; ++j)</span></div>
<div class="line"><span class="lineno">  666</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno">  667</span>            {</div>
<div class="line"><span class="lineno">  668</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  669</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;gv: grid.<a class="code hl_variable" href="classnnp_1_1KspaceGrid.html#a1d2c12ee224ee1ad4c6e4776a947fe4c">kvectors</a>)</div>
<div class="line"><span class="lineno">  670</span>                {</div>
<div class="line"><span class="lineno">  671</span>                    <span class="comment">// Multiply by 2 because our grid is only a half-sphere</span></div>
<div class="line"><span class="lineno">  672</span>                    <span class="comment">// Vec3D const dr = applyMinimumImageConvention(ai.r - aj.r);</span></div>
<div class="line"><span class="lineno">  673</span>                    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> <span class="keyword">const</span> dr = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>;</div>
<div class="line"><span class="lineno">  674</span>                    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j) += 2 * gv.coeff * cos(gv.k * dr) / fourPiEps;</div>
<div class="line"><span class="lineno">  675</span>                    <span class="comment">//A(i, j) += 2 * gv.coeff * cos(gv.k * (ai.r - aj.r));</span></div>
<div class="line"><span class="lineno">  676</span>                }</div>
<div class="line"><span class="lineno">  677</span>                <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(j, i) = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j);</div>
<div class="line"><span class="lineno">  678</span>            }</div>
<div class="line"><span class="lineno">  679</span>        }</div>
<div class="line"><span class="lineno">  680</span>    }</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  682</span>    {</div>
<div class="line"><span class="lineno">  683</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  684</span><span class="preprocessor">#pragma omp for schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  685</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  686</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  687</span>        {</div>
<div class="line"><span class="lineno">  688</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span> &amp;ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  689</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, i) = hardness(ei)</div>
<div class="line"><span class="lineno">  692</span>                      + 1.0 / (sigmaSqrtPi(ei) * fourPiEps);</div>
<div class="line"><span class="lineno">  693</span>            hardnessJ(i) = hardness(ei);</div>
<div class="line"><span class="lineno">  694</span>            b(i) = -ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a4febf97a3d373050fe640ee9c2ed6757">chi</a>;</div>
<div class="line"><span class="lineno">  695</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno">  696</span>            {</div>
<div class="line"><span class="lineno">  697</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  698</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  699</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> rij = (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>).norm();</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>                <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j) = erf(rij / gammaSqrt2(ei, ej)) / (rij * fourPiEps);</div>
<div class="line"><span class="lineno">  702</span>                <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(j, i) = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j);</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>            }</div>
<div class="line"><span class="lineno">  705</span>        }</div>
<div class="line"><span class="lineno">  706</span>    }</div>
<div class="line"><span class="lineno">  707</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  708</span><span class="preprocessor">#pragma omp single</span></div>
<div class="line"><span class="lineno">  709</span>    {</div>
<div class="line"><span class="lineno">  710</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  711</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.col(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>).setOnes();</div>
<div class="line"><span class="lineno">  712</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.row(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>).setOnes();</div>
<div class="line"><span class="lineno">  713</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>) = 0.0;</div>
<div class="line"><span class="lineno">  714</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  715</span>    b(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>) = <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>;</div>
<div class="line"><span class="lineno">  716</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  717</span>    }</div>
<div class="line"><span class="lineno">  718</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  719</span>    <span class="comment">//TODO: sometimes only recalculation of A matrix is needed, because</span></div>
<div class="line"><span class="lineno">  720</span>    <span class="comment">//      Qs are stored.</span></div>
<div class="line"><span class="lineno">  721</span>    Q = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(b);</div>
<div class="line"><span class="lineno">  722</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  723</span><span class="preprocessor">    #pragma omp for nowait</span></div>
<div class="line"><span class="lineno">  724</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  725</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  726</span>    {</div>
<div class="line"><span class="lineno">  727</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i).charge = Q(i);</div>
<div class="line"><span class="lineno">  728</span>    }</div>
<div class="line"><span class="lineno">  729</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  730</span>    } <span class="comment">// end of parallel region</span></div>
<div class="line"><span class="lineno">  731</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a39f49b6c8dc038aab8ee34ba92b1b785">lambda</a> = Q(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno">  734</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">hasCharges</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordtype">double</span> error = (<a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a> * Q - b).norm() / b.norm();</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    <span class="comment">// We need matrix E not A, which only differ by the hardness terms along the diagonal</span></div>
<div class="line"><span class="lineno">  738</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">energyElec</a> = 0.5 * Q.head(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>).transpose()</div>
<div class="line"><span class="lineno">  739</span>               * (<a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.topLeftCorner(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>) -</div>
<div class="line"><span class="lineno">  740</span>                MatrixXd(hardnessJ.asDiagonal())) * Q.head(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno">  741</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">energyElec</a> += <a class="code hl_function" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy</a>(gammaSqrt2, sigmaSqrtPi, fs, fourPiEps);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  744</span>}</div>
<div class="ttc" id="aclassnnp_1_1KspaceGrid_html"><div class="ttname"><a href="classnnp_1_1KspaceGrid.html">nnp::KspaceGrid</a></div><div class="ttdef"><b>Definition:</b> <a href="Kspace_8h_source.html#l00043">Kspace.h:44</a></div></div>
<div class="ttc" id="aclassnnp_1_1KspaceGrid_html_a1d2c12ee224ee1ad4c6e4776a947fe4c"><div class="ttname"><a href="classnnp_1_1KspaceGrid.html#a1d2c12ee224ee1ad4c6e4776a947fe4c">nnp::KspaceGrid::kvectors</a></div><div class="ttdeci">std::vector&lt; Kvector &gt; kvectors</div><div class="ttdoc">Vector containing all k-vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Kspace_8h_source.html#l00061">Kspace.h:61</a></div></div>
<div class="ttc" id="aclassnnp_1_1KspaceGrid_html_a607f0502d0aa3006b84b3d84fe0f872f"><div class="ttname"><a href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f">nnp::KspaceGrid::setup</a></div><div class="ttdeci">void setup(Vec3D box[3], EwaldSetup &amp;ewaldSetup)</div><div class="ttdoc">Set up reciprocal box vectors and eta.</div><div class="ttdef"><b>Definition:</b> <a href="Kspace_8cpp_source.html#l00045">Kspace.cpp:45</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a0361a8e48f3b762f76db75abcf6fc305"><div class="ttname"><a href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a></div><div class="ttdeci">std::vector&lt; Neighbor &gt; neighbors</div><div class="ttdoc">Neighbor array (maximum number defined in macros.h.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00170">Atom.h:170</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a0e8397ecd8e60cf9db1f4dfe7378d447"><div class="ttname"><a href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a></div><div class="ttdeci">Vec3D r</div><div class="ttdoc">Cartesian coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00125">Atom.h:125</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a31682875ca984579393d331e5354fd19"><div class="ttname"><a href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">nnp::Atom::getStoredMinNumNeighbors</a></div><div class="ttdeci">std::size_t getStoredMinNumNeighbors(double const cutoffRadius) const</div><div class="ttdoc">Return needed number of neighbors for a given cutoff radius from neighborCutoffs map.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8cpp_source.html#l00329">Atom.cpp:329</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a4febf97a3d373050fe640ee9c2ed6757"><div class="ttname"><a href="structnnp_1_1Atom.html#a4febf97a3d373050fe640ee9c2ed6757">nnp::Atom::chi</a></div><div class="ttdeci">double chi</div><div class="ttdoc">Atomic electronegativity determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00119">Atom.h:119</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_a807a4cf41842f8225d88f1848f1ef6ee"><div class="ttname"><a href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00107">Atom.h:107</a></div></div>
<div class="ttc" id="astructnnp_1_1ErfcBuf_html_a6b7e36dd4d912a38ed561be3c2c8cfb7"><div class="ttname"><a href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">nnp::ErfcBuf::getf</a></div><div class="ttdeci">double getf(size_t const atomIndex, size_t const neighIndex, size_t const valIndex, double const x)</div><div class="ttdoc">Either returns already stored value erfc(x) or calculates it if not yet stored.</div><div class="ttdef"><b>Definition:</b> <a href="ErfcBuf_8cpp_source.html#l00021">ErfcBuf.cpp:21</a></div></div>
<div class="ttc" id="astructnnp_1_1ErfcBuf_html_a90f60368ebcda5bdfbb17ff6b92b7717"><div class="ttname"><a href="structnnp_1_1ErfcBuf.html#a90f60368ebcda5bdfbb17ff6b92b7717">nnp::ErfcBuf::reset</a></div><div class="ttdeci">void reset(std::vector&lt; Atom &gt; const &amp;atoms, size_t const valuesPerPair)</div><div class="ttdoc">Resizes and resets the storage array to fit the current structure.</div><div class="ttdef"><b>Definition:</b> <a href="ErfcBuf_8cpp_source.html#l00010">ErfcBuf.cpp:10</a></div></div>
<div class="ttc" id="astructnnp_1_1EwaldParameters_html_a6ff2fd0c587e07eeb49972739052e1af"><div class="ttname"><a href="structnnp_1_1EwaldParameters.html#a6ff2fd0c587e07eeb49972739052e1af">nnp::EwaldParameters::eta</a></div><div class="ttdeci">double eta</div><div class="ttdoc">Width of the gaussian screening charges.</div><div class="ttdef"><b>Definition:</b> <a href="IEwaldTrunc_8h_source.html#l00040">IEwaldTrunc.h:40</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a39f49b6c8dc038aab8ee34ba92b1b785"><div class="ttname"><a href="structnnp_1_1Structure.html#a39f49b6c8dc038aab8ee34ba92b1b785">nnp::Structure::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">Lagrange multiplier used for charge equilibration.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00106">Structure.h:106</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a90bd1326da5bb05f04689a06660a2c9c"><div class="ttname"><a href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">nnp::Structure::A</a></div><div class="ttdeci">Eigen::MatrixXd A</div><div class="ttdoc">Global charge equilibration matrix A'.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8h_source.html#l00116">Structure.h:116</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_ae462f93091a1ab2767a5ca395ab0a6e2"><div class="ttname"><a href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">nnp::Structure::calculateScreeningEnergy</a></div><div class="ttdeci">double calculateScreeningEnergy(Eigen::MatrixXd gammaSqrt2, Eigen::VectorXd sigmaSqrtPi, ScreeningFunction const &amp;fs, double const fourPiEps)</div><div class="ttdoc">Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove...</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l00746">Structure.cpp:746</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Atom.html#a4febf97a3d373050fe640ee9c2ed6757">nnp::Atom::chi</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="structnnp_1_1Structure.html#aa8d5c1fa9994b603c38e25250da743df">energyElec</a>, <a class="el" href="structnnp_1_1EwaldParameters.html#a6ff2fd0c587e07eeb49972739052e1af">nnp::EwaldParameters::eta</a>, <a class="el" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">nnp::ErfcBuf::getf()</a>, <a class="el" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">nnp::Atom::getStoredMinNumNeighbors()</a>, <a class="el" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a>, <a class="el" href="structnnp_1_1Structure.html#af9eaacc767607b846ddf9b30109c570e">hasCharges</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="classnnp_1_1KspaceGrid.html#a1d2c12ee224ee1ad4c6e4776a947fe4c">nnp::KspaceGrid::kvectors</a>, <a class="el" href="structnnp_1_1Structure.html#a39f49b6c8dc038aab8ee34ba92b1b785">lambda</a>, <a class="el" href="structnnp_1_1Structure.html#a5142f63d6a9301709e67197438ef77d1">NeighborListIsSorted</a>, <a class="el" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">nnp::EwaldSetup::params</a>, <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>, <a class="el" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">nnp::EwaldParameters::rCut</a>, <a class="el" href="structnnp_1_1ErfcBuf.html#a90f60368ebcda5bdfbb17ff6b92b7717">nnp::ErfcBuf::reset()</a>, and <a class="el" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f">nnp::KspaceGrid::setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03">nnp::Mode::chargeEquilibration()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_cgraph" id="astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_cgraph">
<area shape="rect" title="Compute electrostatic energy with global charge equilibration." alt="" coords="5,115,185,156"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2" title="Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove..." alt="" coords="233,5,413,47"/>
<area shape="rect" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19" title="Return needed number of neighbors for a given cutoff radius from neighborCutoffs map." alt="" coords="461,35,676,76"/>
<area shape="rect" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7" title="Either returns already stored value erfc(x) or calculates it if not yet stored." alt="" coords="256,122,391,149"/>
<area shape="rect" href="structnnp_1_1ErfcBuf.html#a90f60368ebcda5bdfbb17ff6b92b7717" title="Resizes and resets the storage array to fit the current structure." alt="" coords="253,173,394,199"/>
<area shape="rect" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f" title="Set up reciprocal box vectors and eta." alt="" coords="237,223,409,250"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_icgraph" id="astructnnp_1_1Structure_a50ffe252cff725aa5bb952bb1d8cbf5a_icgraph">
<area shape="rect" title="Compute electrostatic energy with global charge equilibration." alt="" coords="277,5,457,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03" title="Perform global charge equilibration method." alt="" coords="5,13,229,39"/>
</map>
</div>

</div>
</div>
<a id="ae462f93091a1ab2767a5ca395ab0a6e2" name="ae462f93091a1ab2767a5ca395ab0a6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae462f93091a1ab2767a5ca395ab0a6e2">&#9670;&nbsp;</a></span>calculateScreeningEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Structure::calculateScreeningEnergy </td>
          <td>(</td>
          <td class="paramtype">Eigen::MatrixXd&#160;</td>
          <td class="paramname"><em>gammaSqrt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd&#160;</td>
          <td class="paramname"><em>sigmaSqrtPi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>fourPiEps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove contributions in the short range domain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gammaSqrt2</td><td>Matrix combining gamma with prefactor. \( \text{gammaSqrt2}_{ij} = \sqrt{2} \gamma_{ij}
                         = \sqrt{2} \sqrt{(\sigma_i^2 + \sigma_j^2)} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigmaSqrtPi</td><td>Vector combining sigma with prefactor, \( \text{sigmaSqrtPi}_i = \sqrt{\pi} \sigma_i \)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>Screening function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fourPiEps</td><td>\( \text{fourPiEps} = 4 \pi \varepsilon_0 \). Value depends on unit system (e.g. normalization). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00746">746</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  752</span>{</div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordtype">double</span> energyScreen = 0;</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordtype">double</span> <span class="keyword">const</span> rcutScreen = fs.getOuter();</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  757</span><span class="preprocessor">    #pragma omp parallel</span></div>
<div class="line"><span class="lineno">  758</span>    {</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordtype">double</span> localEnergyScreen = 0;</div>
<div class="line"><span class="lineno">  760</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  761</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno">  762</span>        {</div>
<div class="line"><span class="lineno">  763</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  764</span><span class="preprocessor">            #pragma omp for schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  765</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  766</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  767</span>            {</div>
<div class="line"><span class="lineno">  768</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  769</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  770</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qi = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  771</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  772</span>                localEnergyScreen +=  -Qi * Qi</div>
<div class="line"><span class="lineno">  773</span>                                   / (2 * sigmaSqrtPi(ei) * fourPiEps);</div>
<div class="line"><span class="lineno">  774</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  775</span>                energyScreen +=  -Qi * Qi</div>
<div class="line"><span class="lineno">  776</span>                              / (2 * sigmaSqrtPi(ei) * fourPiEps);</div>
<div class="line"><span class="lineno">  777</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> numNeighbors = ai.<a class="code hl_function" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">getStoredMinNumNeighbors</a>(rcutScreen);</div>
<div class="line"><span class="lineno">  780</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; numNeighbors; ++k)</div>
<div class="line"><span class="lineno">  781</span>                {</div>
<div class="line"><span class="lineno">  782</span>                    <span class="keyword">auto</span> <span class="keyword">const</span>&amp; n = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>[k];</div>
<div class="line"><span class="lineno">  783</span>                    <span class="keywordtype">size_t</span> <span class="keyword">const</span> j = n.tag;</div>
<div class="line"><span class="lineno">  784</span>                    <span class="keywordflow">if</span> (j &lt; i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  785</span>                    <span class="keywordtype">double</span> <span class="keyword">const</span> rij = n.d;</div>
<div class="line"><span class="lineno">  786</span>                    <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = n.element;</div>
<div class="line"><span class="lineno">  787</span>                    <span class="comment">//TODO: Maybe add charge to neighbor class?</span></div>
<div class="line"><span class="lineno">  788</span>                    <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j).charge;</div>
<div class="line"><span class="lineno">  789</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  790</span>                    localEnergyScreen += Qi * Qj * erf(rij / gammaSqrt2(ei, ej))</div>
<div class="line"><span class="lineno">  791</span>                                    * (fs.f(rij) - 1) / (rij * fourPiEps);</div>
<div class="line"><span class="lineno">  792</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  793</span>                    energyScreen += Qi * Qj * erf(rij / gammaSqrt2(ei, ej))</div>
<div class="line"><span class="lineno">  794</span>                                    * (fs.f(rij) - 1) / (rij * fourPiEps);</div>
<div class="line"><span class="lineno">  795</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>               }</div>
<div class="line"><span class="lineno">  798</span>            }</div>
<div class="line"><span class="lineno">  799</span>        }</div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  801</span>        {</div>
<div class="line"><span class="lineno">  802</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  803</span><span class="preprocessor">            #pragma omp for schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  804</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  805</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  806</span>            {</div>
<div class="line"><span class="lineno">  807</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  808</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  809</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qi = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  810</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  811</span>                localEnergyScreen +=  -Qi * Qi</div>
<div class="line"><span class="lineno">  812</span>                                   / (2 * sigmaSqrtPi(ei) * fourPiEps);</div>
<div class="line"><span class="lineno">  813</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  814</span>                energyScreen +=  -Qi * Qi</div>
<div class="line"><span class="lineno">  815</span>                              / (2 * sigmaSqrtPi(ei) * fourPiEps);</div>
<div class="line"><span class="lineno">  816</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno">  819</span>                {</div>
<div class="line"><span class="lineno">  820</span>                    <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  821</span>                    <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  822</span>                    <span class="keywordtype">double</span> <span class="keyword">const</span> rij = (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>).norm();</div>
<div class="line"><span class="lineno">  823</span>                    <span class="keywordflow">if</span> ( rij &lt; rcutScreen )</div>
<div class="line"><span class="lineno">  824</span>                    {</div>
<div class="line"><span class="lineno">  825</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  826</span>                        localEnergyScreen += Qi * Qj * <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j) * (fs.f(rij) - 1);</div>
<div class="line"><span class="lineno">  827</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  828</span>                        energyScreen += Qi * Qj * <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i, j) * (fs.f(rij) - 1);</div>
<div class="line"><span class="lineno">  829</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  830</span>                    }</div>
<div class="line"><span class="lineno">  831</span>                }</div>
<div class="line"><span class="lineno">  832</span>            }</div>
<div class="line"><span class="lineno">  833</span>        }</div>
<div class="line"><span class="lineno">  834</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  835</span><span class="preprocessor">        #pragma omp atomic</span></div>
<div class="line"><span class="lineno">  836</span>        energyScreen += localEnergyScreen;</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  839</span>    <span class="comment">//cout &lt;&lt; &quot;energyScreen = &quot; &lt;&lt; energyScreen &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">return</span> energyScreen;</div>
<div class="line"><span class="lineno">  841</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a2352aabf707595bd9893ed59a9c4977e"><div class="ttname"><a href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a></div><div class="ttdeci">double charge</div><div class="ttdoc">Atomic charge determined by neural network.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00121">Atom.h:121</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="classnnp_1_1ScreeningFunction.html#aa48557f8e5995c10026f714d490e2bf0">nnp::ScreeningFunction::f()</a>, <a class="el" href="classnnp_1_1ScreeningFunction.html#a39a14618e686220bf57a679b68e1739a">nnp::ScreeningFunction::getOuter()</a>, <a class="el" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">nnp::Atom::getStoredMinNumNeighbors()</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_cgraph" id="astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_cgraph">
<area shape="rect" title="Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove..." alt="" coords="5,57,185,98"/>
<area shape="rect" href="classnnp_1_1ScreeningFunction.html#aa48557f8e5995c10026f714d490e2bf0" title="Screening function ." alt="" coords="247,5,434,32"/>
<area shape="rect" href="classnnp_1_1ScreeningFunction.html#a39a14618e686220bf57a679b68e1739a" title="Getter for outer." alt="" coords="254,57,427,98"/>
<area shape="rect" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19" title="Return needed number of neighbors for a given cutoff radius from neighborCutoffs map." alt="" coords="233,122,448,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_icgraph" id="astructnnp_1_1Structure_ae462f93091a1ab2767a5ca395ab0a6e2_icgraph">
<area shape="rect" title="Calculate screening energy which needs to be added (!) to the electrostatic energy in order to remove..." alt="" coords="233,5,413,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a" title="Compute electrostatic energy with global charge equilibration." alt="" coords="5,5,185,47"/>
</map>
</div>

</div>
</div>
<a id="addf3a61f5cb0fa8daeb5737d28758740" name="addf3a61f5cb0fa8daeb5737d28758740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf3a61f5cb0fa8daeb5737d28758740">&#9670;&nbsp;</a></span>calculateDAdrQ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateDAdrQ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnnp_1_1EwaldSetup.html">EwaldSetup</a> &amp;&#160;</td>
          <td class="paramname"><em>ewaldSetup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd&#160;</td>
          <td class="paramname"><em>gammaSqrt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>fourPiEps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnnp_1_1ErfcBuf.html">ErfcBuf</a> &amp;&#160;</td>
          <td class="paramname"><em>erfcBuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates derivative of A-matrix with respect to the atoms positions and contract it with Q. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ewaldSetup</td><td>Settings of Ewald summation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gammaSqrt2</td><td>Matrix combining gamma with prefactor. \( \text{gammaSqrt2}_{ij} = \sqrt{2} \gamma_{ij} 
                         = \sqrt{2} \sqrt{(\sigma_i^2 + \sigma_j^2)} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fourPiEps</td><td>\( \text{fourPiEps} = 4 \pi \varepsilon_0 \). Value depends on unit system (e.g. normalization). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">erfcBuf</td><td>helper object to avoid repeated calculation of erfc(). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00844">844</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  849</span>{</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  852</span>    vector&lt;Vec3D&gt; dAdrQDiag(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno">  853</span><span class="preprocessor">    #pragma omp parallel</span></div>
<div class="line"><span class="lineno">  854</span>    {</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span><span class="preprocessor">    #pragma omp declare reduction(vec_Vec3D_plus : std::vector&lt;Vec3D&gt; : \</span></div>
<div class="line"><span class="lineno">  857</span><span class="preprocessor">                  std::transform(omp_out.begin(), omp_out.end(), omp_in.begin(), omp_out.begin(), std::plus&lt;Vec3D&gt;())) \</span></div>
<div class="line"><span class="lineno">  858</span><span class="preprocessor">                  initializer(omp_priv = decltype(omp_orig)(omp_orig.size()))</span></div>
<div class="line"><span class="lineno">  859</span><span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><span class="lineno">  860</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  861</span>    <span class="comment">// TODO: This initialization loop could probably be avoid, maybe use</span></div>
<div class="line"><span class="lineno">  862</span>    <span class="comment">// default constructor?</span></div>
<div class="line"><span class="lineno">  863</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  864</span>    {</div>
<div class="line"><span class="lineno">  865</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  866</span>        <span class="comment">// dAdrQ(numAtoms+1,:) entries are zero</span></div>
<div class="line"><span class="lineno">  867</span>        ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> + 1);</div>
<div class="line"><span class="lineno">  868</span>    }</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno">  871</span>    {</div>
<div class="line"><span class="lineno">  872</span>        <span class="comment">// TODO: We need same Kspace grid as in calculateScreeningEnergy, should</span></div>
<div class="line"><span class="lineno">  873</span>        <span class="comment">// we cache it for reuse? Note that we can&#39;t calculate dAdrQ already in</span></div>
<div class="line"><span class="lineno">  874</span>        <span class="comment">// the loops of calculateElectrostaticEnergy because at this point we don&#39;t</span></div>
<div class="line"><span class="lineno">  875</span>        <span class="comment">// have the charges.</span></div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>        <a class="code hl_class" href="classnnp_1_1KspaceGrid.html">KspaceGrid</a> grid;</div>
<div class="line"><span class="lineno">  878</span>        grid.<a class="code hl_function" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f">setup</a>(<a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, ewaldSetup);</div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordtype">double</span> rcutReal = ewaldSetup.<a class="code hl_variable" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">params</a>.<a class="code hl_variable" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">rCut</a>;</div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordtype">double</span> <span class="keyword">const</span> sqrt2eta = sqrt(2.0) * ewaldSetup.<a class="code hl_variable" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">params</a>.<a class="code hl_variable" href="structnnp_1_1EwaldParameters.html#a6ff2fd0c587e07eeb49972739052e1af">eta</a>;</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  883</span>        <span class="comment">// This way of parallelization slightly changes the result because of</span></div>
<div class="line"><span class="lineno">  884</span>        <span class="comment">// numerical errors.</span></div>
<div class="line"><span class="lineno">  885</span><span class="preprocessor">        #pragma omp for reduction(vec_Vec3D_plus : dAdrQDiag) schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  886</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  887</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  888</span>        {</div>
<div class="line"><span class="lineno">  889</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  890</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  891</span>            <span class="keywordtype">double</span> <span class="keyword">const</span> Qi = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>            <span class="comment">// real part</span></div>
<div class="line"><span class="lineno">  894</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> numNeighbors = ai.<a class="code hl_function" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">getStoredMinNumNeighbors</a>(rcutReal);</div>
<div class="line"><span class="lineno">  895</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; numNeighbors; ++k)</div>
<div class="line"><span class="lineno">  896</span>            {</div>
<div class="line"><span class="lineno">  897</span>                <span class="keyword">auto</span> <span class="keyword">const</span> &amp;n = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>[k];</div>
<div class="line"><span class="lineno">  898</span>                <span class="keywordtype">size_t</span> j = n.tag;</div>
<div class="line"><span class="lineno">  899</span>                <span class="comment">//if (j &lt; i) continue;</span></div>
<div class="line"><span class="lineno">  900</span>                <span class="keywordflow">if</span> (j &lt;= i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> rij = n.d;</div>
<div class="line"><span class="lineno">  903</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  904</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  905</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>                <span class="keywordtype">double</span> erfcSqrt2Eta = erfcBuf.<a class="code hl_function" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">getf</a>(i, k, 0, rij / sqrt2eta);</div>
<div class="line"><span class="lineno">  908</span>                <span class="keywordtype">double</span> erfcGammaSqrt2 =</div>
<div class="line"><span class="lineno">  909</span>                        erfcBuf.<a class="code hl_function" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">getf</a>(i, k, 1, rij / gammaSqrt2(ei, ej));</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dAijdri;</div>
<div class="line"><span class="lineno">  912</span>                dAijdri = n.dr / pow(rij, 2)</div>
<div class="line"><span class="lineno">  913</span>                          * (2 / sqrt(M_PI) * (-exp(-pow(rij / sqrt2eta, 2))</div>
<div class="line"><span class="lineno">  914</span>                          / sqrt2eta + exp(-pow(rij / gammaSqrt2(ei, ej), 2))</div>
<div class="line"><span class="lineno">  915</span>                          / gammaSqrt2(ei, ej)) - 1 / rij</div>
<div class="line"><span class="lineno">  916</span>                          * (erfcSqrt2Eta - erfcGammaSqrt2));</div>
<div class="line"><span class="lineno">  917</span>                dAijdri /= fourPiEps;</div>
<div class="line"><span class="lineno">  918</span>                <span class="comment">// Make use of symmetry: dA_{ij}/dr_i = dA_{ji}/dr_i</span></div>
<div class="line"><span class="lineno">  919</span>                <span class="comment">// = -dA_{ji}/dr_j = -dA_{ij}/dr_j</span></div>
<div class="line"><span class="lineno">  920</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] += dAijdri * Qj;</div>
<div class="line"><span class="lineno">  921</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] += dAijdri * Qi;</div>
<div class="line"><span class="lineno">  922</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] -= dAijdri * Qj;</div>
<div class="line"><span class="lineno">  923</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  924</span>                dAdrQDiag[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  925</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  926</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  927</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  928</span>            }</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>            <span class="comment">// reciprocal part</span></div>
<div class="line"><span class="lineno">  931</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno">  932</span>            {</div>
<div class="line"><span class="lineno">  933</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  934</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  935</span>                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dAijdri;</div>
<div class="line"><span class="lineno">  936</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;gv: grid.<a class="code hl_variable" href="classnnp_1_1KspaceGrid.html#a1d2c12ee224ee1ad4c6e4776a947fe4c">kvectors</a>)</div>
<div class="line"><span class="lineno">  937</span>                {</div>
<div class="line"><span class="lineno">  938</span>                    <span class="comment">// Multiply by 2 because our grid is only a half-sphere</span></div>
<div class="line"><span class="lineno">  939</span>                    <span class="comment">//Vec3D const dr = applyMinimumImageConvention(ai.r - aj.r);</span></div>
<div class="line"><span class="lineno">  940</span>                    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> <span class="keyword">const</span> dr = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>;</div>
<div class="line"><span class="lineno">  941</span>                    dAijdri -= 2 * gv.coeff * sin(gv.k * dr) * gv.k;</div>
<div class="line"><span class="lineno">  942</span>                }</div>
<div class="line"><span class="lineno">  943</span>                dAijdri /= fourPiEps;</div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] += dAijdri * Qj;</div>
<div class="line"><span class="lineno">  946</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] += dAijdri * Qi;</div>
<div class="line"><span class="lineno">  947</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] -= dAijdri * Qj;</div>
<div class="line"><span class="lineno">  948</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  949</span>                dAdrQDiag[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  950</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  951</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  952</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  953</span>            }</div>
<div class="line"><span class="lineno">  954</span>        }</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  957</span>    {</div>
<div class="line"><span class="lineno">  958</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  959</span><span class="preprocessor">        #pragma omp for reduction(vec_Vec3D_plus : dAdrQDiag) schedule(dynamic)</span></div>
<div class="line"><span class="lineno">  960</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  961</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  962</span>        {</div>
<div class="line"><span class="lineno">  963</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno">  964</span>            <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  965</span>            <span class="keywordtype">double</span> <span class="keyword">const</span> Qi = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno">  968</span>            {</div>
<div class="line"><span class="lineno">  969</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno">  970</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno">  971</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>                <span class="keywordtype">double</span> rij = (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>).norm();</div>
<div class="line"><span class="lineno">  974</span>                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> dAijdri;</div>
<div class="line"><span class="lineno">  975</span>                dAijdri = (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>) / pow(rij, 2)</div>
<div class="line"><span class="lineno">  976</span>                          * (2 / (sqrt(M_PI) * gammaSqrt2(ei, ej))</div>
<div class="line"><span class="lineno">  977</span>                             * exp(-pow(rij / gammaSqrt2(ei, ej), 2))</div>
<div class="line"><span class="lineno">  978</span>                             - erf(rij / gammaSqrt2(ei, ej)) / rij);</div>
<div class="line"><span class="lineno">  979</span>                dAijdri /= fourPiEps;</div>
<div class="line"><span class="lineno">  980</span>                <span class="comment">// Make use of symmetry: dA_{ij}/dr_i = dA_{ji}/dr_i</span></div>
<div class="line"><span class="lineno">  981</span>                <span class="comment">// = -dA_{ji}/dr_j = -dA_{ij}/dr_j</span></div>
<div class="line"><span class="lineno">  982</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] += dAijdri * Qj;</div>
<div class="line"><span class="lineno">  983</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] = dAijdri * Qi;</div>
<div class="line"><span class="lineno">  984</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] = -dAijdri * Qj;</div>
<div class="line"><span class="lineno">  985</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  986</span>                dAdrQDiag[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  987</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  988</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j] -= dAijdri * Qi;</div>
<div class="line"><span class="lineno">  989</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  990</span>            }</div>
<div class="line"><span class="lineno">  991</span>        }</div>
<div class="line"><span class="lineno">  992</span>    }</div>
<div class="line"><span class="lineno">  993</span><span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  994</span><span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><span class="lineno">  995</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno">  996</span>    {</div>
<div class="line"><span class="lineno">  997</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i];</div>
<div class="line"><span class="lineno">  998</span>        ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[i] += dAdrQDiag[i];</div>
<div class="line"><span class="lineno">  999</span>    }</div>
<div class="line"><span class="lineno"> 1000</span>    }</div>
<div class="line"><span class="lineno"> 1001</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1003</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a717a08ac6098e2e89d1ccaf22cc11a17"><div class="ttname"><a href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">nnp::Atom::dAdrQ</a></div><div class="ttdeci">std::vector&lt; Vec3D &gt; dAdrQ</div><div class="ttdoc">If dQdr has been calculated for respective components.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00168">Atom.h:168</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">nnp::Atom::dAdrQ</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="structnnp_1_1EwaldParameters.html#a6ff2fd0c587e07eeb49972739052e1af">nnp::EwaldParameters::eta</a>, <a class="el" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7">nnp::ErfcBuf::getf()</a>, <a class="el" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19">nnp::Atom::getStoredMinNumNeighbors()</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="classnnp_1_1KspaceGrid.html#a1d2c12ee224ee1ad4c6e4776a947fe4c">nnp::KspaceGrid::kvectors</a>, <a class="el" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="classnnp_1_1EwaldSetup.html#a137aa52c200ce7a4e4e0308526c19713">nnp::EwaldSetup::params</a>, <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>, <a class="el" href="structnnp_1_1EwaldParameters.html#a4268c84c7743d37564cc5f7bdfff3848">nnp::EwaldParameters::rCut</a>, and <a class="el" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f">nnp::KspaceGrid::setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03">nnp::Mode::chargeEquilibration()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_cgraph" id="astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_cgraph">
<area shape="rect" title="Calculates derivative of A&#45;matrix with respect to the atoms positions and contract it with Q." alt="" coords="5,57,185,98"/>
<area shape="rect" href="structnnp_1_1ErfcBuf.html#a6b7e36dd4d912a38ed561be3c2c8cfb7" title="Either returns already stored value erfc(x) or calculates it if not yet stored." alt="" coords="273,5,408,32"/>
<area shape="rect" href="structnnp_1_1Atom.html#a31682875ca984579393d331e5354fd19" title="Return needed number of neighbors for a given cutoff radius from neighborCutoffs map." alt="" coords="233,57,448,98"/>
<area shape="rect" href="classnnp_1_1KspaceGrid.html#a607f0502d0aa3006b84b3d84fe0f872f" title="Set up reciprocal box vectors and eta." alt="" coords="255,123,427,149"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_icgraph" id="astructnnp_1_1Structure_addf3a61f5cb0fa8daeb5737d28758740_icgraph">
<area shape="rect" title="Calculates derivative of A&#45;matrix with respect to the atoms positions and contract it with Q." alt="" coords="277,5,457,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03" title="Perform global charge equilibration method." alt="" coords="5,13,229,39"/>
</map>
</div>

</div>
</div>
<a id="a4cd07a8b746a55aea0f0b6181a9f645f" name="a4cd07a8b746a55aea0f0b6181a9f645f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cd07a8b746a55aea0f0b6181a9f645f">&#9670;&nbsp;</a></span>calculateDQdChi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateDQdChi </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Eigen::VectorXd &gt; &amp;&#160;</td>
          <td class="paramname"><em>dQdChi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates derivative of the charges with respect to electronegativities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dQdChi</td><td>vector to store the result. dQdChi[i](j) represents the derivative for the i-th electronegativity and the j-th charge. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01005">1005</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1006</span>{</div>
<div class="line"><span class="lineno"> 1007</span>    dQdChi.clear();</div>
<div class="line"><span class="lineno"> 1008</span>    dQdChi.reserve(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1009</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno"> 1010</span>    {</div>
<div class="line"><span class="lineno"> 1011</span>        <span class="comment">// Including Lagrange multiplier equation.</span></div>
<div class="line"><span class="lineno"> 1012</span>        VectorXd b(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>+1);</div>
<div class="line"><span class="lineno"> 1013</span>        b.setZero();</div>
<div class="line"><span class="lineno"> 1014</span>        b(i) = -1.;</div>
<div class="line"><span class="lineno"> 1015</span>        dQdChi.push_back(<a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(b).head(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>));</div>
<div class="line"><span class="lineno"> 1016</span>    }</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1018</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a4cd07a8b746a55aea0f0b6181a9f645f_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a4cd07a8b746a55aea0f0b6181a9f645f_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a4cd07a8b746a55aea0f0b6181a9f645f_icgraph" id="astructnnp_1_1Structure_a4cd07a8b746a55aea0f0b6181a9f645f_icgraph">
<area shape="rect" title="Calculates derivative of the charges with respect to electronegativities." alt="" coords="212,5,392,47"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,13,164,39"/>
</map>
</div>

</div>
</div>
<a id="a7204a6979274b69a358f73af50187d85" name="a7204a6979274b69a358f73af50187d85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7204a6979274b69a358f73af50187d85">&#9670;&nbsp;</a></span>calculateDQdJ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateDQdJ </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Eigen::VectorXd &gt; &amp;&#160;</td>
          <td class="paramname"><em>dQdJ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates derivative of the charges with respect to atomic hardness. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dQdJ</td><td>vector to store the result. dQdJ[i](j) represents the derivative for the i-th hardness and the j-th charge. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01020">1020</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1021</span>{</div>
<div class="line"><span class="lineno"> 1022</span>    dQdJ.clear();</div>
<div class="line"><span class="lineno"> 1023</span>    dQdJ.reserve(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>);</div>
<div class="line"><span class="lineno"> 1024</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>; ++i)</div>
<div class="line"><span class="lineno"> 1025</span>    {</div>
<div class="line"><span class="lineno"> 1026</span>        <span class="comment">// Including Lagrange multiplier equation.</span></div>
<div class="line"><span class="lineno"> 1027</span>        VectorXd b(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>+1);</div>
<div class="line"><span class="lineno"> 1028</span>        b.setZero();</div>
<div class="line"><span class="lineno"> 1029</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno"> 1030</span>        {</div>
<div class="line"><span class="lineno"> 1031</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span> &amp;aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno"> 1032</span>            <span class="keywordflow">if</span> (i == aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>) b(j) = -aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno"> 1033</span>        }</div>
<div class="line"><span class="lineno"> 1034</span>        dQdJ.push_back(<a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(b).head(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>));</div>
<div class="line"><span class="lineno"> 1035</span>    }</div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1037</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7204a6979274b69a358f73af50187d85_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a7204a6979274b69a358f73af50187d85_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a7204a6979274b69a358f73af50187d85_icgraph" id="astructnnp_1_1Structure_a7204a6979274b69a358f73af50187d85_icgraph">
<area shape="rect" title="Calculates derivative of the charges with respect to atomic hardness." alt="" coords="212,5,424,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,5,164,32"/>
</map>
</div>

</div>
</div>
<a id="a8f0706e5971387076a3257b149534679" name="a8f0706e5971387076a3257b149534679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f0706e5971387076a3257b149534679">&#9670;&nbsp;</a></span>calculateDQdr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateDQdr </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>atomsIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>compIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>maxCutoffRadius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classnnp_1_1Element.html">Element</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates derivative of the charges with respect to the atom's position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">atomIndices</td><td>Vector containing indices of atoms for which the derivative should be calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">compIndices</td><td>Vector containing indices of vector components for which the derivative should be calculated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxCutoffRadius</td><td>Max. cutoff radius of symmetry functions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">elements</td><td>Vector containing all elements (needed for symmetry function table). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01039">1039</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1043</span>{</div>
<div class="line"><span class="lineno"> 1044</span>    <span class="keywordflow">if</span> (atomIndices.size() != compIndices.size())</div>
<div class="line"><span class="lineno"> 1045</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: In calculation of dQ/dr both atom index and&quot;</span></div>
<div class="line"><span class="lineno"> 1046</span>                            <span class="stringliteral">&quot; component index must be specified.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1047</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; atomIndices.size(); ++i)</div>
<div class="line"><span class="lineno"> 1048</span>    {</div>
<div class="line"><span class="lineno"> 1049</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; a = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(atomIndices[i]);</div>
<div class="line"><span class="lineno"> 1050</span>        <span class="keywordflow">if</span> ( a.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>.size() == 0 )</div>
<div class="line"><span class="lineno"> 1051</span>            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: dAdrQ needs to be calculated before &quot;</span></div>
<div class="line"><span class="lineno"> 1052</span>                                <span class="stringliteral">&quot;calculating dQdr&quot;</span>);</div>
<div class="line"><span class="lineno"> 1053</span>        a.<a class="code hl_variable" href="structnnp_1_1Atom.html#aa52adde815139e1f002428613534baed">dQdr</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>        <span class="comment">// b stores (-dChidr - dAdrQ), last element for charge conservation.</span></div>
<div class="line"><span class="lineno"> 1056</span>        VectorXd b(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> + 1);</div>
<div class="line"><span class="lineno"> 1057</span>        b.setZero();</div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno"> 1059</span>        {</div>
<div class="line"><span class="lineno"> 1060</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span><span class="preprocessor">#ifndef N2P2_FULL_SFD_MEMORY</span></div>
<div class="line"><span class="lineno"> 1063</span>            vector&lt;vector&lt;size_t&gt; &gt; <span class="keyword">const</span> *<span class="keyword">const</span> tableFull</div>
<div class="line"><span class="lineno"> 1064</span>                    = &amp;(elements.at(aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>).getSymmetryFunctionTable());</div>
<div class="line"><span class="lineno"> 1065</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1066</span>            vector&lt;vector&lt;size_t&gt; &gt; <span class="keyword">const</span> *<span class="keyword">const</span> tableFull = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1067</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1068</span>            b(j) -= aj.<a class="code hl_function" href="structnnp_1_1Atom.html#a13d0265e748da4aa1a7050ac5cc14ebd">calculateDChidr</a>(atomIndices[i],</div>
<div class="line"><span class="lineno"> 1069</span>                                       maxCutoffRadius,</div>
<div class="line"><span class="lineno"> 1070</span>                                       tableFull)[compIndices[i]];</div>
<div class="line"><span class="lineno"> 1071</span>            b(j) -= a.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>.at(j)[compIndices[i]];</div>
<div class="line"><span class="lineno"> 1072</span>        }</div>
<div class="line"><span class="lineno"> 1073</span>        VectorXd dQdr = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(b).head(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno"> 1075</span>        {</div>
<div class="line"><span class="lineno"> 1076</span>            a.<a class="code hl_variable" href="structnnp_1_1Atom.html#aa52adde815139e1f002428613534baed">dQdr</a>.at(j)[compIndices[i]] = dQdr(j);</div>
<div class="line"><span class="lineno"> 1077</span>        }</div>
<div class="line"><span class="lineno"> 1078</span>    }</div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1080</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a13d0265e748da4aa1a7050ac5cc14ebd"><div class="ttname"><a href="structnnp_1_1Atom.html#a13d0265e748da4aa1a7050ac5cc14ebd">nnp::Atom::calculateDChidr</a></div><div class="ttdeci">Vec3D calculateDChidr(size_t const atomIndexOfR, double const maxCutoffRadius, std::vector&lt; std::vector&lt; size_t &gt; &gt; const *const tableFull=nullptr) const</div><div class="ttdoc">Calculate dChi/dr of this atom's Chi with respect to the coordinates of the given atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8cpp_source.html#l00403">Atom.cpp:403</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_aa52adde815139e1f002428613534baed"><div class="ttname"><a href="structnnp_1_1Atom.html#aa52adde815139e1f002428613534baed">nnp::Atom::dQdr</a></div><div class="ttdeci">std::vector&lt; Vec3D &gt; dQdr</div><div class="ttdoc">Derivative of charges with respect to this atom's coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00163">Atom.h:163</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a13d0265e748da4aa1a7050ac5cc14ebd">nnp::Atom::calculateDChidr()</a>, <a class="el" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">nnp::Atom::dAdrQ</a>, <a class="el" href="structnnp_1_1Atom.html#aa52adde815139e1f002428613534baed">nnp::Atom::dQdr</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8f0706e5971387076a3257b149534679_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_cgraph" id="astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_cgraph">
<area shape="rect" title="Calculates derivative of the charges with respect to the atom&#39;s position." alt="" coords="5,5,219,32"/>
<area shape="rect" href="structnnp_1_1Atom.html#a13d0265e748da4aa1a7050ac5cc14ebd" title="Calculate dChi/dr of this atom&#39;s Chi with respect to the coordinates of the given atom." alt="" coords="267,5,467,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8f0706e5971387076a3257b149534679_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_icgraph" id="astructnnp_1_1Structure_a8f0706e5971387076a3257b149534679_icgraph">
<area shape="rect" title="Calculates derivative of the charges with respect to the atom&#39;s position." alt="" coords="212,5,425,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,5,164,32"/>
</map>
</div>

</div>
</div>
<a id="ac91c699d5b568d865f43ab30fe42f250" name="ac91c699d5b568d865f43ab30fe42f250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac91c699d5b568d865f43ab30fe42f250">&#9670;&nbsp;</a></span>calculateElectrostaticEnergyDerivatives()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::calculateElectrostaticEnergyDerivatives </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd&#160;</td>
          <td class="paramname"><em>hardness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::MatrixXd&#160;</td>
          <td class="paramname"><em>gammaSqrt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd&#160;</td>
          <td class="paramname"><em>sigmaSqrtPi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classnnp_1_1ScreeningFunction.html">ScreeningFunction</a> const &amp;&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>fourPiEps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates partial derivatives of electrostatic Energy with respect to atom's coordinates and charges. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hardness</td><td>Vector containing the hardness of all elements. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gammaSqrt2</td><td>Matrix combining gamma with prefactor. \( \text{gammaSqrt2}_{ij} = \sqrt{2} \gamma_{ij} 
                         = \sqrt{2} \sqrt{(\sigma_i^2 + \sigma_j^2)} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigmaSqrtPi</td><td>Vector combining sigma with prefactor, \( \text{sigmaSqrtPi}_i = \sqrt{\pi} \sigma_i \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fs</td><td>Screening function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fourPiEps</td><td>\( \text{fourPiEps} = 4 \pi \varepsilon_0 \). Value depends on unit system (e.g. normalization). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01083">1083</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1089</span>{</div>
<div class="line"><span class="lineno"> 1090</span>    <span class="comment">// Reset in case structure is used again (e.g. during training)</span></div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordflow">for</span> (<a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> &amp;ai : <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>)</div>
<div class="line"><span class="lineno"> 1092</span>    {</div>
<div class="line"><span class="lineno"> 1093</span>        ai.pEelecpr = <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a>{};</div>
<div class="line"><span class="lineno"> 1094</span>        ai.dEelecdQ = 0.0;</div>
<div class="line"><span class="lineno"> 1095</span>    }</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordtype">double</span> rcutScreen = fs.getOuter();</div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno"> 1099</span>    {</div>
<div class="line"><span class="lineno"> 1100</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno"> 1101</span>        <span class="keywordtype">size_t</span> <span class="keyword">const</span> ei = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno"> 1102</span>        <span class="keywordtype">double</span> <span class="keyword">const</span> Qi = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>        <span class="comment">// TODO: This loop could be reduced by making use of symmetry, j&gt;=i or</span></div>
<div class="line"><span class="lineno"> 1105</span>        <span class="comment">// so</span></div>
<div class="line"><span class="lineno"> 1106</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno"> 1107</span>        {</div>
<div class="line"><span class="lineno"> 1108</span>            <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno"> 1109</span>            <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">charge</a>;</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>            ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">pEelecpr</a> += 0.5 * Qj * ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">dAdrQ</a>[j];</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>            <span class="comment">// Diagonal terms contain self-interaction --&gt; screened</span></div>
<div class="line"><span class="lineno"> 1114</span>            <span class="keywordflow">if</span> (i != j) ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qj * <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i,j);</div>
<div class="line"><span class="lineno"> 1115</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1116</span>            {</div>
<div class="line"><span class="lineno"> 1117</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qi * (<a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>(i,i) - hardness(ei)</div>
<div class="line"><span class="lineno"> 1118</span>                                - 1 / (sigmaSqrtPi(ei) * fourPiEps));</div>
<div class="line"><span class="lineno"> 1119</span>            }</div>
<div class="line"><span class="lineno"> 1120</span>        }</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1123</span>        {</div>
<div class="line"><span class="lineno"> 1124</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; ajN : ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>)</div>
<div class="line"><span class="lineno"> 1125</span>            {</div>
<div class="line"><span class="lineno"> 1126</span>                <span class="keywordtype">size_t</span> j = ajN.tag;</div>
<div class="line"><span class="lineno"> 1127</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno"> 1128</span>                <span class="keywordflow">if</span> (j &lt; i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1129</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> rij = ajN.d;</div>
<div class="line"><span class="lineno"> 1130</span>                <span class="keywordflow">if</span> (rij &gt;= rcutScreen) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno"> 1133</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j).charge;</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>                <span class="keywordtype">double</span> erfRij = erf(rij / gammaSqrt2(ei,ej));</div>
<div class="line"><span class="lineno"> 1136</span>                <span class="keywordtype">double</span> fsRij = fs.f(rij);</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>                <span class="comment">// corrections due to screening</span></div>
<div class="line"><span class="lineno"> 1139</span>                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> Tij = Qi * Qj * ajN.dr / pow(rij,2)</div>
<div class="line"><span class="lineno"> 1140</span>                                * (2 / (sqrt(M_PI) * gammaSqrt2(ei,ej))</div>
<div class="line"><span class="lineno"> 1141</span>                                * exp(- pow(rij / gammaSqrt2(ei,ej),2))</div>
<div class="line"><span class="lineno"> 1142</span>                                * (fsRij - 1) + erfRij * fs.df(rij) - erfRij</div>
<div class="line"><span class="lineno"> 1143</span>                                * (fsRij - 1) / rij);</div>
<div class="line"><span class="lineno"> 1144</span>                Tij /= fourPiEps;</div>
<div class="line"><span class="lineno"> 1145</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">pEelecpr</a> += Tij;</div>
<div class="line"><span class="lineno"> 1146</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">pEelecpr</a> -= Tij;</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>                <span class="keywordtype">double</span> Sij = erfRij * (fsRij - 1) / rij;</div>
<div class="line"><span class="lineno"> 1149</span>                Sij /= fourPiEps;</div>
<div class="line"><span class="lineno"> 1150</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qj * Sij;</div>
<div class="line"><span class="lineno"> 1151</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qi * Sij;</div>
<div class="line"><span class="lineno"> 1152</span>            }</div>
<div class="line"><span class="lineno"> 1153</span>        }</div>
<div class="line"><span class="lineno"> 1154</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1155</span>        {</div>
<div class="line"><span class="lineno"> 1156</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++j)</div>
<div class="line"><span class="lineno"> 1157</span>            {</div>
<div class="line"><span class="lineno"> 1158</span>                <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; aj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j);</div>
<div class="line"><span class="lineno"> 1159</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> rij = (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>).norm();</div>
<div class="line"><span class="lineno"> 1160</span>                <span class="keywordflow">if</span> (rij &gt;= rcutScreen) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>                <span class="keywordtype">size_t</span> <span class="keyword">const</span> ej = aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>;</div>
<div class="line"><span class="lineno"> 1163</span>                <span class="keywordtype">double</span> <span class="keyword">const</span> Qj = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(j).charge;</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>                <span class="keywordtype">double</span> erfRij = erf(rij / gammaSqrt2(ei,ej));</div>
<div class="line"><span class="lineno"> 1166</span>                <span class="keywordtype">double</span> fsRij = fs.f(rij);</div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>                <span class="comment">// corrections due to screening</span></div>
<div class="line"><span class="lineno"> 1169</span>                <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> Tij = Qi * Qj * (ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> - aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>) / pow(rij,2)</div>
<div class="line"><span class="lineno"> 1170</span>                                * (2 / (sqrt(M_PI) * gammaSqrt2(ei,ej))</div>
<div class="line"><span class="lineno"> 1171</span>                                * exp(- pow(rij / gammaSqrt2(ei,ej),2))</div>
<div class="line"><span class="lineno"> 1172</span>                                * (fsRij - 1) + erfRij * fs.df(rij) - erfRij</div>
<div class="line"><span class="lineno"> 1173</span>                                * (fsRij - 1) / rij);</div>
<div class="line"><span class="lineno"> 1174</span>                Tij /= fourPiEps;</div>
<div class="line"><span class="lineno"> 1175</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">pEelecpr</a> += Tij;</div>
<div class="line"><span class="lineno"> 1176</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">pEelecpr</a> -= Tij;</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>                <span class="keywordtype">double</span> Sij = erfRij * (fsRij - 1) / rij;</div>
<div class="line"><span class="lineno"> 1179</span>                Sij /= fourPiEps;</div>
<div class="line"><span class="lineno"> 1180</span>                ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qj * Sij;</div>
<div class="line"><span class="lineno"> 1181</span>                aj.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> += Qi * Sij;</div>
<div class="line"><span class="lineno"> 1182</span>            }</div>
<div class="line"><span class="lineno"> 1183</span>        }</div>
<div class="line"><span class="lineno"> 1184</span>    }</div>
<div class="line"><span class="lineno"> 1185</span>   <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1186</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a69bd2e49a2175ee55dfac1e1a9382497"><div class="ttname"><a href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">nnp::Atom::pEelecpr</a></div><div class="ttdeci">Vec3D pEelecpr</div><div class="ttdoc">Partial derivative of electrostatic energy with respect to this atom's coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00134">Atom.h:134</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_aab0436f3eeb99ca81f4e3684cdd366fd"><div class="ttname"><a href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">nnp::Atom::dEelecdQ</a></div><div class="ttdeci">double dEelecdQ</div><div class="ttdoc">Derivative of electrostatic energy with respect to this atom's charge.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00117">Atom.h:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a2352aabf707595bd9893ed59a9c4977e">nnp::Atom::charge</a>, <a class="el" href="structnnp_1_1Atom.html#a717a08ac6098e2e89d1ccaf22cc11a17">nnp::Atom::dAdrQ</a>, <a class="el" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">nnp::Atom::dEelecdQ</a>, <a class="el" href="classnnp_1_1ScreeningFunction.html#a5d5cfc1ced326fd61eef519dfc6b1e79">nnp::ScreeningFunction::df()</a>, <a class="el" href="structnnp_1_1Atom.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="classnnp_1_1ScreeningFunction.html#aa48557f8e5995c10026f714d490e2bf0">nnp::ScreeningFunction::f()</a>, <a class="el" href="classnnp_1_1ScreeningFunction.html#a39a14618e686220bf57a679b68e1739a">nnp::ScreeningFunction::getOuter()</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Atom.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Atom.html#a69bd2e49a2175ee55dfac1e1a9382497">nnp::Atom::pEelecpr</a>, and <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03">nnp::Mode::chargeEquilibration()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_cgraph" id="astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_cgraph">
<area shape="rect" title="Calculates partial derivatives of electrostatic Energy with respect to atom&#39;s coordinates and charges..." alt="" coords="5,49,228,90"/>
<area shape="rect" href="classnnp_1_1ScreeningFunction.html#a5d5cfc1ced326fd61eef519dfc6b1e79" title="Derivative of screening function ." alt="" coords="276,5,471,32"/>
<area shape="rect" href="classnnp_1_1ScreeningFunction.html#aa48557f8e5995c10026f714d490e2bf0" title="Screening function ." alt="" coords="280,56,467,83"/>
<area shape="rect" href="classnnp_1_1ScreeningFunction.html#a39a14618e686220bf57a679b68e1739a" title="Getter for outer." alt="" coords="287,107,460,149"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_icgraph" id="astructnnp_1_1Structure_ac91c699d5b568d865f43ab30fe42f250_icgraph">
<area shape="rect" title="Calculates partial derivatives of electrostatic Energy with respect to atom&#39;s coordinates and charges..." alt="" coords="277,5,500,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#ad119af59a9a556634735cda828f77f03" title="Perform global charge equilibration method." alt="" coords="5,13,229,39"/>
</map>
</div>

</div>
</div>
<a id="a9373df62476af32ec7c479bbc3fcb063" name="a9373df62476af32ec7c479bbc3fcb063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9373df62476af32ec7c479bbc3fcb063">&#9670;&nbsp;</a></span>calculateForceLambdaTotal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VectorXd const Structure::calculateForceLambdaTotal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate lambda_total vector which is needed for the total force calculation in 4G NN. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01188">1188</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1189</span>{</div>
<div class="line"><span class="lineno"> 1190</span>    VectorXd dEdQ(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>+1);</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno"> 1192</span>    {</div>
<div class="line"><span class="lineno"> 1193</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno"> 1194</span>        dEdQ(i) = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a> + ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#a139bcae479dfbf132aa5e33956c0610d">dEdG</a>.back();</div>
<div class="line"><span class="lineno"> 1195</span>    }</div>
<div class="line"><span class="lineno"> 1196</span>    dEdQ(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>) = 0;</div>
<div class="line"><span class="lineno"> 1197</span>    VectorXd <span class="keyword">const</span> lambdaTotal = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(-dEdQ);</div>
<div class="line"><span class="lineno"> 1198</span>    <span class="keywordflow">return</span> lambdaTotal;</div>
<div class="line"><span class="lineno"> 1199</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a139bcae479dfbf132aa5e33956c0610d"><div class="ttname"><a href="structnnp_1_1Atom.html#a139bcae479dfbf132aa5e33956c0610d">nnp::Atom::dEdG</a></div><div class="ttdeci">std::vector&lt; double &gt; dEdG</div><div class="ttdoc">Derivative of atomic energy with respect to symmetry functions.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00149">Atom.h:149</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a139bcae479dfbf132aa5e33956c0610d">nnp::Atom::dEdG</a>, <a class="el" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">nnp::Atom::dEelecdQ</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a9373df62476af32ec7c479bbc3fcb063_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a9373df62476af32ec7c479bbc3fcb063_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a9373df62476af32ec7c479bbc3fcb063_icgraph" id="astructnnp_1_1Structure_a9373df62476af32ec7c479bbc3fcb063_icgraph">
<area shape="rect" title="Calculate lambda_total vector which is needed for the total force calculation in 4G NN." alt="" coords="252,27,432,69"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1" title="Calculate forces for all atoms in given structure." alt="" coords="5,5,204,32"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#a69139b2e95478a30532b1171c284ce4c" title="Calculate forces and add to LAMMPS atomic force arrays." alt="" coords="21,57,189,98"/>
</map>
</div>

</div>
</div>
<a id="a3237e0cda2706b6930880c9c7f4885c4" name="a3237e0cda2706b6930880c9c7f4885c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3237e0cda2706b6930880c9c7f4885c4">&#9670;&nbsp;</a></span>calculateForceLambdaElec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VectorXd const Structure::calculateForceLambdaElec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate lambda_elec vector which is needed for the electrostatic force calculation in 4G NN. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01201">1201</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1202</span>{</div>
<div class="line"><span class="lineno"> 1203</span>    VectorXd dEelecdQ(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>+1);</div>
<div class="line"><span class="lineno"> 1204</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; ++i)</div>
<div class="line"><span class="lineno"> 1205</span>    {</div>
<div class="line"><span class="lineno"> 1206</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a> <span class="keyword">const</span>&amp; ai = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno"> 1207</span>        dEelecdQ(i) = ai.<a class="code hl_variable" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">dEelecdQ</a>;</div>
<div class="line"><span class="lineno"> 1208</span>    }</div>
<div class="line"><span class="lineno"> 1209</span>    dEelecdQ(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>) = 0;</div>
<div class="line"><span class="lineno"> 1210</span>    VectorXd <span class="keyword">const</span> lambdaElec = <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.colPivHouseholderQr().solve(-dEelecdQ);</div>
<div class="line"><span class="lineno"> 1211</span>    <span class="keywordflow">return</span> lambdaElec;</div>
<div class="line"><span class="lineno"> 1212</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#aab0436f3eeb99ca81f4e3684cdd366fd">nnp::Atom::dEelecdQ</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a3237e0cda2706b6930880c9c7f4885c4_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a3237e0cda2706b6930880c9c7f4885c4_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a3237e0cda2706b6930880c9c7f4885c4_icgraph" id="astructnnp_1_1Structure_a3237e0cda2706b6930880c9c7f4885c4_icgraph">
<area shape="rect" title="Calculate lambda_elec vector which is needed for the electrostatic force calculation in 4G NN." alt="" coords="252,5,432,47"/>
<area shape="rect" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1" title="Calculate forces for all atoms in given structure." alt="" coords="5,13,204,39"/>
</map>
</div>

</div>
</div>
<a id="a60c37b89d8e32f6785168f6a6c201859" name="a60c37b89d8e32f6785168f6a6c201859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c37b89d8e32f6785168f6a6c201859">&#9670;&nbsp;</a></span>remap() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::remap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate all atoms back into box if outside. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01214">1214</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1215</span>{</div>
<div class="line"><span class="lineno"> 1216</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1217</span>    {</div>
<div class="line"><span class="lineno"> 1218</span>        <a class="code hl_function" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap</a>((*it));</div>
<div class="line"><span class="lineno"> 1219</span>    }</div>
<div class="line"><span class="lineno"> 1220</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1221</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, and <a class="el" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, and <a class="el" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_cgraph" id="astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_cgraph">
<area shape="rect" title="Translate all atoms back into box if outside." alt="" coords="5,29,168,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_icgraph" id="astructnnp_1_1Structure_a60c37b89d8e32f6785168f6a6c201859_icgraph">
<area shape="rect" title="Translate all atoms back into box if outside." alt="" coords="272,46,435,73"/>
<area shape="rect" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4" title="Prepare numeric force check for a single structure." alt="" coords="5,5,224,47"/>
<area shape="rect" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32" title="Read configuration from lines." alt="" coords="23,71,206,112"/>
</map>
</div>

</div>
</div>
<a id="a3259977e4b66dbe020c2e827d10ab18c" name="a3259977e4b66dbe020c2e827d10ab18c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3259977e4b66dbe020c2e827d10ab18c">&#9670;&nbsp;</a></span>remap() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::remap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnnp_1_1Atom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate atom back into box if outside. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atom</td><td><a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> to be remapped. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01223">1223</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1224</span>{</div>
<div class="line"><span class="lineno"> 1225</span>    <a class="code hl_struct" href="structnnp_1_1Vec3D.html">Vec3D</a> f = atom.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0]</div>
<div class="line"><span class="lineno"> 1226</span>            + atom.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1]</div>
<div class="line"><span class="lineno"> 1227</span>            + atom.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a>[2] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2];</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>    <span class="comment">// Quick and dirty... there may be a more elegant way!</span></div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">if</span> (f[0] &gt; 1.0) f[0] -= (int)f[0];</div>
<div class="line"><span class="lineno"> 1231</span>    <span class="keywordflow">if</span> (f[1] &gt; 1.0) f[1] -= (int)f[1];</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keywordflow">if</span> (f[2] &gt; 1.0) f[2] -= (int)f[2];</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>    <span class="keywordflow">if</span> (f[0] &lt; 0.0) f[0] += 1.0 - (int)f[0];</div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keywordflow">if</span> (f[1] &lt; 0.0) f[1] += 1.0 - (int)f[1];</div>
<div class="line"><span class="lineno"> 1236</span>    <span class="keywordflow">if</span> (f[2] &lt; 0.0) f[2] += 1.0 - (int)f[2];</div>
<div class="line"><span class="lineno"> 1237</span> </div>
<div class="line"><span class="lineno"> 1238</span>    <span class="keywordflow">if</span> (f[0] == 1.0) f[0] = 0.0;</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="keywordflow">if</span> (f[1] == 1.0) f[1] = 0.0;</div>
<div class="line"><span class="lineno"> 1240</span>    <span class="keywordflow">if</span> (f[2] == 1.0) f[2] = 0.0;</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    atom.<a class="code hl_variable" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">r</a> = f[0] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0]</div>
<div class="line"><span class="lineno"> 1243</span>           + f[1] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1]</div>
<div class="line"><span class="lineno"> 1244</span>           + f[2] * <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2];</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1247</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, and <a class="el" href="structnnp_1_1Atom.html#a0e8397ecd8e60cf9db1f4dfe7378d447">nnp::Atom::r</a>.</p>

</div>
</div>
<a id="abd33241d3bdecf5f1a7eee012118cea3" name="abd33241d3bdecf5f1a7eee012118cea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd33241d3bdecf5f1a7eee012118cea3">&#9670;&nbsp;</a></span>toNormalizedUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::toNormalizedUnits </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>meanEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convCharge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalize structure, shift energy and change energy, length and charge unit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">meanEnergy</td><td>Mean energy per atom (in old units). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convEnergy</td><td>Multiplicative energy unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convLength</td><td>Multiplicative length unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convCharge</td><td>Multiplicative charge unit conversion factor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01249">1249</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1253</span>{</div>
<div class="line"><span class="lineno"> 1254</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1255</span>    {</div>
<div class="line"><span class="lineno"> 1256</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] *= convLength;</div>
<div class="line"><span class="lineno"> 1257</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] *= convLength;</div>
<div class="line"><span class="lineno"> 1258</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] *= convLength;</div>
<div class="line"><span class="lineno"> 1259</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] /= convLength;</div>
<div class="line"><span class="lineno"> 1260</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] /= convLength;</div>
<div class="line"><span class="lineno"> 1261</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] /= convLength;</div>
<div class="line"><span class="lineno"> 1262</span>    }</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = (<a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy) * convEnergy;</div>
<div class="line"><span class="lineno"> 1265</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> = (<a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> - <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy) * convEnergy;</div>
<div class="line"><span class="lineno"> 1266</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a> *= convCharge;</div>
<div class="line"><span class="lineno"> 1267</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a> *= convCharge;</div>
<div class="line"><span class="lineno"> 1268</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> *= convLength * convLength * convLength;</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1271</span>    {</div>
<div class="line"><span class="lineno"> 1272</span>        it-&gt;toNormalizedUnits(convEnergy, convLength, convCharge);</div>
<div class="line"><span class="lineno"> 1273</span>    }</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1276</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a">nnp::Mode::convertToNormalizedUnits()</a>, <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3">nnp::InterfaceLammps::writeToFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_abd33241d3bdecf5f1a7eee012118cea3_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_abd33241d3bdecf5f1a7eee012118cea3_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_abd33241d3bdecf5f1a7eee012118cea3_icgraph" id="astructnnp_1_1Structure_abd33241d3bdecf5f1a7eee012118cea3_icgraph">
<area shape="rect" title="Normalize structure, shift energy and change energy, length and charge unit." alt="" coords="289,71,499,112"/>
<area shape="rect" href="classnnp_1_1Mode.html#a8353f189a07813687e6cda9dff5ef55a" title="Convert one structure to normalized units." alt="" coords="5,5,241,47"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="16,71,231,112"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3" title="Write current structure to file in units used in training data." alt="" coords="39,136,207,177"/>
</map>
</div>

</div>
</div>
<a id="a1858d3c06446ad91b0876f8ca30b2686" name="a1858d3c06446ad91b0876f8ca30b2686"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1858d3c06446ad91b0876f8ca30b2686">&#9670;&nbsp;</a></span>toPhysicalUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::toPhysicalUnits </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>meanEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convCharge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch to physical units, shift energy and change energy, length and charge unit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">meanEnergy</td><td>Mean energy per atom (in old units). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convEnergy</td><td>Multiplicative energy unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convLength</td><td>Multiplicative length unit conversion factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convCharge</td><td>Multiplicative charge unit conversion factor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01278">1278</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1282</span>{</div>
<div class="line"><span class="lineno"> 1283</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1284</span>    {</div>
<div class="line"><span class="lineno"> 1285</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0] /= convLength;</div>
<div class="line"><span class="lineno"> 1286</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1] /= convLength;</div>
<div class="line"><span class="lineno"> 1287</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2] /= convLength;</div>
<div class="line"><span class="lineno"> 1288</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0] *= convLength;</div>
<div class="line"><span class="lineno"> 1289</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1] *= convLength;</div>
<div class="line"><span class="lineno"> 1290</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2] *= convLength;</div>
<div class="line"><span class="lineno"> 1291</span>    }</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> = <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> / convEnergy + <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy;</div>
<div class="line"><span class="lineno"> 1294</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> = <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> / convEnergy + <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * meanEnergy;</div>
<div class="line"><span class="lineno"> 1295</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a> /= convCharge;</div>
<div class="line"><span class="lineno"> 1296</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a> /= convCharge;</div>
<div class="line"><span class="lineno"> 1297</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a> /= convLength * convLength * convLength;</div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1300</span>    {</div>
<div class="line"><span class="lineno"> 1301</span>        it-&gt;toPhysicalUnits(convEnergy, convLength, convCharge);</div>
<div class="line"><span class="lineno"> 1302</span>    }</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1305</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">nnp::Mode::convertToPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3">nnp::InterfaceLammps::writeToFile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a1858d3c06446ad91b0876f8ca30b2686_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a1858d3c06446ad91b0876f8ca30b2686_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a1858d3c06446ad91b0876f8ca30b2686_icgraph" id="astructnnp_1_1Structure_a1858d3c06446ad91b0876f8ca30b2686_icgraph">
<area shape="rect" title="Switch to physical units, shift energy and change energy, length and charge unit." alt="" coords="268,64,456,105"/>
<area shape="rect" href="classnnp_1_1Mode.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6" title="Convert one structure to physical units." alt="" coords="5,5,220,47"/>
<area shape="rect" href="classnnp_1_1Prediction.html#af86efaec86e8002a84368c7282704858" title=" " alt="" coords="27,71,199,98"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3" title="Write current structure to file in units used in training data." alt="" coords="29,123,197,164"/>
</map>
</div>

</div>
</div>
<a id="a26e79c2155e6dd905e7642c6cda008e6" name="a26e79c2155e6dd905e7642c6cda008e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e79c2155e6dd905e7642c6cda008e6">&#9670;&nbsp;</a></span>getMaxNumNeighbors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Structure::getMaxNumNeighbors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find maximum number of neighbors. </p>
<dl class="section return"><dt>Returns</dt><dd>Maximum numbor of neighbors of all atoms in this structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l00473">473</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  474</span>{</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordtype">size_t</span> maxNumNeighbors = 0;</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">for</span>(vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno">  478</span>        it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno">  479</span>    {</div>
<div class="line"><span class="lineno">  480</span>        maxNumNeighbors = max(maxNumNeighbors, it-&gt;numNeighbors);</div>
<div class="line"><span class="lineno">  481</span>    }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span> maxNumNeighbors;</div>
<div class="line"><span class="lineno">  484</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a0c1cbaed161ba008d03a654d5ea04c6a" name="a0c1cbaed161ba008d03a654d5ea04c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1cbaed161ba008d03a654d5ea04c6a">&#9670;&nbsp;</a></span>freeAtoms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::freeAtoms </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>maxCutoffRadius</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free symmetry function memory for all atoms, see free() in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">all</td><td>See description in <a class="el" href="structnnp_1_1Atom.html" title="Storage for a single atom.">Atom</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxCutoffRadius</td><td>Maximum cutoff radius of symmetry functions. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01307">1307</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1308</span>{</div>
<div class="line"><span class="lineno"> 1309</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin(); it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1310</span>    {</div>
<div class="line"><span class="lineno"> 1311</span>        it-&gt;free(all, maxCutoffRadius);</div>
<div class="line"><span class="lineno"> 1312</span>    }</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">if</span> (all) <a class="code hl_variable" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1314</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1317</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, and <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a0c1cbaed161ba008d03a654d5ea04c6a_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a0c1cbaed161ba008d03a654d5ea04c6a_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a0c1cbaed161ba008d03a654d5ea04c6a_icgraph" id="astructnnp_1_1Structure_a0c1cbaed161ba008d03a654d5ea04c6a_icgraph">
<area shape="rect" title="Free symmetry function memory for all atoms, see free() in Atom class." alt="" coords="212,5,401,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,5,164,32"/>
</map>
</div>

</div>
</div>
<a id="abf6bf40715b7ffd70707baf5e95746ce" name="abf6bf40715b7ffd70707baf5e95746ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf6bf40715b7ffd70707baf5e95746ce">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset everything but <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e" title="Copy of element map provided as constructor argument.">elementMap</a>. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01319">1319</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1320</span>{</div>
<div class="line"><span class="lineno"> 1321</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>                     = false     ;</div>
<div class="line"><span class="lineno"> 1322</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>                    = false     ;</div>
<div class="line"><span class="lineno"> 1323</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>                = false     ;</div>
<div class="line"><span class="lineno"> 1324</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>           = false     ;</div>
<div class="line"><span class="lineno"> 1325</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = false     ;</div>
<div class="line"><span class="lineno"> 1326</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>                          = 0         ;</div>
<div class="line"><span class="lineno"> 1327</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>                       = 0         ;</div>
<div class="line"><span class="lineno"> 1328</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>             = 0         ;</div>
<div class="line"><span class="lineno"> 1329</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>                         = 0.0       ;</div>
<div class="line"><span class="lineno"> 1330</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>                      = 0.0       ;</div>
<div class="line"><span class="lineno"> 1331</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>                         = 0.0       ;</div>
<div class="line"><span class="lineno"> 1332</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>                      = 0.0       ;</div>
<div class="line"><span class="lineno"> 1333</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>                         = 0.0       ;</div>
<div class="line"><span class="lineno"> 1334</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>                     = <a class="code hl_enumvalue" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>;</div>
<div class="line"><span class="lineno"> 1335</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>                        = <span class="stringliteral">&quot;&quot;</span>        ;</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; ++i)</div>
<div class="line"><span class="lineno"> 1338</span>    {</div>
<div class="line"><span class="lineno"> 1339</span>        <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[i] = 0;</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 3; ++j)</div>
<div class="line"><span class="lineno"> 1341</span>        {</div>
<div class="line"><span class="lineno"> 1342</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 1343</span>            <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 1344</span>        }</div>
<div class="line"><span class="lineno"> 1345</span>    }</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a> = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>();</div>
<div class="line"><span class="lineno"> 1348</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.clear();</div>
<div class="line"><span class="lineno"> 1349</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><span class="lineno"> 1350</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.clear();</div>
<div class="line"><span class="lineno"> 1351</span>    vector&lt;Atom&gt;(<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>).swap(<a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>);</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1354</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>, <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, <a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676ea937ae91516989440bcde413b084b7381">ST_UNKNOWN</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph" id="astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_cgraph">
<area shape="rect" title="Reset everything but elementMap." alt="" coords="5,5,160,32"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="208,5,379,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph" id="astructnnp_1_1Structure_abf6bf40715b7ffd70707baf5e95746ce_icgraph">
<area shape="rect" title="Reset everything but elementMap." alt="" coords="292,71,447,98"/>
<area shape="rect" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236" title=" " alt="" coords="5,5,244,47"/>
<area shape="rect" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="97,71,152,98"/>
<area shape="rect" href="classnnp_1_1Prediction.html#a217f052c181f847506b5d2382c02246c" title=" " alt="" coords="17,123,232,164"/>
</map>
</div>

</div>
</div>
<a id="af289c389f76b4981aef3c92300aa668d" name="af289c389f76b4981aef3c92300aa668d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af289c389f76b4981aef3c92300aa668d">&#9670;&nbsp;</a></span>clearNeighborList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::clearNeighborList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear neighbor list of all atoms. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01356">1356</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1357</span>{</div>
<div class="line"><span class="lineno"> 1358</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>; i++)</div>
<div class="line"><span class="lineno"> 1359</span>    {</div>
<div class="line"><span class="lineno"> 1360</span>        <a class="code hl_struct" href="structnnp_1_1Atom.html">Atom</a>&amp; a = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i);</div>
<div class="line"><span class="lineno"> 1361</span>        <span class="comment">// This may have changed if atoms are added via addAtoms().</span></div>
<div class="line"><span class="lineno"> 1362</span>        a.<a class="code hl_variable" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">numNeighborsPerElement</a>.resize(<a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, 0);</div>
<div class="line"><span class="lineno"> 1363</span>        a.<a class="code hl_function" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">clearNeighborList</a>();</div>
<div class="line"><span class="lineno"> 1364</span>    }</div>
<div class="line"><span class="lineno"> 1365</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1366</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1367</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1370</span>}</div>
<div class="ttc" id="astructnnp_1_1Atom_html_a53667a4b6cad924e3c15aeda65c2223d"><div class="ttname"><a href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">nnp::Atom::clearNeighborList</a></div><div class="ttdeci">void clearNeighborList()</div><div class="ttdoc">Clear neighbor list.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8cpp_source.html#l00285">Atom.cpp:285</a></div></div>
<div class="ttc" id="astructnnp_1_1Atom_html_ad53c703ea0d760ad25b5f6ebb7bdbf4c"><div class="ttname"><a href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numNeighborsPerElement</div><div class="ttdoc">Number of neighbors per element.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8h_source.html#l00138">Atom.h:138</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d">nnp::Atom::clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, and <a class="el" href="structnnp_1_1Atom.html#ad53c703ea0d760ad25b5f6ebb7bdbf4c">nnp::Atom::numNeighborsPerElement</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph" id="astructnnp_1_1Structure_af289c389f76b4981aef3c92300aa668d_cgraph">
<area shape="rect" title="Clear neighbor list of all atoms." alt="" coords="5,29,240,56"/>
<area shape="rect" href="structnnp_1_1Atom.html#a53667a4b6cad924e3c15aeda65c2223d" title="Clear neighbor list." alt="" coords="288,29,499,56"/>
</map>
</div>

</div>
</div>
<a id="aa595df3985c11f039308dcca5fae828c" name="aa595df3985c11f039308dcca5fae828c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa595df3985c11f039308dcca5fae828c">&#9670;&nbsp;</a></span>clearElectrostatics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::clearElectrostatics </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clearDQdr</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear A-matrix, dAdrQ and optionally dQdr. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clearDqdr</td><td>Specify if dQdr should also be cleared. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01372">1372</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1373</span>{</div>
<div class="line"><span class="lineno"> 1374</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>.resize(0,0);</div>
<div class="line"><span class="lineno"> 1375</span>    <a class="code hl_variable" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1376</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; a : <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>)</div>
<div class="line"><span class="lineno"> 1377</span>    {</div>
<div class="line"><span class="lineno"> 1378</span>        vector&lt;Vec3D&gt;().swap(a.dAdrQ);</div>
<div class="line"><span class="lineno"> 1379</span>        <span class="keywordflow">if</span> (clearDQdr)</div>
<div class="line"><span class="lineno"> 1380</span>        {</div>
<div class="line"><span class="lineno"> 1381</span>            vector&lt;Vec3D&gt;().swap(a.dQdr);</div>
<div class="line"><span class="lineno"> 1382</span>        }</div>
<div class="line"><span class="lineno"> 1383</span>    }</div>
<div class="line"><span class="lineno"> 1384</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a90bd1326da5bb05f04689a06660a2c9c">A</a>, <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, and <a class="el" href="structnnp_1_1Structure.html#a79b8f1a7b53aebd41dab2838084b5618">hasAMatrix</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_aa595df3985c11f039308dcca5fae828c_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_aa595df3985c11f039308dcca5fae828c_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_aa595df3985c11f039308dcca5fae828c_icgraph" id="astructnnp_1_1Structure_aa595df3985c11f039308dcca5fae828c_icgraph">
<area shape="rect" title="Clear A&#45;matrix, dAdrQ and optionally dQdr." alt="" coords="212,5,453,32"/>
<area shape="rect" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d" title="Perform one update." alt="" coords="5,5,164,32"/>
</map>
</div>

</div>
</div>
<a id="add58b9575e3ae19f82991a445aec6b97" name="add58b9575e3ae19f82991a445aec6b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add58b9575e3ae19f82991a445aec6b97">&#9670;&nbsp;</a></span>updateError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::updateError </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update property error metrics with this structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">property</td><td>One of "energy", "force" or "charge". </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">error</td><td>Input error metric map to be updated. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">count</td><td>Input counter to be updated.</td></tr>
  </table>
  </dd>
</dl>
<p>The "energy" error metric map stores temporary sums for the following metrics:</p>
<p >key "RMSEpa": RMSE of energy per atom key "RMSE" : RMSE of energy key "MAEpa" : MAE of energy per atom key "MAE" : MAE of energy</p>
<p >The "force" error metric map stores temporary sums for the following metrics:</p>
<p >key "RMSE" : RMSE of forces key "MAE" : MAE of forces</p>
<p >The "charge" error metric map stores temporary sums for the following metrics:</p>
<p >key "RMSE" : RMSE of charges key "MAE" : MAE of charges </p>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01386">1386</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1389</span>{</div>
<div class="line"><span class="lineno"> 1390</span>    <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;energy&quot;</span>)</div>
<div class="line"><span class="lineno"> 1391</span>    {</div>
<div class="line"><span class="lineno"> 1392</span>        count++;</div>
<div class="line"><span class="lineno"> 1393</span>        <span class="keywordtype">double</span> diff = <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> - <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>;</div>
<div class="line"><span class="lineno"> 1394</span>        error.at(<span class="stringliteral">&quot;RMSEpa&quot;</span>) += diff * diff / (<a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a> * <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1395</span>        error.at(<span class="stringliteral">&quot;RMSE&quot;</span>) += diff * diff;</div>
<div class="line"><span class="lineno"> 1396</span>        diff = fabs(diff);</div>
<div class="line"><span class="lineno"> 1397</span>        error.at(<span class="stringliteral">&quot;MAEpa&quot;</span>) += diff / <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>;</div>
<div class="line"><span class="lineno"> 1398</span>        error.at(<span class="stringliteral">&quot;MAE&quot;</span>) += diff;</div>
<div class="line"><span class="lineno"> 1399</span>    }</div>
<div class="line"><span class="lineno"> 1400</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (property == <span class="stringliteral">&quot;force&quot;</span> || property == <span class="stringliteral">&quot;charge&quot;</span>)</div>
<div class="line"><span class="lineno"> 1401</span>    {</div>
<div class="line"><span class="lineno"> 1402</span>        <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1403</span>             it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1404</span>        {</div>
<div class="line"><span class="lineno"> 1405</span>            it-&gt;updateError(property, error, count);</div>
<div class="line"><span class="lineno"> 1406</span>        }</div>
<div class="line"><span class="lineno"> 1407</span>    }</div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1409</span>    {</div>
<div class="line"><span class="lineno"> 1410</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown property for error update.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1411</span>    }</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1414</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, and <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>.</p>

</div>
</div>
<a id="a96b44fa434482a31e7453a739b84fc09" name="a96b44fa434482a31e7453a739b84fc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b44fa434482a31e7453a739b84fc09">&#9670;&nbsp;</a></span>getEnergyLine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Structure::getEnergyLine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN energy. </p>
<dl class="section return"><dt>Returns</dt><dd>String with <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6" title="Index number of this structure.">index</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61" title="Reference potential energy.">energyRef</a> and <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5" title="Potential energy determined by neural network.">energy</a> values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01416">1416</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1417</span>{</div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%10zu %16.8E %16.8E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1419</span>                 <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>,</div>
<div class="line"><span class="lineno"> 1420</span>                 <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> / <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>,</div>
<div class="line"><span class="lineno"> 1421</span>                 <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> / <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1422</span>}</div>
<div class="ttc" id="anamespacennp_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function.</div><div class="ttdef"><b>Definition:</b> <a href="utility_8cpp_source.html#l00090">utility.cpp:90</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph" id="astructnnp_1_1Structure_a96b44fa434482a31e7453a739b84fc09_cgraph">
<area shape="rect" title="Get reference and NN energy." alt="" coords="5,5,220,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="268,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="ac5a70e2e3f8368758300957a48ead3e2" name="ac5a70e2e3f8368758300957a48ead3e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a70e2e3f8368758300957a48ead3e2">&#9670;&nbsp;</a></span>getForcesLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::getForcesLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN forces for all atoms. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector of strings with force comparison. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01424">1424</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1425</span>{</div>
<div class="line"><span class="lineno"> 1426</span>    vector&lt;string&gt; v;</div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1428</span>         it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1429</span>    {</div>
<div class="line"><span class="lineno"> 1430</span>        vector&lt;string&gt; va = it-&gt;getForcesLines();</div>
<div class="line"><span class="lineno"> 1431</span>        v.insert(v.end(), va.begin(), va.end());</div>
<div class="line"><span class="lineno"> 1432</span>    }</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>    <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno"> 1435</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a6477ccc1b4338e4e2e44a5da7ab49741" name="a6477ccc1b4338e4e2e44a5da7ab49741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6477ccc1b4338e4e2e44a5da7ab49741">&#9670;&nbsp;</a></span>getChargesLines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::getChargesLines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get reference and NN charges for all atoms. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector of strings with charge comparison. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01437">1437</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1438</span>{</div>
<div class="line"><span class="lineno"> 1439</span>    vector&lt;string&gt; v;</div>
<div class="line"><span class="lineno"> 1440</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1441</span>         it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1442</span>    {</div>
<div class="line"><span class="lineno"> 1443</span>        v.push_back(it-&gt;getChargeLine());</div>
<div class="line"><span class="lineno"> 1444</span>    }</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>    <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno"> 1447</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.</p>

</div>
</div>
<a id="a4b24f7e1e265a975b92a5895b09b77af" name="a4b24f7e1e265a975b92a5895b09b77af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b24f7e1e265a975b92a5895b09b77af">&#9670;&nbsp;</a></span>writeToFile() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFile </td>
          <td>(</td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;output.data&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>append</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fileName</td><td>Ouptut file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, write reference energy and forces, if false, write NNP results instead. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">append</td><td>If true, append to existing file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01449">1449</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1452</span>{</div>
<div class="line"><span class="lineno"> 1453</span>    ofstream file;</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>    <span class="keywordflow">if</span> (append)</div>
<div class="line"><span class="lineno"> 1456</span>    {</div>
<div class="line"><span class="lineno"> 1457</span>        file.open(fileName.c_str(), ofstream::app);</div>
<div class="line"><span class="lineno"> 1458</span>    }</div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1460</span>    {</div>
<div class="line"><span class="lineno"> 1461</span>        file.open(fileName.c_str());</div>
<div class="line"><span class="lineno"> 1462</span>    }</div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keywordflow">if</span> (!file.is_open())</div>
<div class="line"><span class="lineno"> 1464</span>    {</div>
<div class="line"><span class="lineno"> 1465</span>        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div>
<div class="line"><span class="lineno"> 1466</span>                            + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1467</span>    }</div>
<div class="line"><span class="lineno"> 1468</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile</a>(&amp;file, ref );</div>
<div class="line"><span class="lineno"> 1469</span>    file.close();</div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1472</span>}</div>
<div class="ttc" id="astructnnp_1_1Structure_html_a4b24f7e1e265a975b92a5895b09b77af"><div class="ttname"><a href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">nnp::Structure::writeToFile</a></div><div class="ttdeci">void writeToFile(std::string const fileName=&quot;output.data&quot;, bool const ref=true, bool const append=false) const</div><div class="ttdoc">Write configuration to file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l01449">Structure.cpp:1449</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3">nnp::InterfaceLammps::writeToFile()</a>, and <a class="el" href="structnnp_1_1Structure.html#a4b24f7e1e265a975b92a5895b09b77af">writeToFile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_cgraph" id="astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_cgraph">
<area shape="rect" title="Write configuration to file." alt="" coords="5,29,196,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph" id="astructnnp_1_1Structure_a4b24f7e1e265a975b92a5895b09b77af_icgraph">
<area shape="rect" title="Write configuration to file." alt="" coords="292,71,483,98"/>
<area shape="rect" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236" title=" " alt="" coords="5,5,244,47"/>
<area shape="rect" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="97,71,152,98"/>
<area shape="rect" href="classnnp_1_1InterfaceLammps.html#aa8a640fa62a611f50d151856eef337e3" title="Write current structure to file in units used in training data." alt="" coords="41,123,209,164"/>
</map>
</div>

</div>
</div>
<a id="a64ded940e3f99aa86b3fa75a37357a29" name="a64ded940e3f99aa86b3fa75a37357a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64ded940e3f99aa86b3fa75a37357a29">&#9670;&nbsp;</a></span>writeToFile() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFile </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>Ouptut file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, write reference energy and forces, if false, write NNP results instead. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01474">1474</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1475</span>{</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><span class="lineno"> 1477</span>    {</div>
<div class="line"><span class="lineno"> 1478</span>        runtime_error(<span class="stringliteral">&quot;ERROR: Cannot write to file, file is not open.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1479</span>    }</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>    (*file) &lt;&lt; <span class="stringliteral">&quot;begin\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1482</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;comment %s\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str());</div>
<div class="line"><span class="lineno"> 1483</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1484</span>    {</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; 3; ++i)</div>
<div class="line"><span class="lineno"> 1486</span>        {</div>
<div class="line"><span class="lineno"> 1487</span>            (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;lattice %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1488</span>                             <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[i][2]);</div>
<div class="line"><span class="lineno"> 1489</span>        }</div>
<div class="line"><span class="lineno"> 1490</span>    }</div>
<div class="line"><span class="lineno"> 1491</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1492</span>         it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1493</span>    {</div>
<div class="line"><span class="lineno"> 1494</span>        <span class="keywordflow">if</span> (ref)</div>
<div class="line"><span class="lineno"> 1495</span>        {</div>
<div class="line"><span class="lineno"> 1496</span>            (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atom %24.16E %24.16E %24.16E %2s %24.16E %24.16E&quot;</span></div>
<div class="line"><span class="lineno"> 1497</span>                             <span class="stringliteral">&quot; %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1498</span>                             it-&gt;r[0],</div>
<div class="line"><span class="lineno"> 1499</span>                             it-&gt;r[1],</div>
<div class="line"><span class="lineno"> 1500</span>                             it-&gt;r[2],</div>
<div class="line"><span class="lineno"> 1501</span>                             <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><span class="lineno"> 1502</span>                             it-&gt;chargeRef,</div>
<div class="line"><span class="lineno"> 1503</span>                             0.0,</div>
<div class="line"><span class="lineno"> 1504</span>                             it-&gt;fRef[0],</div>
<div class="line"><span class="lineno"> 1505</span>                             it-&gt;fRef[1],</div>
<div class="line"><span class="lineno"> 1506</span>                             it-&gt;fRef[2]);</div>
<div class="line"><span class="lineno"> 1507</span>        }</div>
<div class="line"><span class="lineno"> 1508</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1509</span>        {</div>
<div class="line"><span class="lineno"> 1510</span>            (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atom %24.16E %24.16E %24.16E %2s %24.16E %24.16E&quot;</span></div>
<div class="line"><span class="lineno"> 1511</span>                             <span class="stringliteral">&quot; %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1512</span>                             it-&gt;r[0],</div>
<div class="line"><span class="lineno"> 1513</span>                             it-&gt;r[1],</div>
<div class="line"><span class="lineno"> 1514</span>                             it-&gt;r[2],</div>
<div class="line"><span class="lineno"> 1515</span>                             <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><span class="lineno"> 1516</span>                             it-&gt;charge,</div>
<div class="line"><span class="lineno"> 1517</span>                             0.0,</div>
<div class="line"><span class="lineno"> 1518</span>                             it-&gt;f[0],</div>
<div class="line"><span class="lineno"> 1519</span>                             it-&gt;f[1],</div>
<div class="line"><span class="lineno"> 1520</span>                             it-&gt;f[2]);</div>
<div class="line"><span class="lineno"> 1521</span> </div>
<div class="line"><span class="lineno"> 1522</span>        }</div>
<div class="line"><span class="lineno"> 1523</span>    }</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="keywordflow">if</span> (ref) (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy %24.16E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>);</div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keywordflow">else</span>     (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy %24.16E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>);</div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordflow">if</span> (ref) (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge %24.16E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>);</div>
<div class="line"><span class="lineno"> 1527</span>    <span class="keywordflow">else</span>     (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge %24.16E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>);</div>
<div class="line"><span class="lineno"> 1528</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;end\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1531</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph" id="astructnnp_1_1Structure_a64ded940e3f99aa86b3fa75a37357a29_cgraph">
<area shape="rect" title="Write configuration to file." alt="" coords="5,5,196,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="244,5,328,32"/>
</map>
</div>

</div>
</div>
<a id="a8285382c3e2d908c8073a1fac315176b" name="a8285382c3e2d908c8073a1fac315176b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8285382c3e2d908c8073a1fac315176b">&#9670;&nbsp;</a></span>writeToFileXyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFileXyz </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to xyz file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>xyz output file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01533">1533</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1534</span>{</div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><span class="lineno"> 1536</span>    {</div>
<div class="line"><span class="lineno"> 1537</span>        runtime_error(<span class="stringliteral">&quot;ERROR: Could not write to file.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1538</span>    }</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>);</div>
<div class="line"><span class="lineno"> 1541</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1542</span>    {</div>
<div class="line"><span class="lineno"> 1543</span>        (*file) &lt;&lt; <span class="stringliteral">&quot;Lattice=\&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1544</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E &quot;</span>   ,</div>
<div class="line"><span class="lineno"> 1545</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]);</div>
<div class="line"><span class="lineno"> 1546</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E &quot;</span>   ,</div>
<div class="line"><span class="lineno"> 1547</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]);</div>
<div class="line"><span class="lineno"> 1548</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\&quot;\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1549</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]);</div>
<div class="line"><span class="lineno"> 1550</span>    }</div>
<div class="line"><span class="lineno"> 1551</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1552</span>    {</div>
<div class="line"><span class="lineno"> 1553</span>        (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1554</span>    }</div>
<div class="line"><span class="lineno"> 1555</span>    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1556</span>         it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1557</span>    {</div>
<div class="line"><span class="lineno"> 1558</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%-2s %24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1559</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[it-&gt;element].c_str(),</div>
<div class="line"><span class="lineno"> 1560</span>                         it-&gt;r[0],</div>
<div class="line"><span class="lineno"> 1561</span>                         it-&gt;r[1],</div>
<div class="line"><span class="lineno"> 1562</span>                         it-&gt;r[2]);</div>
<div class="line"><span class="lineno"> 1563</span>    }</div>
<div class="line"><span class="lineno"> 1564</span> </div>
<div class="line"><span class="lineno"> 1565</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1566</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph" id="astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_cgraph">
<area shape="rect" title="Write configuration to xyz file." alt="" coords="5,5,220,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="268,5,352,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph" id="astructnnp_1_1Structure_a8285382c3e2d908c8073a1fac315176b_icgraph">
<area shape="rect" title="Write configuration to xyz file." alt="" coords="108,5,323,32"/>
<area shape="rect" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<a id="a7eaa3ccba6309f828c2444ee627d7ee5" name="a7eaa3ccba6309f828c2444ee627d7ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eaa3ccba6309f828c2444ee627d7ee5">&#9670;&nbsp;</a></span>writeToFilePoscar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFilePoscar </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to POSCAR file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>POSCAR output file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements in POTCAR file must be ordered according to periodic table. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01568">1568</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1569</span>{</div>
<div class="line"><span class="lineno"> 1570</span>    <a class="code hl_function" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar</a>(file, <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">getElementsString</a>());</div>
<div class="line"><span class="lineno"> 1571</span> </div>
<div class="line"><span class="lineno"> 1572</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1573</span>}</div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_ab3c6fd52cc1fa5f0c1a1c8bc50c4542a"><div class="ttname"><a href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">nnp::ElementMap::getElementsString</a></div><div class="ttdeci">std::string getElementsString() const</div><div class="ttdoc">Get sorted list of elements in one string (space separated).</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8cpp_source.html#l00056">ElementMap.cpp:56</a></div></div>
<div class="ttc" id="astructnnp_1_1Structure_html_a7eaa3ccba6309f828c2444ee627d7ee5"><div class="ttname"><a href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">nnp::Structure::writeToFilePoscar</a></div><div class="ttdeci">void writeToFilePoscar(std::ofstream *const &amp;file) const</div><div class="ttdoc">Write configuration to POSCAR file.</div><div class="ttdef"><b>Definition:</b> <a href="Structure_8cpp_source.html#l01568">Structure.cpp:1568</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a">nnp::ElementMap::getElementsString()</a>, and <a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph" id="astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_cgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="5,29,196,71"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#ab3c6fd52cc1fa5f0c1a1c8bc50c4542a" title="Get sorted list of elements in one string (space separated)." alt="" coords="244,29,471,71"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph" id="astructnnp_1_1Structure_a7eaa3ccba6309f828c2444ee627d7ee5_icgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="108,29,299,71"/>
<area shape="rect" href="nnp-convert_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,37,60,63"/>
</map>
</div>

</div>
</div>
<a id="a5e1f59c24c85703e6e78c7f85d47a2d8" name="a5e1f59c24c85703e6e78c7f85d47a2d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1f59c24c85703e6e78c7f85d47a2d8">&#9670;&nbsp;</a></span>writeToFilePoscar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Structure::writeToFilePoscar </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const&#160;</td>
          <td class="paramname"><em>elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write configuration to POSCAR file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td>POSCAR output file. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">elements</td><td>User-defined order of elements, e.g. "Zn O Cu". </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01575">1575</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1577</span>{</div>
<div class="line"><span class="lineno"> 1578</span>    <span class="keywordflow">if</span> (!file-&gt;is_open())</div>
<div class="line"><span class="lineno"> 1579</span>    {</div>
<div class="line"><span class="lineno"> 1580</span>        runtime_error(<span class="stringliteral">&quot;ERROR: Could not write to file.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1581</span>    }</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>    vector&lt;string&gt; ve = <a class="code hl_function" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(elements);</div>
<div class="line"><span class="lineno"> 1584</span>    vector&lt;size_t&gt; elementOrder;</div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ve.size(); ++i)</div>
<div class="line"><span class="lineno"> 1586</span>    {</div>
<div class="line"><span class="lineno"> 1587</span>        elementOrder.push_back(<a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[ve.at(i)]);</div>
<div class="line"><span class="lineno"> 1588</span>    }</div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keywordflow">if</span> (elementOrder.size() != <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>())</div>
<div class="line"><span class="lineno"> 1590</span>    {</div>
<div class="line"><span class="lineno"> 1591</span>        runtime_error(<span class="stringliteral">&quot;ERROR: Inconsistent element declaration.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1592</span>    }</div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%s, &quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str());</div>
<div class="line"><span class="lineno"> 1595</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;ATOM=%s&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[elementOrder.at(0)].c_str());</div>
<div class="line"><span class="lineno"> 1596</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; elementOrder.size(); ++i)</div>
<div class="line"><span class="lineno"> 1597</span>    {</div>
<div class="line"><span class="lineno"> 1598</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %s&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>[elementOrder.at(i)].c_str());</div>
<div class="line"><span class="lineno"> 1599</span>    }</div>
<div class="line"><span class="lineno"> 1600</span>    (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1601</span>    (*file) &lt;&lt; <span class="stringliteral">&quot;1.0\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1602</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>)</div>
<div class="line"><span class="lineno"> 1603</span>    {</div>
<div class="line"><span class="lineno"> 1604</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1605</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]);</div>
<div class="line"><span class="lineno"> 1606</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1607</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]);</div>
<div class="line"><span class="lineno"> 1608</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1609</span>                         <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]);</div>
<div class="line"><span class="lineno"> 1610</span>    }</div>
<div class="line"><span class="lineno"> 1611</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1612</span>    {</div>
<div class="line"><span class="lineno"> 1613</span>        runtime_error(<span class="stringliteral">&quot;ERROR: Writing non-periodic structure to POSCAR file &quot;</span></div>
<div class="line"><span class="lineno"> 1614</span>                      <span class="stringliteral">&quot;is not implemented.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1615</span>    }</div>
<div class="line"><span class="lineno"> 1616</span>    (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%d&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(elementOrder.at(0)));</div>
<div class="line"><span class="lineno"> 1617</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size(); ++i)</div>
<div class="line"><span class="lineno"> 1618</span>    {</div>
<div class="line"><span class="lineno"> 1619</span>        (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %d&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(elementOrder.at(i)));</div>
<div class="line"><span class="lineno"> 1620</span>    }</div>
<div class="line"><span class="lineno"> 1621</span>    (*file) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1622</span>    (*file) &lt;&lt; <span class="stringliteral">&quot;Cartesian\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1623</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; elementOrder.size(); ++i)</div>
<div class="line"><span class="lineno"> 1624</span>    {</div>
<div class="line"><span class="lineno"> 1625</span>        <span class="keywordflow">for</span> (vector&lt;Atom&gt;::const_iterator it = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div>
<div class="line"><span class="lineno"> 1626</span>             it != <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1627</span>        {</div>
<div class="line"><span class="lineno"> 1628</span>            <span class="keywordflow">if</span> (it-&gt;element == elementOrder.at(i))</div>
<div class="line"><span class="lineno"> 1629</span>            {</div>
<div class="line"><span class="lineno"> 1630</span>                (*file) &lt;&lt; <a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%24.16E %24.16E %24.16E\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1631</span>                                 it-&gt;r[0],</div>
<div class="line"><span class="lineno"> 1632</span>                                 it-&gt;r[1],</div>
<div class="line"><span class="lineno"> 1633</span>                                 it-&gt;r[2]);</div>
<div class="line"><span class="lineno"> 1634</span>            }</div>
<div class="line"><span class="lineno"> 1635</span>        }</div>
<div class="line"><span class="lineno"> 1636</span>    }</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1639</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, <a class="el" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph" id="astructnnp_1_1Structure_a5e1f59c24c85703e6e78c7f85d47a2d8_cgraph">
<area shape="rect" title="Write configuration to POSCAR file." alt="" coords="5,49,196,90"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size." alt="" coords="244,5,415,32"/>
<area shape="rect" href="namespacennp.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter." alt="" coords="288,56,371,83"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="287,107,371,133"/>
</map>
</div>

</div>
</div>
<a id="af6d63337cd7d1a4e0058cd818543caef" name="af6d63337cd7d1a4e0058cd818543caef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6d63337cd7d1a4e0058cd818543caef">&#9670;&nbsp;</a></span>info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; Structure::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get structure information as a vector of strings. </p>
<dl class="section return"><dt>Returns</dt><dd>Lines with structure information. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Structure_8cpp_source.html#l01641">1641</a> of file <a class="el" href="Structure_8cpp_source.html">Structure.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1642</span>{</div>
<div class="line"><span class="lineno"> 1643</span>    vector&lt;string&gt; v;</div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1646</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;STRUCTURE                       \n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1647</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1648</span>    vector&lt;string&gt; vm = <a class="code hl_variable" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>.<a class="code hl_function" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">info</a>();</div>
<div class="line"><span class="lineno"> 1649</span>    v.insert(v.end(), vm.begin(), vm.end());</div>
<div class="line"><span class="lineno"> 1650</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;index                          : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>));</div>
<div class="line"><span class="lineno"> 1651</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;isPeriodic                     : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>        ));</div>
<div class="line"><span class="lineno"> 1652</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;isTriclinic                    : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>       ));</div>
<div class="line"><span class="lineno"> 1653</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasNeighborList                : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>   ));</div>
<div class="line"><span class="lineno"> 1654</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasSymmetryFunctions           : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>));</div>
<div class="line"><span class="lineno"> 1655</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;hasSymmetryFunctionDerivatives : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>));</div>
<div class="line"><span class="lineno"> 1656</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numAtoms                       : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>          ));</div>
<div class="line"><span class="lineno"> 1657</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numElements                    : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>       ));</div>
<div class="line"><span class="lineno"> 1658</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numElementsPresent             : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>));</div>
<div class="line"><span class="lineno"> 1659</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;pbc                            : %d %d %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[0], <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[1], <a class="code hl_variable" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>[2]));</div>
<div class="line"><span class="lineno"> 1660</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energy                         : %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>        ));</div>
<div class="line"><span class="lineno"> 1661</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;energyRef                      : %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>     ));</div>
<div class="line"><span class="lineno"> 1662</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;charge                         : %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>        ));</div>
<div class="line"><span class="lineno"> 1663</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;chargeRef                      : %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>     ));</div>
<div class="line"><span class="lineno"> 1664</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;volume                         : %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>        ));</div>
<div class="line"><span class="lineno"> 1665</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;sampleType                     : %d\n&quot;</span>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>));</div>
<div class="line"><span class="lineno"> 1666</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;comment                        : %s\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>.c_str()   ));</div>
<div class="line"><span class="lineno"> 1667</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[0]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[0][2]));</div>
<div class="line"><span class="lineno"> 1668</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[1]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[1][2]));</div>
<div class="line"><span class="lineno"> 1669</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;box[2]                         : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>[2][2]));</div>
<div class="line"><span class="lineno"> 1670</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[0]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[0][2]));</div>
<div class="line"><span class="lineno"> 1671</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[1]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[1][2]));</div>
<div class="line"><span class="lineno"> 1672</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;invbox[2]                      : %16.8E %16.8E %16.8E\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][0], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][1], <a class="code hl_variable" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>[2][2]));</div>
<div class="line"><span class="lineno"> 1673</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1674</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;numAtomsPerElement         [*] : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size()));</div>
<div class="line"><span class="lineno"> 1675</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1676</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.size(); ++i)</div>
<div class="line"><span class="lineno"> 1677</span>    {</div>
<div class="line"><span class="lineno"> 1678</span>        v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%29d  : %d\n&quot;</span>, i, <a class="code hl_variable" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)));</div>
<div class="line"><span class="lineno"> 1679</span>    }</div>
<div class="line"><span class="lineno"> 1680</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1681</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1682</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;atoms                      [*] : %d\n&quot;</span>, <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size()));</div>
<div class="line"><span class="lineno"> 1683</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1684</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div>
<div class="line"><span class="lineno"> 1685</span>    {</div>
<div class="line"><span class="lineno"> 1686</span>        v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%29d  :\n&quot;</span>, i));</div>
<div class="line"><span class="lineno"> 1687</span>        vector&lt;string&gt; va = <a class="code hl_variable" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>[i].info();</div>
<div class="line"><span class="lineno"> 1688</span>        v.insert(v.end(), va.begin(), va.end());</div>
<div class="line"><span class="lineno"> 1689</span>    }</div>
<div class="line"><span class="lineno"> 1690</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;--------------------------------\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1691</span>    v.push_back(<a class="code hl_function" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;********************************\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>    <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno"> 1694</span>}</div>
<div class="ttc" id="aclassnnp_1_1ElementMap_html_a502ccfa87ec2982d1be854c4fa3fa46b"><div class="ttname"><a href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">nnp::ElementMap::info</a></div><div class="ttdeci">std::vector&lt; std::string &gt; info() const</div><div class="ttdoc">Get map information as a vector of strings.</div><div class="ttdef"><b>Definition:</b> <a href="ElementMap_8cpp_source.html#l00125">ElementMap.cpp:125</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structnnp_1_1Structure.html#adee965dec483f9479378a2ed4acd5544">atoms</a>, <a class="el" href="structnnp_1_1Structure.html#a21e5cd213176fab9075b3f040dd6dee6">box</a>, <a class="el" href="structnnp_1_1Structure.html#a50427699538016623ef2331c9eb67f01">charge</a>, <a class="el" href="structnnp_1_1Structure.html#a65839bc1a3213a6d77e064b5edade786">chargeRef</a>, <a class="el" href="structnnp_1_1Structure.html#a4d519c01388cad10212f64eda1fa6c8b">comment</a>, <a class="el" href="structnnp_1_1Structure.html#a56766c6996fa1bf63e4616b7fd03c84e">elementMap</a>, <a class="el" href="structnnp_1_1Structure.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a>, <a class="el" href="structnnp_1_1Structure.html#aaee087b13af754a75198def4d12c8b61">energyRef</a>, <a class="el" href="structnnp_1_1Structure.html#af21dfbdaf41e8332ee0f773a070f3f74">hasNeighborList</a>, <a class="el" href="structnnp_1_1Structure.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>, <a class="el" href="structnnp_1_1Structure.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a>, <a class="el" href="structnnp_1_1Structure.html#a5af7b5cd0a2154c2e34a3b8a73a51ca6">index</a>, <a class="el" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b">nnp::ElementMap::info()</a>, <a class="el" href="structnnp_1_1Structure.html#a177773f58df6da23d833e1cca0eb2cf8">invbox</a>, <a class="el" href="structnnp_1_1Structure.html#a4d8ebcacb8fc434178c7c90cb2f70110">isPeriodic</a>, <a class="el" href="structnnp_1_1Structure.html#a2627321edafea60f478b35e7387e0681">isTriclinic</a>, <a class="el" href="structnnp_1_1Structure.html#ad2c737c945e42ec42fa852e4dbacaf90">numAtoms</a>, <a class="el" href="structnnp_1_1Structure.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>, <a class="el" href="structnnp_1_1Structure.html#ad47f8d1a1742f5430418fcd1b8919eb6">numElements</a>, <a class="el" href="structnnp_1_1Structure.html#ae2fa28a5a6b564d3ec23a6905736730a">numElementsPresent</a>, <a class="el" href="structnnp_1_1Structure.html#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">pbc</a>, <a class="el" href="structnnp_1_1Structure.html#a6665217897b26fa4fd01a07aa652cd2f">sampleType</a>, <a class="el" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="structnnp_1_1Structure.html#ac8c6f2c95c4ca25893d2be192effff3d">volume</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph.png" border="0" usemap="#astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph" id="astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_cgraph">
<area shape="rect" title="Get structure information as a vector of strings." alt="" coords="5,31,152,57"/>
<area shape="rect" href="classnnp_1_1ElementMap.html#a502ccfa87ec2982d1be854c4fa3fa46b" title="Get map information as a vector of strings." alt="" coords="200,5,369,32"/>
<area shape="rect" href="namespacennp.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function." alt="" coords="417,31,501,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="structnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph.png" border="0" usemap="#astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph" alt=""/></div>
<map name="astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph" id="astructnnp_1_1Structure_af6d63337cd7d1a4e0058cd818543caef_icgraph">
<area shape="rect" title="Get structure information as a vector of strings." alt="" coords="108,5,255,32"/>
<area shape="rect" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a56766c6996fa1bf63e4616b7fd03c84e" name="a56766c6996fa1bf63e4616b7fd03c84e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56766c6996fa1bf63e4616b7fd03c84e">&#9670;&nbsp;</a></span>elementMap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnnp_1_1ElementMap.html">ElementMap</a> nnp::Structure::elementMap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy of element map provided as constructor argument. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00059">59</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a7eaa3ccba6309f828c2444ee627d7ee5">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a4d8ebcacb8fc434178c7c90cb2f70110" name="a4d8ebcacb8fc434178c7c90cb2f70110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8ebcacb8fc434178c7c90cb2f70110">&#9670;&nbsp;</a></span>isPeriodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::isPeriodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If periodic boundary conditions apply. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00061">61</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">calculateDAdrQ()</a>, <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">calculateElectrostaticEnergyDerivatives()</a>, <a class="el" href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">calculateMaxCutoffRadiusOverall()</a>, <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy()</a>, <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96">nnp::InterfaceLammps::setBoxVectors()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a2627321edafea60f478b35e7387e0681" name="a2627321edafea60f478b35e7387e0681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2627321edafea60f478b35e7387e0681">&#9670;&nbsp;</a></span>isTriclinic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::isTriclinic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the simulation box is triclinic. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00063">63</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96">nnp::InterfaceLammps::setBoxVectors()</a>.</p>

</div>
</div>
<a id="af21dfbdaf41e8332ee0f773a070f3f74" name="af21dfbdaf41e8332ee0f773a070f3f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af21dfbdaf41e8332ee0f773a070f3f74">&#9670;&nbsp;</a></span>hasNeighborList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasNeighborList</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the neighbor list has been calculated. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00065">65</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="a5142f63d6a9301709e67197438ef77d1" name="a5142f63d6a9301709e67197438ef77d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5142f63d6a9301709e67197438ef77d1">&#9670;&nbsp;</a></span>NeighborListIsSorted</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::NeighborListIsSorted</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the neighbor list has been sorted by distance. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00067">67</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap()</a>, and <a class="el" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList()</a>.</p>

</div>
</div>
<a id="aff934fe32fb46e93dd9551d50ed4b0b6" name="aff934fe32fb46e93dd9551d50ed4b0b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff934fe32fb46e93dd9551d50ed4b0b6">&#9670;&nbsp;</a></span>hasSymmetryFunctions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasSymmetryFunctions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If symmetry function values are saved for each atom. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00069">69</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a0c1cbaed161ba008d03a654d5ea04c6a">freeAtoms()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="a82f10399909e0f7fa8f6344c305781cc" name="a82f10399909e0f7fa8f6344c305781cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82f10399909e0f7fa8f6344c305781cc">&#9670;&nbsp;</a></span>hasSymmetryFunctionDerivatives</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasSymmetryFunctionDerivatives</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If symmetry function derivatives are saved for each atom. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00071">71</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a0c1cbaed161ba008d03a654d5ea04c6a">freeAtoms()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="a5af7b5cd0a2154c2e34a3b8a73a51ca6" name="a5af7b5cd0a2154c2e34a3b8a73a51ca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af7b5cd0a2154c2e34a3b8a73a51ca6">&#9670;&nbsp;</a></span>index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::index</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index number of this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00073">73</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1Dataset.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>.</p>

</div>
</div>
<a id="ad2c737c945e42ec42fa852e4dbacaf90" name="ad2c737c945e42ec42fa852e4dbacaf90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c737c945e42ec42fa852e4dbacaf90">&#9670;&nbsp;</a></span>numAtoms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numAtoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total number of atoms present in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00075">75</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a21635e0bdb42f74425b11639d736f3cb">nnp::InterfaceLammps::allocateNeighborlists()</a>, <a class="el" href="classnnp_1_1Training.html#ab04baa25ad186e9a82a4a4fa7f3bdca4">nnp::Training::calculateChargeErrorVec()</a>, <a class="el" href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">calculateDAdrQ()</a>, <a class="el" href="structnnp_1_1Structure.html#a4cd07a8b746a55aea0f0b6181a9f645f">calculateDQdChi()</a>, <a class="el" href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">calculateDQdJ()</a>, <a class="el" href="structnnp_1_1Structure.html#a8f0706e5971387076a3257b149534679">calculateDQdr()</a>, <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">calculateElectrostaticEnergyDerivatives()</a>, <a class="el" href="structnnp_1_1Structure.html#a3237e0cda2706b6930880c9c7f4885c4">calculateForceLambdaElec()</a>, <a class="el" href="structnnp_1_1Structure.html#a9373df62476af32ec7c479bbc3fcb063">calculateForceLambdaTotal()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">calculateMaxCutoffRadiusOverall()</a>, <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="classnnp_1_1Training.html#a59b8fac49977fbc5a5b41d9a58346697">nnp::Training::dPdc()</a>, <a class="el" href="classnnp_1_1Training.html#aa2d978b9e0c45624a9e48c455b57b72d">nnp::Training::dPdcN()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#ab13d05c75565b694a19aca7265e3216b">nnp::InterfaceLammps::getCharges()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a556c07c02b8b8db8f8a4a9b8665d2d72">nnp::InterfaceLammps::setLocalAtomPositions()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="ad47f8d1a1742f5430418fcd1b8919eb6" name="ad47f8d1a1742f5430418fcd1b8919eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47f8d1a1742f5430418fcd1b8919eb6">&#9670;&nbsp;</a></span>numElements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numElements</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global number of elements (all structures). </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00077">77</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">calculateDQdJ()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>.</p>

</div>
</div>
<a id="ae2fa28a5a6b564d3ec23a6905736730a" name="ae2fa28a5a6b564d3ec23a6905736730a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2fa28a5a6b564d3ec23a6905736730a">&#9670;&nbsp;</a></span>numElementsPresent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Structure::numElementsPresent</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of elements present in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00079">79</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, and <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>.</p>

</div>
</div>
<a id="ab4f8ec9fb43d1dc3d07b4c59bf28a8bd" name="ab4f8ec9fb43d1dc3d07b4c59bf28a8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4f8ec9fb43d1dc3d07b4c59bf28a8bd">&#9670;&nbsp;</a></span>pbc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nnp::Structure::pbc[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of PBC images necessary in each direction for max cut-off. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00081">81</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, and <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>.</p>

</div>
</div>
<a id="aa9fd0fd0f8a23b6bf96247589feceeb5" name="aa9fd0fd0f8a23b6bf96247589feceeb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fd0fd0f8a23b6bf96247589feceeb5">&#9670;&nbsp;</a></span>energy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Potential energy determined by neural network. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00083">83</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="classnnp_1_1Training.html#aa2d978b9e0c45624a9e48c455b57b72d">nnp::Training::dPdcN()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a5efd42ba997e4cefca70ae3445f60f3f">nnp::InterfaceLammps::getEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="aaee087b13af754a75198def4d12c8b61" name="aaee087b13af754a75198def4d12c8b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee087b13af754a75198def4d12c8b61">&#9670;&nbsp;</a></span>energyRef</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energyRef</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference potential energy. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00085">85</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#a96b44fa434482a31e7453a739b84fc09">getEnergyLine()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Mode.html#af5d51e9328414aea8106d85bde5a1729">nnp::Mode::normalizedEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a02d558483ab82d340ee587febcfddd8f">nnp::Mode::physicalEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="a6c2903270f6db9ebf27d59dab9bd2914" name="a6c2903270f6db9ebf27d59dab9bd2914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2903270f6db9ebf27d59dab9bd2914">&#9670;&nbsp;</a></span>energyShort</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energyShort</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Short-range part of the potential energy predicted by NNP. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00088">88</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>.</p>

</div>
</div>
<a id="aa8d5c1fa9994b603c38e25250da743df" name="aa8d5c1fa9994b603c38e25250da743df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8d5c1fa9994b603c38e25250da743df">&#9670;&nbsp;</a></span>energyElec</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::energyElec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Electrostatics part of the potential energy predicted by NNP. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00091">91</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, and <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="af9eaacc767607b846ddf9b30109c570e" name="af9eaacc767607b846ddf9b30109c570e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9eaacc767607b846ddf9b30109c570e">&#9670;&nbsp;</a></span>hasCharges</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasCharges</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If all charges of this structure have been calculated (and stay the same, e.g. </p>
<p >for stage 2). </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00094">94</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>

</div>
</div>
<a id="a50427699538016623ef2331c9eb67f01" name="a50427699538016623ef2331c9eb67f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50427699538016623ef2331c9eb67f01">&#9670;&nbsp;</a></span>charge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::charge</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Charge determined by neural network potential. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00096">96</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">nnp::Mode::calculateCharge()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="a65839bc1a3213a6d77e064b5edade786" name="a65839bc1a3213a6d77e064b5edade786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65839bc1a3213a6d77e064b5edade786">&#9670;&nbsp;</a></span>chargeRef</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::chargeRef</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference charge. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00098">98</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-predict_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>.</p>

</div>
</div>
<a id="ac8c6f2c95c4ca25893d2be192effff3d" name="ac8c6f2c95c4ca25893d2be192effff3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c6f2c95c4ca25893d2be192effff3d">&#9670;&nbsp;</a></span>volume</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::volume</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation box volume. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00100">100</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">calculateMaxCutoffRadiusOverall()</a>, <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a4f2cb7342755dc1305b5105a5512c129" name="a4f2cb7342755dc1305b5105a5512c129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2cb7342755dc1305b5105a5512c129">&#9670;&nbsp;</a></span>maxCutoffRadiusOverall</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::maxCutoffRadiusOverall</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum cut-off radius with respect to symmetry functions, screening function and Ewald summation. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00103">103</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a46770abdefe49a0ab488049caa99905c">calculateMaxCutoffRadiusOverall()</a>, <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a424a1a3da552a795a7b1e945303905b6">nnp::InterfaceLammps::getMaxCutoffRadiusOverall()</a>, and <a class="el" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap()</a>.</p>

</div>
</div>
<a id="a39f49b6c8dc038aab8ee34ba92b1b785" name="a39f49b6c8dc038aab8ee34ba92b1b785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39f49b6c8dc038aab8ee34ba92b1b785">&#9670;&nbsp;</a></span>lambda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Structure::lambda</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lagrange multiplier used for charge equilibration. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00106">106</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>.</p>

</div>
</div>
<a id="a6665217897b26fa4fd01a07aa652cd2f" name="a6665217897b26fa4fd01a07aa652cd2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6665217897b26fa4fd01a07aa652cd2f">&#9670;&nbsp;</a></span>sampleType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Structure.html#a118a744590977c2b258feace6dc6676e">SampleType</a> nnp::Structure::sampleType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sample type (training or test set). </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00108">108</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, and <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>.</p>

</div>
</div>
<a id="a4d519c01388cad10212f64eda1fa6c8b" name="a4d519c01388cad10212f64eda1fa6c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d519c01388cad10212f64eda1fa6c8b">&#9670;&nbsp;</a></span>comment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string nnp::Structure::comment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structnnp_1_1Structure.html" title="Storage for one atomic configuration.">Structure</a> comment. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00110">110</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-comp2_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, and <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>.</p>

</div>
</div>
<a id="a21e5cd213176fab9075b3f040dd6dee6" name="a21e5cd213176fab9075b3f040dd6dee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e5cd213176fab9075b3f040dd6dee6">&#9670;&nbsp;</a></span>box</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> nnp::Structure::box[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulation box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00112">112</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd3edbae28ee8196bc67bac988a83d93">applyMinimumImageConvention()</a>, <a class="el" href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">calculateDAdrQ()</a>, <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a924f2222a9df39041690d23f2d5963fd">calculatePbcCopies()</a>, <a class="el" href="structnnp_1_1Structure.html#a10f626682421d3690d8f1cb9ceba006f">calculateVolume()</a>, <a class="el" href="structnnp_1_1Structure.html#a4a593b477540ad63365bfa292d0f54f1">canMinimumImageConventionBeApplied()</a>, <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a8d0a97e54c5a6481623c80eb0b1f1b96">nnp::InterfaceLammps::setBoxVectors()</a>, <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<a id="a177773f58df6da23d833e1cca0eb2cf8" name="a177773f58df6da23d833e1cca0eb2cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a177773f58df6da23d833e1cca0eb2cf8">&#9670;&nbsp;</a></span>invbox</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnnp_1_1Vec3D.html">Vec3D</a> nnp::Structure::invbox[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inverse simulation box vectors. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00114">114</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#acd3edbae28ee8196bc67bac988a83d93">applyMinimumImageConvention()</a>, <a class="el" href="structnnp_1_1Structure.html#a7d4ec60f305ae52787eb7dc0995eaec3">calculateInverseBox()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a3259977e4b66dbe020c2e827d10ab18c">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#ac6c101b28efea5a150cce3bb8948f8d1">Structure()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, and <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a90bd1326da5bb05f04689a06660a2c9c" name="a90bd1326da5bb05f04689a06660a2c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bd1326da5bb05f04689a06660a2c9c">&#9670;&nbsp;</a></span>A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd nnp::Structure::A</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global charge equilibration matrix A'. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00116">116</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a4cd07a8b746a55aea0f0b6181a9f645f">calculateDQdChi()</a>, <a class="el" href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">calculateDQdJ()</a>, <a class="el" href="structnnp_1_1Structure.html#a8f0706e5971387076a3257b149534679">calculateDQdr()</a>, <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">calculateElectrostaticEnergyDerivatives()</a>, <a class="el" href="structnnp_1_1Structure.html#a3237e0cda2706b6930880c9c7f4885c4">calculateForceLambdaElec()</a>, <a class="el" href="structnnp_1_1Structure.html#a9373df62476af32ec7c479bbc3fcb063">calculateForceLambdaTotal()</a>, <a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy()</a>, and <a class="el" href="structnnp_1_1Structure.html#aa595df3985c11f039308dcca5fae828c">clearElectrostatics()</a>.</p>

</div>
</div>
<a id="a79b8f1a7b53aebd41dab2838084b5618" name="a79b8f1a7b53aebd41dab2838084b5618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b8f1a7b53aebd41dab2838084b5618">&#9670;&nbsp;</a></span>hasAMatrix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Structure::hasAMatrix</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If A matrix of this structure is currently stored. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00118">118</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#aa595df3985c11f039308dcca5fae828c">clearElectrostatics()</a>, and <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>.</p>

</div>
</div>
<a id="a3427c9bd877e3bf72ad71f30dfb76ac2" name="a3427c9bd877e3bf72ad71f30dfb76ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3427c9bd877e3bf72ad71f30dfb76ac2">&#9670;&nbsp;</a></span>numAtomsPerElement</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::size_t&gt; nnp::Structure::numAtomsPerElement</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of atoms of each element in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00120">120</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1Mode.html#a17ba3ecbce972ff28d7a17bdade38674">nnp::Mode::addEnergyOffset()</a>, <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="classnnp_1_1Mode.html#af05a24414c9b595a8ccb95b05b5030de">nnp::Mode::getEnergyOffset()</a>, <a class="el" href="classnnp_1_1Mode.html#ab86800b032be86f1321d3f6683c75b01">nnp::Mode::getEnergyWithOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-dist_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="classnnp_1_1Mode.html#aa8ddf0701dbcd60868955ca556892bc5">nnp::Mode::removeEnergyOffset()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a57c375126ca37e8d390d406091e7dd5a">setElementMap()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, and <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>.</p>

</div>
</div>
<a id="adee965dec483f9479378a2ed4acd5544" name="adee965dec483f9479378a2ed4acd5544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee965dec483f9479378a2ed4acd5544">&#9670;&nbsp;</a></span>atoms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structnnp_1_1Atom.html">Atom</a>&gt; nnp::Structure::atoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vector of all atoms in this structure. </p>

<p class="definition">Definition at line <a class="el" href="Structure_8h_source.html#l00122">122</a> of file <a class="el" href="Structure_8h_source.html">Structure.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="structnnp_1_1Structure.html#a7b676463d894c0988c645fed1ddf36b1">addAtom()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#af5aab023a5bf8f326a6f5a7e4515e09c">nnp::InterfaceLammps::addNeighbor()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a21635e0bdb42f74425b11639d736f3cb">nnp::InterfaceLammps::allocateNeighborlists()</a>, <a class="el" href="classnnp_1_1Mode.html#a67f3cb929c9dbad689889941d35f7b04">nnp::Mode::calculateAtomicNeuralNetworks()</a>, <a class="el" href="classnnp_1_1Dataset.html#a80b6ba9363df082cf9f7aaaad56ad7c0">nnp::Dataset::calculateBufferSize()</a>, <a class="el" href="classnnp_1_1Mode.html#ac71da5d31be39935bdc3c7202ba23a2e">nnp::Mode::calculateCharge()</a>, <a class="el" href="classnnp_1_1Training.html#ab04baa25ad186e9a82a4a4fa7f3bdca4">nnp::Training::calculateChargeErrorVec()</a>, <a class="el" href="structnnp_1_1Structure.html#addf3a61f5cb0fa8daeb5737d28758740">calculateDAdrQ()</a>, <a class="el" href="structnnp_1_1Structure.html#a7204a6979274b69a358f73af50187d85">calculateDQdJ()</a>, <a class="el" href="structnnp_1_1Structure.html#a8f0706e5971387076a3257b149534679">calculateDQdr()</a>, <a class="el" href="structnnp_1_1Structure.html#a50ffe252cff725aa5bb952bb1d8cbf5a">calculateElectrostaticEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#ac91c699d5b568d865f43ab30fe42f250">calculateElectrostaticEnergyDerivatives()</a>, <a class="el" href="classnnp_1_1Mode.html#a88fb8800851f3d440fcf393cbc073308">nnp::Mode::calculateEnergy()</a>, <a class="el" href="structnnp_1_1Structure.html#a3237e0cda2706b6930880c9c7f4885c4">calculateForceLambdaElec()</a>, <a class="el" href="structnnp_1_1Structure.html#a9373df62476af32ec7c479bbc3fcb063">calculateForceLambdaTotal()</a>, <a class="el" href="classnnp_1_1Mode.html#ae2fddd6f29bb63ef67b9619544d81ab1">nnp::Mode::calculateForces()</a>, <a class="el" href="structnnp_1_1Structure.html#acd8b8ea17cc7579a3618a49623303483">calculateNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#ae462f93091a1ab2767a5ca395ab0a6e2">calculateScreeningEnergy()</a>, <a class="el" href="classnnp_1_1Mode.html#a8aec6fb4708b93b93a9cfa0e8045f955">nnp::Mode::calculateSymmetryFunctionGroups()</a>, <a class="el" href="classnnp_1_1Mode.html#add11e3c30eb86aba38d8239d1e5d8736">nnp::Mode::calculateSymmetryFunctions()</a>, <a class="el" href="classnnp_1_1Training.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="structnnp_1_1Structure.html#aa595df3985c11f039308dcca5fae828c">clearElectrostatics()</a>, <a class="el" href="structnnp_1_1Structure.html#af289c389f76b4981aef3c92300aa668d">clearNeighborList()</a>, <a class="el" href="classLAMMPS__NS_1_1PairHDNNPExternal.html#a9d3a8ccc255cf1d510255851e60b8236">LAMMPS_NS::PairHDNNPExternal::compute()</a>, <a class="el" href="classnnp_1_1Training.html#a59b8fac49977fbc5a5b41d9a58346697">nnp::Training::dPdc()</a>, <a class="el" href="classnnp_1_1Training.html#aa2d978b9e0c45624a9e48c455b57b72d">nnp::Training::dPdcN()</a>, <a class="el" href="classnnp_1_1Mode.html#adea10435a61aeda3d486184932e9ff3a">nnp::Mode::evaluateNNP()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#ad0bfcbe0f61990f71705942c8e847627">nnp::InterfaceLammps::finalizeNeighborList()</a>, <a class="el" href="structnnp_1_1Structure.html#a0c1cbaed161ba008d03a654d5ea04c6a">freeAtoms()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a680dca82d8c1670ac2effe7ba7df60fc">nnp::InterfaceLammps::getAtomicEnergy()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#ab13d05c75565b694a19aca7265e3216b">nnp::InterfaceLammps::getCharges()</a>, <a class="el" href="structnnp_1_1Structure.html#a6477ccc1b4338e4e2e44a5da7ab49741">getChargesLines()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ac5a70e2e3f8368758300957a48ead3e2">getForcesLines()</a>, <a class="el" href="structnnp_1_1Structure.html#a26e79c2155e6dd905e7642c6cda008e6">getMaxNumNeighbors()</a>, <a class="el" href="structnnp_1_1Structure.html#af6d63337cd7d1a4e0058cd818543caef">info()</a>, <a class="el" href="nnp-checkf_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="classnnp_1_1Dataset.html#aa932aedf7af8cf3daea1cae02c3602c4">nnp::Dataset::prepareNumericForces()</a>, <a class="el" href="structnnp_1_1Structure.html#ae3f4816f60d52e90cf213479ef443b32">readFromLines()</a>, <a class="el" href="classnnp_1_1Dataset.html#a57630554119a518ecb32d5e1f327256f">nnp::Dataset::recvStructure()</a>, <a class="el" href="structnnp_1_1Structure.html#a60c37b89d8e32f6785168f6a6c201859">remap()</a>, <a class="el" href="structnnp_1_1Structure.html#abf6bf40715b7ffd70707baf5e95746ce">reset()</a>, <a class="el" href="classnnp_1_1Training.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="classnnp_1_1Dataset.html#ac032639db8f6f1230f759afd3775c200">nnp::Dataset::sendStructure()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a556c07c02b8b8db8f8a4a9b8665d2d72">nnp::InterfaceLammps::setLocalAtomPositions()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#aa7ef0738c6df7b3d65b35a0f1c884f49">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="classnnp_1_1InterfaceLammps.html#a1c2c6944f8458c58a174d0e058649139">nnp::InterfaceLammps::setLocalTags()</a>, <a class="el" href="structnnp_1_1Structure.html#a281cb20de35ca8ecbfab2a196be3c107">setupNeighborCutoffMap()</a>, <a class="el" href="structnnp_1_1Structure.html#a2fd80c1c4534a68182f88016fc1ea284">sortNeighborList()</a>, <a class="el" href="classnnp_1_1Training.html#a7427bd5388a7c72eec65e8a2407cb7f7">nnp::Training::sortUpdateCandidates()</a>, <a class="el" href="structnnp_1_1Structure.html#abd33241d3bdecf5f1a7eee012118cea3">toNormalizedUnits()</a>, <a class="el" href="structnnp_1_1Structure.html#a1858d3c06446ad91b0876f8ca30b2686">toPhysicalUnits()</a>, <a class="el" href="classnnp_1_1Training.html#a6432b845ccd07996ab2f8f4f707a0d8d">nnp::Training::update()</a>, <a class="el" href="structnnp_1_1Structure.html#add58b9575e3ae19f82991a445aec6b97">updateError()</a>, <a class="el" href="structnnp_1_1Structure.html#a64ded940e3f99aa86b3fa75a37357a29">writeToFile()</a>, <a class="el" href="structnnp_1_1Structure.html#a5e1f59c24c85703e6e78c7f85d47a2d8">writeToFilePoscar()</a>, and <a class="el" href="structnnp_1_1Structure.html#a8285382c3e2d908c8073a1fac315176b">writeToFileXyz()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>/home/runner/work/n2p2/n2p2/src/libnnp/<a class="el" href="Structure_8h_source.html">Structure.h</a></li>
<li>/home/runner/work/n2p2/n2p2/src/libnnp/<a class="el" href="Structure_8cpp_source.html">Structure.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacennp.html">nnp</a></li><li class="navelem"><a class="el" href="structnnp_1_1Structure.html">Structure</a></li>
    <li class="footer">Generated on Sun Nov 24 2024 23:31:49 for n2p2 - A neural network potential package by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
